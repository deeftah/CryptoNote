<html>
<head>
	<title>Markdown Edit Preview</title>
	<!-- Must have base tag with id of "base-tag-id" -->
	<base id="base-tag-id">
	<!-- Don't delete this X-UA tag. The browser control behaves like IE8 otherwise -->
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<style type="text/css">
		body { font-family: arial, 'segoe ui', sans-serif; line-height: 1.4; padding-left: 12pt; font-size: 12pt; }
		code { white-space: pre }
		ul, ol { padding: 8pt; }
		h1, h2, h3, h4, h5, h6 { font-family: arial, cambria, serif; }
		blockquote { padding: 0 12pt; color: #777; border-left: 3pt solid #ddd;  }
		table{ display: block; width: 100%; overflow: auto; word-break: normal; word-break: keep-all; border-collapse: collapse;  }
		table th{ font-weight: bold; background-color: #f8f8f8; }
		table th, #content table td{ padding: 6px 13px; border: 1px solid #ddd; }
		table tr{ background-color: #fff; border-top: 1px solid #ccc; page-break-inside: avoid; }
	</style>
	<style type="text/css">
		._sprite{ background-image: url('emoji-sprite.png'); } 
		._sprite{ background-color: transparent; background-repeat: no-repeat; display: inline-block; zoom:0.39; vertical-align: middle; }
		._shipit{ width: 75px; height: 75px; background-position: 0 -27520px; }
		._0023-20e3{ width: 64px; height: 64px; background-position: 0 -27456px; }
		._0030-20e3{ width: 64px; height: 64px; background-position: -64px 0; }
		._0031-20e3{ width: 64px; height: 64px; background-position: -64px -64px; }
		._0032-20e3{ width: 64px; height: 64px; background-position: 0 -27392px; }
		._0033-20e3{ width: 64px; height: 64px; background-position: -64px -128px; }
		._0034-20e3{ width: 64px; height: 64px; background-position: 0 -27328px; }
		._0035-20e3{ width: 64px; height: 64px; background-position: -64px -192px; }
		._0036-20e3{ width: 64px; height: 64px; background-position: 0 -27264px; }
		._0037-20e3{ width: 64px; height: 64px; background-position: -64px -256px; }
		._0038-20e3{ width: 64px; height: 64px; background-position: 0 -27200px; }
		._0039-20e3{ width: 64px; height: 64px; background-position: -64px -320px; }
		._00a9{ width: 64px; height: 64px; background-position: 0 -27136px; }
		._00ae{ width: 64px; height: 64px; background-position: -64px -384px; }
		._1f004{ width: 64px; height: 64px; background-position: 0 -27072px; }
		._1f0cf{ width: 64px; height: 64px; background-position: -64px -448px; }
		._1f170{ width: 64px; height: 64px; background-position: 0 -27008px; }
		._1f171{ width: 64px; height: 64px; background-position: -64px -512px; }
		._1f17e{ width: 64px; height: 64px; background-position: 0 -26944px; }
		._1f17f{ width: 64px; height: 64px; background-position: -64px -576px; }
		._1f18e{ width: 64px; height: 64px; background-position: 0 -26880px; }
		._1f191{ width: 64px; height: 64px; background-position: -64px -640px; }
		._1f192{ width: 64px; height: 64px; background-position: 0 -26816px; }
		._1f193{ width: 64px; height: 64px; background-position: -64px -704px; }
		._1f194{ width: 64px; height: 64px; background-position: 0 -26752px; }
		._1f195{ width: 64px; height: 64px; background-position: -64px -768px; }
		._1f196{ width: 64px; height: 64px; background-position: 0 -26688px; }
		._1f197{ width: 64px; height: 64px; background-position: -64px -832px; }
		._1f198{ width: 64px; height: 64px; background-position: 0 -26624px; }
		._1f199{ width: 64px; height: 64px; background-position: -64px -896px; }
		._1f19a{ width: 64px; height: 64px; background-position: 0 -26560px; }
		._1f1e8-1f1f3{ width: 64px; height: 64px; background-position: -64px -960px; }
		._1f1e9-1f1ea{ width: 64px; height: 64px; background-position: 0 -26496px; }
		._1f1ea-1f1f8{ width: 64px; height: 64px; background-position: -64px -1024px; }
		._1f1eb-1f1f7{ width: 64px; height: 64px; background-position: 0 -26432px; }
		._1f1ec-1f1e7{ width: 64px; height: 64px; background-position: -64px -1088px; }
		._1f1ee-1f1f9{ width: 64px; height: 64px; background-position: 0 -26368px; }
		._1f1ef-1f1f5{ width: 64px; height: 64px; background-position: -64px -1152px; }
		._1f1f0-1f1f7{ width: 64px; height: 64px; background-position: 0 -26304px; }
		._1f1f7-1f1fa{ width: 64px; height: 64px; background-position: -64px -1216px; }
		._1f1fa-1f1f8{ width: 64px; height: 64px; background-position: 0 -26240px; }
		._1f201{ width: 64px; height: 64px; background-position: -64px -1280px; }
		._1f202{ width: 64px; height: 64px; background-position: 0 -26176px; }
		._1f21a{ width: 64px; height: 64px; background-position: -64px -1344px; }
		._1f22f{ width: 64px; height: 64px; background-position: 0 -26112px; }
		._1f232{ width: 64px; height: 64px; background-position: -64px -1408px; }
		._1f233{ width: 64px; height: 64px; background-position: 0 -26048px; }
		._1f234{ width: 64px; height: 64px; background-position: -64px -1472px; }
		._1f235{ width: 64px; height: 64px; background-position: 0 -25984px; }
		._1f236{ width: 64px; height: 64px; background-position: -64px -1536px; }
		._1f237{ width: 64px; height: 64px; background-position: 0 -25920px; }
		._1f238{ width: 64px; height: 64px; background-position: -64px -1600px; }
		._1f239{ width: 64px; height: 64px; background-position: 0 -25856px; }
		._1f23a{ width: 64px; height: 64px; background-position: -64px -1664px; }
		._1f250{ width: 64px; height: 64px; background-position: 0 -25792px; }
		._1f251{ width: 64px; height: 64px; background-position: -64px -1728px; }
		._1f300{ width: 64px; height: 64px; background-position: 0 -25728px; }
		._1f301{ width: 64px; height: 64px; background-position: -64px -1792px; }
		._1f302{ width: 64px; height: 64px; background-position: 0 -25664px; }
		._1f303{ width: 64px; height: 64px; background-position: -64px -1856px; }
		._1f304{ width: 64px; height: 64px; background-position: 0 -25600px; }
		._1f305{ width: 64px; height: 64px; background-position: -64px -1920px; }
		._1f306{ width: 64px; height: 64px; background-position: 0 -25536px; }
		._1f307{ width: 64px; height: 64px; background-position: -64px -1984px; }
		._1f308{ width: 64px; height: 64px; background-position: 0 -25472px; }
		._1f309{ width: 64px; height: 64px; background-position: -64px -2048px; }
		._1f30a{ width: 64px; height: 64px; background-position: 0 -25408px; }
		._1f30b{ width: 64px; height: 64px; background-position: -64px -2112px; }
		._1f30c{ width: 64px; height: 64px; background-position: 0 -25344px; }
		._1f30d{ width: 64px; height: 64px; background-position: -64px -2176px; }
		._1f30e{ width: 64px; height: 64px; background-position: 0 -25280px; }
		._1f30f{ width: 64px; height: 64px; background-position: -64px -2240px; }
		._1f310{ width: 64px; height: 64px; background-position: 0 -25216px; }
		._1f311{ width: 64px; height: 64px; background-position: -64px -2304px; }
		._1f312{ width: 64px; height: 64px; background-position: 0 -25152px; }
		._1f313{ width: 64px; height: 64px; background-position: -64px -2368px; }
		._1f314{ width: 64px; height: 64px; background-position: 0 -25088px; }
		._1f315{ width: 64px; height: 64px; background-position: -64px -2432px; }
		._1f316{ width: 64px; height: 64px; background-position: 0 -25024px; }
		._1f317{ width: 64px; height: 64px; background-position: -64px -2496px; }
		._1f318{ width: 64px; height: 64px; background-position: 0 -24960px; }
		._1f319{ width: 64px; height: 64px; background-position: -64px -2560px; }
		._1f31a{ width: 64px; height: 64px; background-position: 0 -24896px; }
		._1f31b{ width: 64px; height: 64px; background-position: -64px -2624px; }
		._1f31c{ width: 64px; height: 64px; background-position: 0 -24832px; }
		._1f31d{ width: 64px; height: 64px; background-position: -64px -2688px; }
		._1f31e{ width: 64px; height: 64px; background-position: 0 -24768px; }
		._1f31f{ width: 64px; height: 64px; background-position: -64px -2752px; }
		._1f320{ width: 64px; height: 64px; background-position: 0 -24704px; }
		._1f330{ width: 64px; height: 64px; background-position: -64px -2816px; }
		._1f331{ width: 64px; height: 64px; background-position: 0 -24640px; }
		._1f332{ width: 64px; height: 64px; background-position: -64px -2880px; }
		._1f333{ width: 64px; height: 64px; background-position: 0 -24576px; }
		._1f334{ width: 64px; height: 64px; background-position: -64px -2944px; }
		._1f335{ width: 64px; height: 64px; background-position: 0 -24512px; }
		._1f337{ width: 64px; height: 64px; background-position: -64px -3008px; }
		._1f338{ width: 64px; height: 64px; background-position: 0 -24448px; }
		._1f339{ width: 64px; height: 64px; background-position: -64px -3072px; }
		._1f33a{ width: 64px; height: 64px; background-position: 0 -24384px; }
		._1f33b{ width: 64px; height: 64px; background-position: -64px -3136px; }
		._1f33c{ width: 64px; height: 64px; background-position: 0 -24320px; }
		._1f33d{ width: 64px; height: 64px; background-position: -64px -3200px; }
		._1f33e{ width: 64px; height: 64px; background-position: 0 -24256px; }
		._1f33f{ width: 64px; height: 64px; background-position: -64px -3264px; }
		._1f340{ width: 64px; height: 64px; background-position: 0 -24192px; }
		._1f341{ width: 64px; height: 64px; background-position: -64px -3328px; }
		._1f342{ width: 64px; height: 64px; background-position: 0 -24128px; }
		._1f343{ width: 64px; height: 64px; background-position: -64px -3392px; }
		._1f344{ width: 64px; height: 64px; background-position: 0 -24064px; }
		._1f345{ width: 64px; height: 64px; background-position: -64px -3456px; }
		._1f346{ width: 64px; height: 64px; background-position: 0 -24000px; }
		._1f347{ width: 64px; height: 64px; background-position: -64px -3520px; }
		._1f348{ width: 64px; height: 64px; background-position: 0 -23936px; }
		._1f349{ width: 64px; height: 64px; background-position: -64px -3584px; }
		._1f34a{ width: 64px; height: 64px; background-position: 0 -23872px; }
		._1f34b{ width: 64px; height: 64px; background-position: -64px -3648px; }
		._1f34c{ width: 64px; height: 64px; background-position: 0 -23808px; }
		._1f34d{ width: 64px; height: 64px; background-position: -64px -3712px; }
		._1f34e{ width: 64px; height: 64px; background-position: 0 -23744px; }
		._1f34f{ width: 64px; height: 64px; background-position: -64px -3776px; }
		._1f350{ width: 64px; height: 64px; background-position: 0 -23680px; }
		._1f351{ width: 64px; height: 64px; background-position: -64px -3840px; }
		._1f352{ width: 64px; height: 64px; background-position: 0 -23616px; }
		._1f353{ width: 64px; height: 64px; background-position: -64px -3904px; }
		._1f354{ width: 64px; height: 64px; background-position: 0 -23552px; }
		._1f355{ width: 64px; height: 64px; background-position: -64px -3968px; }
		._1f356{ width: 64px; height: 64px; background-position: 0 -23488px; }
		._1f357{ width: 64px; height: 64px; background-position: -64px -4032px; }
		._1f358{ width: 64px; height: 64px; background-position: 0 -23424px; }
		._1f359{ width: 64px; height: 64px; background-position: -64px -4096px; }
		._1f35a{ width: 64px; height: 64px; background-position: 0 -23360px; }
		._1f35b{ width: 64px; height: 64px; background-position: -64px -4160px; }
		._1f35c{ width: 64px; height: 64px; background-position: 0 -23296px; }
		._1f35d{ width: 64px; height: 64px; background-position: -64px -4224px; }
		._1f35e{ width: 64px; height: 64px; background-position: 0 -23232px; }
		._1f35f{ width: 64px; height: 64px; background-position: -64px -4288px; }
		._1f360{ width: 64px; height: 64px; background-position: 0 -23168px; }
		._1f361{ width: 64px; height: 64px; background-position: -64px -4352px; }
		._1f362{ width: 64px; height: 64px; background-position: 0 -23104px; }
		._1f363{ width: 64px; height: 64px; background-position: -64px -4416px; }
		._1f364{ width: 64px; height: 64px; background-position: 0 -23040px; }
		._1f365{ width: 64px; height: 64px; background-position: -64px -4480px; }
		._1f366{ width: 64px; height: 64px; background-position: 0 -22976px; }
		._1f367{ width: 64px; height: 64px; background-position: -64px -4544px; }
		._1f368{ width: 64px; height: 64px; background-position: 0 -22912px; }
		._1f369{ width: 64px; height: 64px; background-position: -64px -4608px; }
		._1f36a{ width: 64px; height: 64px; background-position: 0 -22848px; }
		._1f36b{ width: 64px; height: 64px; background-position: -64px -4672px; }
		._1f36c{ width: 64px; height: 64px; background-position: 0 -22784px; }
		._1f36d{ width: 64px; height: 64px; background-position: -64px -4736px; }
		._1f36e{ width: 64px; height: 64px; background-position: 0 -22720px; }
		._1f36f{ width: 64px; height: 64px; background-position: -64px -4800px; }
		._1f370{ width: 64px; height: 64px; background-position: 0 -22656px; }
		._1f371{ width: 64px; height: 64px; background-position: -64px -4864px; }
		._1f372{ width: 64px; height: 64px; background-position: 0 -22592px; }
		._1f373{ width: 64px; height: 64px; background-position: -64px -4928px; }
		._1f374{ width: 64px; height: 64px; background-position: 0 -22528px; }
		._1f375{ width: 64px; height: 64px; background-position: -64px -4992px; }
		._1f376{ width: 64px; height: 64px; background-position: 0 -22464px; }
		._1f377{ width: 64px; height: 64px; background-position: -64px -5056px; }
		._1f378{ width: 64px; height: 64px; background-position: 0 -22400px; }
		._1f379{ width: 64px; height: 64px; background-position: -64px -5120px; }
		._1f37a{ width: 64px; height: 64px; background-position: 0 -22336px; }
		._1f37b{ width: 64px; height: 64px; background-position: -64px -5184px; }
		._1f37c{ width: 64px; height: 64px; background-position: 0 -22272px; }
		._1f380{ width: 64px; height: 64px; background-position: -64px -5248px; }
		._1f381{ width: 64px; height: 64px; background-position: 0 -22208px; }
		._1f382{ width: 64px; height: 64px; background-position: -64px -5312px; }
		._1f383{ width: 64px; height: 64px; background-position: 0 -22144px; }
		._1f384{ width: 64px; height: 64px; background-position: -64px -5376px; }
		._1f385{ width: 64px; height: 64px; background-position: 0 -22080px; }
		._1f386{ width: 64px; height: 64px; background-position: -64px -5440px; }
		._1f387{ width: 64px; height: 64px; background-position: 0 -22016px; }
		._1f388{ width: 64px; height: 64px; background-position: -64px -5504px; }
		._1f389{ width: 64px; height: 64px; background-position: 0 -21952px; }
		._1f38a{ width: 64px; height: 64px; background-position: -64px -5568px; }
		._1f38b{ width: 64px; height: 64px; background-position: 0 -21888px; }
		._1f38c{ width: 64px; height: 64px; background-position: -64px -5632px; }
		._1f38d{ width: 64px; height: 64px; background-position: 0 -21824px; }
		._1f38e{ width: 64px; height: 64px; background-position: -64px -5696px; }
		._1f38f{ width: 64px; height: 64px; background-position: 0 -21760px; }
		._1f390{ width: 64px; height: 64px; background-position: -64px -5760px; }
		._1f391{ width: 64px; height: 64px; background-position: 0 -21696px; }
		._1f392{ width: 64px; height: 64px; background-position: -64px -5824px; }
		._1f393{ width: 64px; height: 64px; background-position: 0 -21632px; }
		._1f3a0{ width: 64px; height: 64px; background-position: -64px -5888px; }
		._1f3a1{ width: 64px; height: 64px; background-position: 0 -21568px; }
		._1f3a2{ width: 64px; height: 64px; background-position: -64px -5952px; }
		._1f3a3{ width: 64px; height: 64px; background-position: 0 -21504px; }
		._1f3a4{ width: 64px; height: 64px; background-position: -64px -6016px; }
		._1f3a5{ width: 64px; height: 64px; background-position: 0 -21440px; }
		._1f3a6{ width: 64px; height: 64px; background-position: -64px -6080px; }
		._1f3a7{ width: 64px; height: 64px; background-position: 0 -21376px; }
		._1f3a8{ width: 64px; height: 64px; background-position: -64px -6144px; }
		._1f3a9{ width: 64px; height: 64px; background-position: 0 -21312px; }
		._1f3aa{ width: 64px; height: 64px; background-position: -64px -6208px; }
		._1f3ab{ width: 64px; height: 64px; background-position: 0 -21248px; }
		._1f3ac{ width: 64px; height: 64px; background-position: -64px -6272px; }
		._1f3ad{ width: 64px; height: 64px; background-position: 0 -21184px; }
		._1f3ae{ width: 64px; height: 64px; background-position: -64px -6336px; }
		._1f3af{ width: 64px; height: 64px; background-position: 0 -21120px; }
		._1f3b0{ width: 64px; height: 64px; background-position: -64px -6400px; }
		._1f3b1{ width: 64px; height: 64px; background-position: 0 -21056px; }
		._1f3b2{ width: 64px; height: 64px; background-position: -64px -6464px; }
		._1f3b3{ width: 64px; height: 64px; background-position: 0 -20992px; }
		._1f3b4{ width: 64px; height: 64px; background-position: -64px -6528px; }
		._1f3b5{ width: 64px; height: 64px; background-position: 0 -20928px; }
		._1f3b6{ width: 64px; height: 64px; background-position: -64px -6592px; }
		._1f3b7{ width: 64px; height: 64px; background-position: 0 -20864px; }
		._1f3b8{ width: 64px; height: 64px; background-position: -64px -6656px; }
		._1f3b9{ width: 64px; height: 64px; background-position: 0 -20800px; }
		._1f3ba{ width: 64px; height: 64px; background-position: -64px -6720px; }
		._1f3bb{ width: 64px; height: 64px; background-position: 0 -20736px; }
		._1f3bc{ width: 64px; height: 64px; background-position: -64px -6784px; }
		._1f3bd{ width: 64px; height: 64px; background-position: 0 -20672px; }
		._1f3be{ width: 64px; height: 64px; background-position: -64px -6848px; }
		._1f3bf{ width: 64px; height: 64px; background-position: 0 -20608px; }
		._1f3c0{ width: 64px; height: 64px; background-position: -64px -6912px; }
		._1f3c1{ width: 64px; height: 64px; background-position: 0 -20544px; }
		._1f3c2{ width: 64px; height: 64px; background-position: -64px -6976px; }
		._1f3c3{ width: 64px; height: 64px; background-position: 0 -20480px; }
		._1f3c4{ width: 64px; height: 64px; background-position: -64px -7040px; }
		._1f3c6{ width: 64px; height: 64px; background-position: 0 -20416px; }
		._1f3c7{ width: 64px; height: 64px; background-position: -64px -7104px; }
		._1f3c8{ width: 64px; height: 64px; background-position: 0 -20352px; }
		._1f3c9{ width: 64px; height: 64px; background-position: -64px -7168px; }
		._1f3ca{ width: 64px; height: 64px; background-position: 0 -20288px; }
		._1f3e0{ width: 64px; height: 64px; background-position: -64px -7232px; }
		._1f3e1{ width: 64px; height: 64px; background-position: 0 -20224px; }
		._1f3e2{ width: 64px; height: 64px; background-position: -64px -7296px; }
		._1f3e3{ width: 64px; height: 64px; background-position: 0 -20160px; }
		._1f3e4{ width: 64px; height: 64px; background-position: -64px -7360px; }
		._1f3e5{ width: 64px; height: 64px; background-position: 0 -20096px; }
		._1f3e6{ width: 64px; height: 64px; background-position: -64px -7424px; }
		._1f3e7{ width: 64px; height: 64px; background-position: 0 -20032px; }
		._1f3e8{ width: 64px; height: 64px; background-position: -64px -7488px; }
		._1f3e9{ width: 64px; height: 64px; background-position: 0 -19968px; }
		._1f3ea{ width: 64px; height: 64px; background-position: -64px -7552px; }
		._1f3eb{ width: 64px; height: 64px; background-position: 0 -19904px; }
		._1f3ec{ width: 64px; height: 64px; background-position: -64px -7616px; }
		._1f3ed{ width: 64px; height: 64px; background-position: 0 -19840px; }
		._1f3ee{ width: 64px; height: 64px; background-position: -64px -7680px; }
		._1f3ef{ width: 64px; height: 64px; background-position: 0 -19776px; }
		._1f3f0{ width: 64px; height: 64px; background-position: -64px -7744px; }
		._1f400{ width: 64px; height: 64px; background-position: 0 -19712px; }
		._1f401{ width: 64px; height: 64px; background-position: -64px -7808px; }
		._1f402{ width: 64px; height: 64px; background-position: 0 -19648px; }
		._1f403{ width: 64px; height: 64px; background-position: -64px -7872px; }
		._1f404{ width: 64px; height: 64px; background-position: 0 -19584px; }
		._1f405{ width: 64px; height: 64px; background-position: -64px -7936px; }
		._1f406{ width: 64px; height: 64px; background-position: 0 -19520px; }
		._1f407{ width: 64px; height: 64px; background-position: -64px -8000px; }
		._1f408{ width: 64px; height: 64px; background-position: 0 -19456px; }
		._1f409{ width: 64px; height: 64px; background-position: -64px -8064px; }
		._1f40a{ width: 64px; height: 64px; background-position: 0 -19392px; }
		._1f40b{ width: 64px; height: 64px; background-position: -64px -8128px; }
		._1f40c{ width: 64px; height: 64px; background-position: 0 -19328px; }
		._1f40d{ width: 64px; height: 64px; background-position: -64px -8192px; }
		._1f40e{ width: 64px; height: 64px; background-position: 0 -19264px; }
		._1f40f{ width: 64px; height: 64px; background-position: -64px -8256px; }
		._1f410{ width: 64px; height: 64px; background-position: 0 -19200px; }
		._1f411{ width: 64px; height: 64px; background-position: -64px -8320px; }
		._1f412{ width: 64px; height: 64px; background-position: 0 -19136px; }
		._1f413{ width: 64px; height: 64px; background-position: -64px -8384px; }
		._1f414{ width: 64px; height: 64px; background-position: 0 -19072px; }
		._1f415{ width: 64px; height: 64px; background-position: -64px -8448px; }
		._1f416{ width: 64px; height: 64px; background-position: 0 -19008px; }
		._1f417{ width: 64px; height: 64px; background-position: -64px -8512px; }
		._1f418{ width: 64px; height: 64px; background-position: 0 -18944px; }
		._1f419{ width: 64px; height: 64px; background-position: -64px -8576px; }
		._1f41a{ width: 64px; height: 64px; background-position: 0 -18880px; }
		._1f41b{ width: 64px; height: 64px; background-position: -64px -8640px; }
		._1f41c{ width: 64px; height: 64px; background-position: 0 -18816px; }
		._1f41d{ width: 64px; height: 64px; background-position: -64px -8704px; }
		._1f41e{ width: 64px; height: 64px; background-position: 0 -18752px; }
		._1f41f{ width: 64px; height: 64px; background-position: -64px -8768px; }
		._1f420{ width: 64px; height: 64px; background-position: 0 -18688px; }
		._1f421{ width: 64px; height: 64px; background-position: -64px -8832px; }
		._1f422{ width: 64px; height: 64px; background-position: 0 -18624px; }
		._1f423{ width: 64px; height: 64px; background-position: -64px -8896px; }
		._1f424{ width: 64px; height: 64px; background-position: 0 -18560px; }
		._1f425{ width: 64px; height: 64px; background-position: -64px -8960px; }
		._1f426{ width: 64px; height: 64px; background-position: 0 -18496px; }
		._1f427{ width: 64px; height: 64px; background-position: -64px -9024px; }
		._1f428{ width: 64px; height: 64px; background-position: 0 -18432px; }
		._1f429{ width: 64px; height: 64px; background-position: -64px -9088px; }
		._1f42a{ width: 64px; height: 64px; background-position: 0 -18368px; }
		._1f42b{ width: 64px; height: 64px; background-position: -64px -9152px; }
		._1f42c{ width: 64px; height: 64px; background-position: 0 -18304px; }
		._1f42d{ width: 64px; height: 64px; background-position: -64px -9216px; }
		._1f42e{ width: 64px; height: 64px; background-position: 0 -18240px; }
		._1f42f{ width: 64px; height: 64px; background-position: -64px -9280px; }
		._1f430{ width: 64px; height: 64px; background-position: 0 -18176px; }
		._1f431{ width: 64px; height: 64px; background-position: -64px -9344px; }
		._1f432{ width: 64px; height: 64px; background-position: 0 -18112px; }
		._1f433{ width: 64px; height: 64px; background-position: -64px -9408px; }
		._1f434{ width: 64px; height: 64px; background-position: 0 -18048px; }
		._1f435{ width: 64px; height: 64px; background-position: -64px -9472px; }
		._1f436{ width: 64px; height: 64px; background-position: 0 -17984px; }
		._1f437{ width: 64px; height: 64px; background-position: -64px -9536px; }
		._1f438{ width: 64px; height: 64px; background-position: 0 -17920px; }
		._1f439{ width: 64px; height: 64px; background-position: -64px -9600px; }
		._1f43a{ width: 64px; height: 64px; background-position: 0 -17856px; }
		._1f43b{ width: 64px; height: 64px; background-position: -64px -9664px; }
		._1f43c{ width: 64px; height: 64px; background-position: 0 -17792px; }
		._1f43d{ width: 64px; height: 64px; background-position: -64px -9728px; }
		._1f43e{ width: 64px; height: 64px; background-position: 0 -17728px; }
		._1f440{ width: 64px; height: 64px; background-position: -64px -9792px; }
		._1f442{ width: 64px; height: 64px; background-position: 0 -17664px; }
		._1f443{ width: 64px; height: 64px; background-position: -64px -9856px; }
		._1f444{ width: 64px; height: 64px; background-position: 0 -17600px; }
		._1f445{ width: 64px; height: 64px; background-position: -64px -9920px; }
		._1f446{ width: 64px; height: 64px; background-position: 0 -17536px; }
		._1f447{ width: 64px; height: 64px; background-position: -64px -9984px; }
		._1f448{ width: 64px; height: 64px; background-position: 0 -17472px; }
		._1f449{ width: 64px; height: 64px; background-position: -64px -10048px; }
		._1f44a{ width: 64px; height: 64px; background-position: 0 -17408px; }
		._1f44b{ width: 64px; height: 64px; background-position: -64px -10112px; }
		._1f44c{ width: 64px; height: 64px; background-position: 0 -17344px; }
		._1f44d{ width: 64px; height: 64px; background-position: -64px -10176px; }
		._1f44e{ width: 64px; height: 64px; background-position: 0 -17280px; }
		._1f44f{ width: 64px; height: 64px; background-position: -64px -10240px; }
		._1f450{ width: 64px; height: 64px; background-position: 0 -17216px; }
		._1f451{ width: 64px; height: 64px; background-position: -64px -10304px; }
		._1f452{ width: 64px; height: 64px; background-position: 0 -17152px; }
		._1f453{ width: 64px; height: 64px; background-position: -64px -10368px; }
		._1f454{ width: 64px; height: 64px; background-position: 0 -17088px; }
		._1f455{ width: 64px; height: 64px; background-position: -64px -10432px; }
		._1f456{ width: 64px; height: 64px; background-position: 0 -17024px; }
		._1f457{ width: 64px; height: 64px; background-position: -64px -10496px; }
		._1f458{ width: 64px; height: 64px; background-position: 0 -16960px; }
		._1f459{ width: 64px; height: 64px; background-position: -64px -10560px; }
		._1f45a{ width: 64px; height: 64px; background-position: 0 -16896px; }
		._1f45b{ width: 64px; height: 64px; background-position: -64px -10624px; }
		._1f45c{ width: 64px; height: 64px; background-position: 0 -16832px; }
		._1f45d{ width: 64px; height: 64px; background-position: -64px -10688px; }
		._1f45e{ width: 64px; height: 64px; background-position: 0 -16768px; }
		._1f45f{ width: 64px; height: 64px; background-position: -64px -10752px; }
		._1f460{ width: 64px; height: 64px; background-position: 0 -16704px; }
		._1f461{ width: 64px; height: 64px; background-position: -64px -10816px; }
		._1f462{ width: 64px; height: 64px; background-position: 0 -16640px; }
		._1f463{ width: 64px; height: 64px; background-position: -64px -10880px; }
		._1f464{ width: 64px; height: 64px; background-position: 0 -16576px; }
		._1f465{ width: 64px; height: 64px; background-position: -64px -10944px; }
		._1f466{ width: 64px; height: 64px; background-position: 0 -16512px; }
		._1f467{ width: 64px; height: 64px; background-position: -64px -11008px; }
		._1f468{ width: 64px; height: 64px; background-position: 0 -16448px; }
		._1f469{ width: 64px; height: 64px; background-position: -64px -11072px; }
		._1f46a{ width: 64px; height: 64px; background-position: 0 -16384px; }
		._1f46b{ width: 64px; height: 64px; background-position: -64px -11136px; }
		._1f46c{ width: 64px; height: 64px; background-position: 0 -16320px; }
		._1f46d{ width: 64px; height: 64px; background-position: -64px -11200px; }
		._1f46e{ width: 64px; height: 64px; background-position: 0 -16256px; }
		._1f46f{ width: 64px; height: 64px; background-position: -64px -11264px; }
		._1f470{ width: 64px; height: 64px; background-position: 0 -16192px; }
		._1f471{ width: 64px; height: 64px; background-position: -64px -11328px; }
		._1f472{ width: 64px; height: 64px; background-position: 0 -16128px; }
		._1f473{ width: 64px; height: 64px; background-position: -64px -11392px; }
		._1f474{ width: 64px; height: 64px; background-position: 0 -16064px; }
		._1f475{ width: 64px; height: 64px; background-position: -64px -11456px; }
		._1f476{ width: 64px; height: 64px; background-position: 0 -16000px; }
		._1f477{ width: 64px; height: 64px; background-position: -64px -11520px; }
		._1f478{ width: 64px; height: 64px; background-position: 0 -15936px; }
		._1f479{ width: 64px; height: 64px; background-position: -64px -11584px; }
		._1f47a{ width: 64px; height: 64px; background-position: 0 -15872px; }
		._1f47b{ width: 64px; height: 64px; background-position: -64px -11648px; }
		._1f47c{ width: 64px; height: 64px; background-position: 0 -15808px; }
		._1f47d{ width: 64px; height: 64px; background-position: -64px -11712px; }
		._1f47e{ width: 64px; height: 64px; background-position: 0 -15744px; }
		._1f47f{ width: 64px; height: 64px; background-position: -64px -11776px; }
		._1f480{ width: 64px; height: 64px; background-position: 0 -15680px; }
		._1f481{ width: 64px; height: 64px; background-position: -64px -11840px; }
		._1f482{ width: 64px; height: 64px; background-position: 0 -15616px; }
		._1f483{ width: 64px; height: 64px; background-position: -64px -11904px; }
		._1f484{ width: 64px; height: 64px; background-position: 0 -15552px; }
		._1f485{ width: 64px; height: 64px; background-position: -64px -11968px; }
		._1f486{ width: 64px; height: 64px; background-position: 0 -15488px; }
		._1f487{ width: 64px; height: 64px; background-position: -64px -12032px; }
		._1f488{ width: 64px; height: 64px; background-position: 0 -15424px; }
		._1f489{ width: 64px; height: 64px; background-position: -64px -12096px; }
		._1f48a{ width: 64px; height: 64px; background-position: 0 -15360px; }
		._1f48b{ width: 64px; height: 64px; background-position: -64px -12160px; }
		._1f48c{ width: 64px; height: 64px; background-position: 0 -15296px; }
		._1f48d{ width: 64px; height: 64px; background-position: -64px -12224px; }
		._1f48e{ width: 64px; height: 64px; background-position: 0 -15232px; }
		._1f48f{ width: 64px; height: 64px; background-position: -64px -12288px; }
		._1f490{ width: 64px; height: 64px; background-position: 0 -15168px; }
		._1f491{ width: 64px; height: 64px; background-position: -64px -12352px; }
		._1f492{ width: 64px; height: 64px; background-position: 0 -15104px; }
		._1f493{ width: 64px; height: 64px; background-position: -64px -12416px; }
		._1f494{ width: 64px; height: 64px; background-position: 0 -15040px; }
		._1f495{ width: 64px; height: 64px; background-position: -64px -12480px; }
		._1f496{ width: 64px; height: 64px; background-position: 0 -14976px; }
		._1f497{ width: 64px; height: 64px; background-position: -64px -12544px; }
		._1f498{ width: 64px; height: 64px; background-position: 0 -14912px; }
		._1f499{ width: 64px; height: 64px; background-position: -64px -12608px; }
		._1f49a{ width: 64px; height: 64px; background-position: 0 -14848px; }
		._1f49b{ width: 64px; height: 64px; background-position: -64px -12672px; }
		._1f49c{ width: 64px; height: 64px; background-position: 0 -14784px; }
		._1f49d{ width: 64px; height: 64px; background-position: -64px -12736px; }
		._1f49e{ width: 64px; height: 64px; background-position: 0 -14720px; }
		._1f49f{ width: 64px; height: 64px; background-position: -64px -12800px; }
		._1f4a0{ width: 64px; height: 64px; background-position: 0 -14656px; }
		._1f4a1{ width: 64px; height: 64px; background-position: -64px -12864px; }
		._1f4a2{ width: 64px; height: 64px; background-position: 0 -14592px; }
		._1f4a3{ width: 64px; height: 64px; background-position: -64px -12928px; }
		._1f4a4{ width: 64px; height: 64px; background-position: 0 -14528px; }
		._1f4a5{ width: 64px; height: 64px; background-position: -64px -12992px; }
		._1f4a6{ width: 64px; height: 64px; background-position: 0 -14464px; }
		._1f4a7{ width: 64px; height: 64px; background-position: -64px -13056px; }
		._1f4a8{ width: 64px; height: 64px; background-position: 0 -14400px; }
		._1f4a9{ width: 64px; height: 64px; background-position: -64px -13120px; }
		._1f4aa{ width: 64px; height: 64px; background-position: 0 -14336px; }
		._1f4ab{ width: 64px; height: 64px; background-position: -64px -13184px; }
		._1f4ac{ width: 64px; height: 64px; background-position: 0 -14272px; }
		._1f4ad{ width: 64px; height: 64px; background-position: -64px -13248px; }
		._1f4ae{ width: 64px; height: 64px; background-position: 0 -14208px; }
		._1f4af{ width: 64px; height: 64px; background-position: -64px -13312px; }
		._1f4b0{ width: 64px; height: 64px; background-position: 0 -14144px; }
		._1f4b1{ width: 64px; height: 64px; background-position: -64px -13376px; }
		._1f4b2{ width: 64px; height: 64px; background-position: 0 -14080px; }
		._1f4b3{ width: 64px; height: 64px; background-position: -64px -13440px; }
		._1f4b4{ width: 64px; height: 64px; background-position: 0 -14016px; }
		._1f4b5{ width: 64px; height: 64px; background-position: -64px -13504px; }
		._1f4b6{ width: 64px; height: 64px; background-position: 0 -13952px; }
		._1f4b7{ width: 64px; height: 64px; background-position: -64px -13568px; }
		._1f4b8{ width: 64px; height: 64px; background-position: 0 -13888px; }
		._1f4b9{ width: 64px; height: 64px; background-position: -64px -13632px; }
		._1f4ba{ width: 64px; height: 64px; background-position: 0 -13824px; }
		._1f4bb{ width: 64px; height: 64px; background-position: -64px -13696px; }
		._1f4bc{ width: 64px; height: 64px; background-position: 0 -13760px; }
		._1f4bd{ width: 64px; height: 64px; background-position: -64px -13760px; }
		._1f4be{ width: 64px; height: 64px; background-position: 0 -13696px; }
		._1f4bf{ width: 64px; height: 64px; background-position: -64px -13824px; }
		._1f4c0{ width: 64px; height: 64px; background-position: 0 -13632px; }
		._1f4c1{ width: 64px; height: 64px; background-position: -64px -13888px; }
		._1f4c2{ width: 64px; height: 64px; background-position: 0 -13568px; }
		._1f4c3{ width: 64px; height: 64px; background-position: -64px -13952px; }
		._1f4c4{ width: 64px; height: 64px; background-position: 0 -13504px; }
		._1f4c5{ width: 64px; height: 64px; background-position: -64px -14016px; }
		._1f4c6{ width: 64px; height: 64px; background-position: 0 -13440px; }
		._1f4c7{ width: 64px; height: 64px; background-position: -64px -14080px; }
		._1f4c8{ width: 64px; height: 64px; background-position: 0 -13376px; }
		._1f4c9{ width: 64px; height: 64px; background-position: -64px -14144px; }
		._1f4ca{ width: 64px; height: 64px; background-position: 0 -13312px; }
		._1f4cb{ width: 64px; height: 64px; background-position: -64px -14208px; }
		._1f4cc{ width: 64px; height: 64px; background-position: 0 -13248px; }
		._1f4cd{ width: 64px; height: 64px; background-position: -64px -14272px; }
		._1f4ce{ width: 64px; height: 64px; background-position: 0 -13184px; }
		._1f4cf{ width: 64px; height: 64px; background-position: -64px -14336px; }
		._1f4d0{ width: 64px; height: 64px; background-position: 0 -13120px; }
		._1f4d1{ width: 64px; height: 64px; background-position: -64px -14400px; }
		._1f4d2{ width: 64px; height: 64px; background-position: 0 -13056px; }
		._1f4d3{ width: 64px; height: 64px; background-position: -64px -14464px; }
		._1f4d4{ width: 64px; height: 64px; background-position: 0 -12992px; }
		._1f4d5{ width: 64px; height: 64px; background-position: -64px -14528px; }
		._1f4d6{ width: 64px; height: 64px; background-position: 0 -12928px; }
		._1f4d7{ width: 64px; height: 64px; background-position: -64px -14592px; }
		._1f4d8{ width: 64px; height: 64px; background-position: 0 -12864px; }
		._1f4d9{ width: 64px; height: 64px; background-position: -64px -14656px; }
		._1f4da{ width: 64px; height: 64px; background-position: 0 -12800px; }
		._1f4db{ width: 64px; height: 64px; background-position: -64px -14720px; }
		._1f4dc{ width: 64px; height: 64px; background-position: 0 -12736px; }
		._1f4dd{ width: 64px; height: 64px; background-position: -64px -14784px; }
		._1f4de{ width: 64px; height: 64px; background-position: 0 -12672px; }
		._1f4df{ width: 64px; height: 64px; background-position: -64px -14848px; }
		._1f4e0{ width: 64px; height: 64px; background-position: 0 -12608px; }
		._1f4e1{ width: 64px; height: 64px; background-position: -64px -14912px; }
		._1f4e2{ width: 64px; height: 64px; background-position: 0 -12544px; }
		._1f4e3{ width: 64px; height: 64px; background-position: -64px -14976px; }
		._1f4e4{ width: 64px; height: 64px; background-position: 0 -12480px; }
		._1f4e5{ width: 64px; height: 64px; background-position: -64px -15040px; }
		._1f4e6{ width: 64px; height: 64px; background-position: 0 -12416px; }
		._1f4e7{ width: 64px; height: 64px; background-position: -64px -15104px; }
		._1f4e8{ width: 64px; height: 64px; background-position: 0 -12352px; }
		._1f4e9{ width: 64px; height: 64px; background-position: -64px -15168px; }
		._1f4ea{ width: 64px; height: 64px; background-position: 0 -12288px; }
		._1f4eb{ width: 64px; height: 64px; background-position: -64px -15232px; }
		._1f4ec{ width: 64px; height: 64px; background-position: 0 -12224px; }
		._1f4ed{ width: 64px; height: 64px; background-position: -64px -15296px; }
		._1f4ee{ width: 64px; height: 64px; background-position: 0 -12160px; }
		._1f4ef{ width: 64px; height: 64px; background-position: -64px -15360px; }
		._1f4f0{ width: 64px; height: 64px; background-position: 0 -12096px; }
		._1f4f1{ width: 64px; height: 64px; background-position: -64px -15424px; }
		._1f4f2{ width: 64px; height: 64px; background-position: 0 -12032px; }
		._1f4f3{ width: 64px; height: 64px; background-position: -64px -15488px; }
		._1f4f4{ width: 64px; height: 64px; background-position: 0 -11968px; }
		._1f4f5{ width: 64px; height: 64px; background-position: -64px -15552px; }
		._1f4f6{ width: 64px; height: 64px; background-position: 0 -11904px; }
		._1f4f7{ width: 64px; height: 64px; background-position: -64px -15616px; }
		._1f4f9{ width: 64px; height: 64px; background-position: 0 -11840px; }
		._1f4fa{ width: 64px; height: 64px; background-position: -64px -15680px; }
		._1f4fb{ width: 64px; height: 64px; background-position: 0 -11776px; }
		._1f4fc{ width: 64px; height: 64px; background-position: -64px -15744px; }
		._1f500{ width: 64px; height: 64px; background-position: 0 -11712px; }
		._1f501{ width: 64px; height: 64px; background-position: -64px -15808px; }
		._1f502{ width: 64px; height: 64px; background-position: 0 -11648px; }
		._1f503{ width: 64px; height: 64px; background-position: -64px -15872px; }
		._1f504{ width: 64px; height: 64px; background-position: 0 -11584px; }
		._1f505{ width: 64px; height: 64px; background-position: -64px -15936px; }
		._1f506{ width: 64px; height: 64px; background-position: 0 -11520px; }
		._1f507{ width: 64px; height: 64px; background-position: -64px -16000px; }
		._1f508{ width: 64px; height: 64px; background-position: 0 -11456px; }
		._1f509{ width: 64px; height: 64px; background-position: -64px -16064px; }
		._1f50a{ width: 64px; height: 64px; background-position: 0 -11392px; }
		._1f50b{ width: 64px; height: 64px; background-position: -64px -16128px; }
		._1f50c{ width: 64px; height: 64px; background-position: 0 -11328px; }
		._1f50d{ width: 64px; height: 64px; background-position: -64px -16192px; }
		._1f50e{ width: 64px; height: 64px; background-position: 0 -11264px; }
		._1f50f{ width: 64px; height: 64px; background-position: -64px -16256px; }
		._1f510{ width: 64px; height: 64px; background-position: 0 -11200px; }
		._1f511{ width: 64px; height: 64px; background-position: -64px -16320px; }
		._1f512{ width: 64px; height: 64px; background-position: 0 -11136px; }
		._1f513{ width: 64px; height: 64px; background-position: -64px -16384px; }
		._1f514{ width: 64px; height: 64px; background-position: 0 -11072px; }
		._1f515{ width: 64px; height: 64px; background-position: -64px -16448px; }
		._1f516{ width: 64px; height: 64px; background-position: 0 -11008px; }
		._1f517{ width: 64px; height: 64px; background-position: -64px -16512px; }
		._1f518{ width: 64px; height: 64px; background-position: 0 -10944px; }
		._1f519{ width: 64px; height: 64px; background-position: -64px -16576px; }
		._1f51a{ width: 64px; height: 64px; background-position: 0 -10880px; }
		._1f51b{ width: 64px; height: 64px; background-position: -64px -16640px; }
		._1f51c{ width: 64px; height: 64px; background-position: 0 -10816px; }
		._1f51d{ width: 64px; height: 64px; background-position: -64px -16704px; }
		._1f51e{ width: 64px; height: 64px; background-position: 0 -10752px; }
		._1f51f{ width: 64px; height: 64px; background-position: -64px -16768px; }
		._1f520{ width: 64px; height: 64px; background-position: 0 -10688px; }
		._1f521{ width: 64px; height: 64px; background-position: -64px -16832px; }
		._1f522{ width: 64px; height: 64px; background-position: 0 -10624px; }
		._1f523{ width: 64px; height: 64px; background-position: -64px -16896px; }
		._1f524{ width: 64px; height: 64px; background-position: 0 -10560px; }
		._1f525{ width: 64px; height: 64px; background-position: -64px -16960px; }
		._1f526{ width: 64px; height: 64px; background-position: 0 -10496px; }
		._1f527{ width: 64px; height: 64px; background-position: -64px -17024px; }
		._1f528{ width: 64px; height: 64px; background-position: 0 -10432px; }
		._1f529{ width: 64px; height: 64px; background-position: -64px -17088px; }
		._1f52a{ width: 64px; height: 64px; background-position: 0 -10368px; }
		._1f52b{ width: 64px; height: 64px; background-position: -64px -17152px; }
		._1f52c{ width: 64px; height: 64px; background-position: 0 -10304px; }
		._1f52d{ width: 64px; height: 64px; background-position: -64px -17216px; }
		._1f52e{ width: 64px; height: 64px; background-position: 0 -10240px; }
		._1f52f{ width: 64px; height: 64px; background-position: -64px -17280px; }
		._1f530{ width: 64px; height: 64px; background-position: 0 -10176px; }
		._1f531{ width: 64px; height: 64px; background-position: -64px -17344px; }
		._1f532{ width: 64px; height: 64px; background-position: 0 -10112px; }
		._1f533{ width: 64px; height: 64px; background-position: -64px -17408px; }
		._1f534{ width: 64px; height: 64px; background-position: 0 -10048px; }
		._1f535{ width: 64px; height: 64px; background-position: -64px -17472px; }
		._1f536{ width: 64px; height: 64px; background-position: 0 -9984px; }
		._1f537{ width: 64px; height: 64px; background-position: -64px -17536px; }
		._1f538{ width: 64px; height: 64px; background-position: 0 -9920px; }
		._1f539{ width: 64px; height: 64px; background-position: -64px -17600px; }
		._1f53a{ width: 64px; height: 64px; background-position: 0 -9856px; }
		._1f53b{ width: 64px; height: 64px; background-position: -64px -17664px; }
		._1f53c{ width: 64px; height: 64px; background-position: 0 -9792px; }
		._1f53d{ width: 64px; height: 64px; background-position: -64px -17728px; }
		._1f550{ width: 64px; height: 64px; background-position: 0 -9728px; }
		._1f551{ width: 64px; height: 64px; background-position: -64px -17792px; }
		._1f552{ width: 64px; height: 64px; background-position: 0 -9664px; }
		._1f553{ width: 64px; height: 64px; background-position: -64px -17856px; }
		._1f554{ width: 64px; height: 64px; background-position: 0 -9600px; }
		._1f555{ width: 64px; height: 64px; background-position: -64px -17920px; }
		._1f556{ width: 64px; height: 64px; background-position: 0 -9536px; }
		._1f557{ width: 64px; height: 64px; background-position: -64px -17984px; }
		._1f558{ width: 64px; height: 64px; background-position: 0 -9472px; }
		._1f559{ width: 64px; height: 64px; background-position: -64px -18048px; }
		._1f55a{ width: 64px; height: 64px; background-position: 0 -9408px; }
		._1f55b{ width: 64px; height: 64px; background-position: -64px -18112px; }
		._1f55c{ width: 64px; height: 64px; background-position: 0 -9344px; }
		._1f55d{ width: 64px; height: 64px; background-position: -64px -18176px; }
		._1f55e{ width: 64px; height: 64px; background-position: 0 -9280px; }
		._1f55f{ width: 64px; height: 64px; background-position: -64px -18240px; }
		._1f560{ width: 64px; height: 64px; background-position: 0 -9216px; }
		._1f561{ width: 64px; height: 64px; background-position: -64px -18304px; }
		._1f562{ width: 64px; height: 64px; background-position: 0 -9152px; }
		._1f563{ width: 64px; height: 64px; background-position: -64px -18368px; }
		._1f564{ width: 64px; height: 64px; background-position: 0 -9088px; }
		._1f565{ width: 64px; height: 64px; background-position: -64px -18432px; }
		._1f566{ width: 64px; height: 64px; background-position: 0 -9024px; }
		._1f567{ width: 64px; height: 64px; background-position: -64px -18496px; }
		._1f5fb{ width: 64px; height: 64px; background-position: 0 -8960px; }
		._1f5fc{ width: 64px; height: 64px; background-position: -64px -18560px; }
		._1f5fd{ width: 64px; height: 64px; background-position: 0 -8896px; }
		._1f5fe{ width: 64px; height: 64px; background-position: -64px -18624px; }
		._1f5ff{ width: 64px; height: 64px; background-position: 0 -8832px; }
		._1f600{ width: 64px; height: 64px; background-position: -64px -18688px; }
		._1f601{ width: 64px; height: 64px; background-position: 0 -8768px; }
		._1f602{ width: 64px; height: 64px; background-position: -64px -18752px; }
		._1f603{ width: 64px; height: 64px; background-position: 0 -8704px; }
		._1f604{ width: 64px; height: 64px; background-position: -64px -18816px; }
		._1f605{ width: 64px; height: 64px; background-position: 0 -8640px; }
		._1f606{ width: 64px; height: 64px; background-position: -64px -18880px; }
		._1f607{ width: 64px; height: 64px; background-position: 0 -8576px; }
		._1f608{ width: 64px; height: 64px; background-position: -64px -18944px; }
		._1f609{ width: 64px; height: 64px; background-position: 0 -8512px; }
		._1f60a{ width: 64px; height: 64px; background-position: -64px -19008px; }
		._1f60b{ width: 64px; height: 64px; background-position: 0 -8448px; }
		._1f60c{ width: 64px; height: 64px; background-position: -64px -19072px; }
		._1f60d{ width: 64px; height: 64px; background-position: 0 -8384px; }
		._1f60e{ width: 64px; height: 64px; background-position: -64px -19136px; }
		._1f60f{ width: 64px; height: 64px; background-position: 0 -8320px; }
		._1f610{ width: 64px; height: 64px; background-position: -64px -19200px; }
		._1f611{ width: 64px; height: 64px; background-position: 0 -8256px; }
		._1f612{ width: 64px; height: 64px; background-position: -64px -19264px; }
		._1f613{ width: 64px; height: 64px; background-position: 0 -8192px; }
		._1f614{ width: 64px; height: 64px; background-position: -64px -19328px; }
		._1f615{ width: 64px; height: 64px; background-position: 0 -8128px; }
		._1f616{ width: 64px; height: 64px; background-position: -64px -19392px; }
		._1f617{ width: 64px; height: 64px; background-position: 0 -8064px; }
		._1f618{ width: 64px; height: 64px; background-position: -64px -19456px; }
		._1f619{ width: 64px; height: 64px; background-position: 0 -8000px; }
		._1f61a{ width: 64px; height: 64px; background-position: -64px -19520px; }
		._1f61b{ width: 64px; height: 64px; background-position: 0 -7936px; }
		._1f61c{ width: 64px; height: 64px; background-position: -64px -19584px; }
		._1f61d{ width: 64px; height: 64px; background-position: 0 -7872px; }
		._1f61e{ width: 64px; height: 64px; background-position: -64px -19648px; }
		._1f61f{ width: 64px; height: 64px; background-position: 0 -7808px; }
		._1f620{ width: 64px; height: 64px; background-position: -64px -19712px; }
		._1f621{ width: 64px; height: 64px; background-position: 0 -7744px; }
		._1f622{ width: 64px; height: 64px; background-position: -64px -19776px; }
		._1f623{ width: 64px; height: 64px; background-position: 0 -7680px; }
		._1f624{ width: 64px; height: 64px; background-position: -64px -19840px; }
		._1f625{ width: 64px; height: 64px; background-position: 0 -7616px; }
		._1f626{ width: 64px; height: 64px; background-position: -64px -19904px; }
		._1f627{ width: 64px; height: 64px; background-position: 0 -7552px; }
		._1f628{ width: 64px; height: 64px; background-position: -64px -19968px; }
		._1f629{ width: 64px; height: 64px; background-position: 0 -7488px; }
		._1f62a{ width: 64px; height: 64px; background-position: -64px -20032px; }
		._1f62b{ width: 64px; height: 64px; background-position: 0 -7424px; }
		._1f62c{ width: 64px; height: 64px; background-position: -64px -20096px; }
		._1f62d{ width: 64px; height: 64px; background-position: 0 -7360px; }
		._1f62e{ width: 64px; height: 64px; background-position: -64px -20160px; }
		._1f62f{ width: 64px; height: 64px; background-position: 0 -7296px; }
		._1f630{ width: 64px; height: 64px; background-position: -64px -20224px; }
		._1f631{ width: 64px; height: 64px; background-position: 0 -7232px; }
		._1f632{ width: 64px; height: 64px; background-position: -64px -20288px; }
		._1f633{ width: 64px; height: 64px; background-position: 0 -7168px; }
		._1f634{ width: 64px; height: 64px; background-position: -64px -20352px; }
		._1f635{ width: 64px; height: 64px; background-position: 0 -7104px; }
		._1f636{ width: 64px; height: 64px; background-position: -64px -20416px; }
		._1f637{ width: 64px; height: 64px; background-position: 0 -7040px; }
		._1f638{ width: 64px; height: 64px; background-position: -64px -20480px; }
		._1f639{ width: 64px; height: 64px; background-position: 0 -6976px; }
		._1f63a{ width: 64px; height: 64px; background-position: -64px -20544px; }
		._1f63b{ width: 64px; height: 64px; background-position: 0 -6912px; }
		._1f63c{ width: 64px; height: 64px; background-position: -64px -20608px; }
		._1f63d{ width: 64px; height: 64px; background-position: 0 -6848px; }
		._1f63e{ width: 64px; height: 64px; background-position: -64px -20672px; }
		._1f63f{ width: 64px; height: 64px; background-position: 0 -6784px; }
		._1f640{ width: 64px; height: 64px; background-position: -64px -20736px; }
		._1f645{ width: 64px; height: 64px; background-position: 0 -6720px; }
		._1f646{ width: 64px; height: 64px; background-position: -64px -20800px; }
		._1f647{ width: 64px; height: 64px; background-position: 0 -6656px; }
		._1f648{ width: 64px; height: 64px; background-position: -64px -20864px; }
		._1f649{ width: 64px; height: 64px; background-position: 0 -6592px; }
		._1f64a{ width: 64px; height: 64px; background-position: -64px -20928px; }
		._1f64b{ width: 64px; height: 64px; background-position: 0 -6528px; }
		._1f64c{ width: 64px; height: 64px; background-position: -64px -20992px; }
		._1f64d{ width: 64px; height: 64px; background-position: 0 -6464px; }
		._1f64e{ width: 64px; height: 64px; background-position: -64px -21056px; }
		._1f64f{ width: 64px; height: 64px; background-position: 0 -6400px; }
		._1f680{ width: 64px; height: 64px; background-position: -64px -21120px; }
		._1f681{ width: 64px; height: 64px; background-position: 0 -6336px; }
		._1f682{ width: 64px; height: 64px; background-position: -64px -21184px; }
		._1f683{ width: 64px; height: 64px; background-position: 0 -6272px; }
		._1f684{ width: 64px; height: 64px; background-position: -64px -21248px; }
		._1f685{ width: 64px; height: 64px; background-position: 0 -6208px; }
		._1f686{ width: 64px; height: 64px; background-position: -64px -21312px; }
		._1f687{ width: 64px; height: 64px; background-position: 0 -6144px; }
		._1f688{ width: 64px; height: 64px; background-position: -64px -21376px; }
		._1f689{ width: 64px; height: 64px; background-position: 0 -6080px; }
		._1f68a{ width: 64px; height: 64px; background-position: -64px -21440px; }
		._1f68b{ width: 64px; height: 64px; background-position: 0 -6016px; }
		._1f68c{ width: 64px; height: 64px; background-position: -64px -21504px; }
		._1f68d{ width: 64px; height: 64px; background-position: 0 -5952px; }
		._1f68e{ width: 64px; height: 64px; background-position: -64px -21568px; }
		._1f68f{ width: 64px; height: 64px; background-position: 0 -5888px; }
		._1f690{ width: 64px; height: 64px; background-position: -64px -21632px; }
		._1f691{ width: 64px; height: 64px; background-position: 0 -5824px; }
		._1f692{ width: 64px; height: 64px; background-position: -64px -21696px; }
		._1f693{ width: 64px; height: 64px; background-position: 0 -5760px; }
		._1f694{ width: 64px; height: 64px; background-position: -64px -21760px; }
		._1f695{ width: 64px; height: 64px; background-position: 0 -5696px; }
		._1f696{ width: 64px; height: 64px; background-position: -64px -21824px; }
		._1f697{ width: 64px; height: 64px; background-position: 0 -5632px; }
		._1f698{ width: 64px; height: 64px; background-position: -64px -21888px; }
		._1f699{ width: 64px; height: 64px; background-position: 0 -5568px; }
		._1f69a{ width: 64px; height: 64px; background-position: -64px -21952px; }
		._1f69b{ width: 64px; height: 64px; background-position: 0 -5504px; }
		._1f69c{ width: 64px; height: 64px; background-position: -64px -22016px; }
		._1f69d{ width: 64px; height: 64px; background-position: 0 -5440px; }
		._1f69e{ width: 64px; height: 64px; background-position: -64px -22080px; }
		._1f69f{ width: 64px; height: 64px; background-position: 0 -5376px; }
		._1f6a0{ width: 64px; height: 64px; background-position: -64px -22144px; }
		._1f6a1{ width: 64px; height: 64px; background-position: 0 -5312px; }
		._1f6a2{ width: 64px; height: 64px; background-position: -64px -22208px; }
		._1f6a3{ width: 64px; height: 64px; background-position: 0 -5248px; }
		._1f6a4{ width: 64px; height: 64px; background-position: -64px -22272px; }
		._1f6a5{ width: 64px; height: 64px; background-position: 0 -5184px; }
		._1f6a6{ width: 64px; height: 64px; background-position: -64px -22336px; }
		._1f6a7{ width: 64px; height: 64px; background-position: 0 -5120px; }
		._1f6a8{ width: 64px; height: 64px; background-position: -64px -22400px; }
		._1f6a9{ width: 64px; height: 64px; background-position: 0 -5056px; }
		._1f6aa{ width: 64px; height: 64px; background-position: -64px -22464px; }
		._1f6ab{ width: 64px; height: 64px; background-position: 0 -4992px; }
		._1f6ac{ width: 64px; height: 64px; background-position: -64px -22528px; }
		._1f6ad{ width: 64px; height: 64px; background-position: 0 -4928px; }
		._1f6ae{ width: 64px; height: 64px; background-position: -64px -22592px; }
		._1f6af{ width: 64px; height: 64px; background-position: 0 -4864px; }
		._1f6b0{ width: 64px; height: 64px; background-position: -64px -22656px; }
		._1f6b1{ width: 64px; height: 64px; background-position: 0 -4800px; }
		._1f6b2{ width: 64px; height: 64px; background-position: -64px -22720px; }
		._1f6b3{ width: 64px; height: 64px; background-position: 0 -4736px; }
		._1f6b4{ width: 64px; height: 64px; background-position: -64px -22784px; }
		._1f6b5{ width: 64px; height: 64px; background-position: 0 -4672px; }
		._1f6b6{ width: 64px; height: 64px; background-position: -64px -22848px; }
		._1f6b7{ width: 64px; height: 64px; background-position: 0 -4608px; }
		._1f6b8{ width: 64px; height: 64px; background-position: -64px -22912px; }
		._1f6b9{ width: 64px; height: 64px; background-position: 0 -4544px; }
		._1f6ba{ width: 64px; height: 64px; background-position: -64px -22976px; }
		._1f6bb{ width: 64px; height: 64px; background-position: 0 -4480px; }
		._1f6bc{ width: 64px; height: 64px; background-position: -64px -23040px; }
		._1f6bd{ width: 64px; height: 64px; background-position: 0 -4416px; }
		._1f6be{ width: 64px; height: 64px; background-position: -64px -23104px; }
		._1f6bf{ width: 64px; height: 64px; background-position: 0 -4352px; }
		._1f6c0{ width: 64px; height: 64px; background-position: -64px -23168px; }
		._1f6c1{ width: 64px; height: 64px; background-position: 0 -4288px; }
		._1f6c2{ width: 64px; height: 64px; background-position: -64px -23232px; }
		._1f6c3{ width: 64px; height: 64px; background-position: 0 -4224px; }
		._1f6c4{ width: 64px; height: 64px; background-position: -64px -23296px; }
		._1f6c5{ width: 64px; height: 64px; background-position: 0 -4160px; }
		._203c{ width: 64px; height: 64px; background-position: -64px -23360px; }
		._2049{ width: 64px; height: 64px; background-position: 0 -4096px; }
		._2122{ width: 64px; height: 64px; background-position: -64px -23424px; }
		._2139{ width: 64px; height: 64px; background-position: 0 -4032px; }
		._2194{ width: 64px; height: 64px; background-position: -64px -23488px; }
		._2195{ width: 64px; height: 64px; background-position: 0 -3968px; }
		._2196{ width: 64px; height: 64px; background-position: -64px -23552px; }
		._2197{ width: 64px; height: 64px; background-position: 0 -3904px; }
		._2198{ width: 64px; height: 64px; background-position: -64px -23616px; }
		._2199{ width: 64px; height: 64px; background-position: 0 -3840px; }
		._21a9{ width: 64px; height: 64px; background-position: -64px -23680px; }
		._21aa{ width: 64px; height: 64px; background-position: 0 -3776px; }
		._231a{ width: 64px; height: 64px; background-position: -64px -23744px; }
		._231b{ width: 64px; height: 64px; background-position: 0 -3712px; }
		._23e9{ width: 64px; height: 64px; background-position: -64px -23808px; }
		._23ea{ width: 64px; height: 64px; background-position: 0 -3648px; }
		._23eb{ width: 64px; height: 64px; background-position: -64px -23872px; }
		._23ec{ width: 64px; height: 64px; background-position: 0 -3584px; }
		._23f0{ width: 64px; height: 64px; background-position: -64px -23936px; }
		._23f3{ width: 64px; height: 64px; background-position: 0 -3520px; }
		._24c2{ width: 64px; height: 64px; background-position: -64px -24000px; }
		._25aa{ width: 64px; height: 64px; background-position: 0 -3456px; }
		._25ab{ width: 64px; height: 64px; background-position: -64px -24064px; }
		._25b6{ width: 64px; height: 64px; background-position: 0 -3392px; }
		._25c0{ width: 64px; height: 64px; background-position: -64px -24128px; }
		._25fb{ width: 64px; height: 64px; background-position: 0 -3328px; }
		._25fc{ width: 64px; height: 64px; background-position: -64px -24192px; }
		._25fd{ width: 64px; height: 64px; background-position: 0 -3264px; }
		._25fe{ width: 64px; height: 64px; background-position: -64px -24256px; }
		._2600{ width: 64px; height: 64px; background-position: 0 -3200px; }
		._2601{ width: 64px; height: 64px; background-position: -64px -24320px; }
		._260e{ width: 64px; height: 64px; background-position: 0 -3136px; }
		._2611{ width: 64px; height: 64px; background-position: -64px -24384px; }
		._2614{ width: 64px; height: 64px; background-position: 0 -3072px; }
		._2615{ width: 64px; height: 64px; background-position: -64px -24448px; }
		._261d{ width: 64px; height: 64px; background-position: 0 -3008px; }
		._263a{ width: 64px; height: 64px; background-position: -64px -24512px; }
		._2648{ width: 64px; height: 64px; background-position: 0 -2944px; }
		._2649{ width: 64px; height: 64px; background-position: -64px -24576px; }
		._264a{ width: 64px; height: 64px; background-position: 0 -2880px; }
		._264b{ width: 64px; height: 64px; background-position: -64px -24640px; }
		._264c{ width: 64px; height: 64px; background-position: 0 -2816px; }
		._264d{ width: 64px; height: 64px; background-position: -64px -24704px; }
		._264e{ width: 64px; height: 64px; background-position: 0 -2752px; }
		._264f{ width: 64px; height: 64px; background-position: -64px -24768px; }
		._2650{ width: 64px; height: 64px; background-position: 0 -2688px; }
		._2651{ width: 64px; height: 64px; background-position: -64px -24832px; }
		._2652{ width: 64px; height: 64px; background-position: 0 -2624px; }
		._2653{ width: 64px; height: 64px; background-position: -64px -24896px; }
		._2660{ width: 64px; height: 64px; background-position: 0 -2560px; }
		._2663{ width: 64px; height: 64px; background-position: -64px -24960px; }
		._2665{ width: 64px; height: 64px; background-position: 0 -2496px; }
		._2666{ width: 64px; height: 64px; background-position: -64px -25024px; }
		._2668{ width: 64px; height: 64px; background-position: 0 -2432px; }
		._267b{ width: 64px; height: 64px; background-position: -64px -25088px; }
		._267f{ width: 64px; height: 64px; background-position: 0 -2368px; }
		._2693{ width: 64px; height: 64px; background-position: -64px -25152px; }
		._26a0{ width: 64px; height: 64px; background-position: 0 -2304px; }
		._26a1{ width: 64px; height: 64px; background-position: -64px -25216px; }
		._26aa{ width: 64px; height: 64px; background-position: 0 -2240px; }
		._26ab{ width: 64px; height: 64px; background-position: -64px -25280px; }
		._26bd{ width: 64px; height: 64px; background-position: 0 -2176px; }
		._26be{ width: 64px; height: 64px; background-position: -64px -25344px; }
		._26c4{ width: 64px; height: 64px; background-position: 0 -2112px; }
		._26c5{ width: 64px; height: 64px; background-position: -64px -25408px; }
		._26ce{ width: 64px; height: 64px; background-position: 0 -2048px; }
		._26d4{ width: 64px; height: 64px; background-position: -64px -25472px; }
		._26ea{ width: 64px; height: 64px; background-position: 0 -1984px; }
		._26f2{ width: 64px; height: 64px; background-position: -64px -25536px; }
		._26f3{ width: 64px; height: 64px; background-position: 0 -1920px; }
		._26f5{ width: 64px; height: 64px; background-position: -64px -25600px; }
		._26fa{ width: 64px; height: 64px; background-position: 0 -1856px; }
		._26fd{ width: 64px; height: 64px; background-position: -64px -25664px; }
		._2702{ width: 64px; height: 64px; background-position: 0 -1792px; }
		._2705{ width: 64px; height: 64px; background-position: -64px -25728px; }
		._2708{ width: 64px; height: 64px; background-position: 0 -1728px; }
		._2709{ width: 64px; height: 64px; background-position: -64px -25792px; }
		._270a{ width: 64px; height: 64px; background-position: 0 -1664px; }
		._270b{ width: 64px; height: 64px; background-position: -64px -25856px; }
		._270c{ width: 64px; height: 64px; background-position: 0 -1600px; }
		._270f{ width: 64px; height: 64px; background-position: -64px -25920px; }
		._2712{ width: 64px; height: 64px; background-position: 0 -1536px; }
		._2714{ width: 64px; height: 64px; background-position: -64px -25984px; }
		._2716{ width: 64px; height: 64px; background-position: 0 -1472px; }
		._2728{ width: 64px; height: 64px; background-position: -64px -26048px; }
		._2733{ width: 64px; height: 64px; background-position: 0 -1408px; }
		._2734{ width: 64px; height: 64px; background-position: -64px -26112px; }
		._2744{ width: 64px; height: 64px; background-position: 0 -1344px; }
		._2747{ width: 64px; height: 64px; background-position: -64px -26176px; }
		._274c{ width: 64px; height: 64px; background-position: 0 -1280px; }
		._274e{ width: 64px; height: 64px; background-position: -64px -26240px; }
		._2753{ width: 64px; height: 64px; background-position: 0 -1216px; }
		._2754{ width: 64px; height: 64px; background-position: -64px -26304px; }
		._2755{ width: 64px; height: 64px; background-position: 0 -1152px; }
		._2757{ width: 64px; height: 64px; background-position: -64px -26368px; }
		._2764{ width: 64px; height: 64px; background-position: 0 -1088px; }
		._2795{ width: 64px; height: 64px; background-position: -64px -26432px; }
		._2796{ width: 64px; height: 64px; background-position: 0 -1024px; }
		._2797{ width: 64px; height: 64px; background-position: -64px -26496px; }
		._27a1{ width: 64px; height: 64px; background-position: 0 -960px; }
		._27b0{ width: 64px; height: 64px; background-position: -64px -26560px; }
		._27bf{ width: 64px; height: 64px; background-position: 0 -896px; }
		._2934{ width: 64px; height: 64px; background-position: -64px -26624px; }
		._2935{ width: 64px; height: 64px; background-position: 0 -832px; }
		._2b05{ width: 64px; height: 64px; background-position: -64px -26688px; }
		._2b06{ width: 64px; height: 64px; background-position: 0 -768px; }
		._2b07{ width: 64px; height: 64px; background-position: -64px -26752px; }
		._2b1b{ width: 64px; height: 64px; background-position: 0 -704px; }
		._2b1c{ width: 64px; height: 64px; background-position: -64px -26816px; }
		._2b50{ width: 64px; height: 64px; background-position: 0 -640px; }
		._2b55{ width: 64px; height: 64px; background-position: -64px -26880px; }
		._3030{ width: 64px; height: 64px; background-position: 0 -576px; }
		._303d{ width: 64px; height: 64px; background-position: -64px -26944px; }
		._3297{ width: 64px; height: 64px; background-position: 0 -512px; }
		._3299{ width: 64px; height: 64px; background-position: -64px -27008px; }
		._bowtie{ width: 64px; height: 64px; background-position: 0 -448px; }
		._feelsgood{ width: 64px; height: 64px; background-position: -64px -27072px; }
		._finnadie{ width: 64px; height: 64px; background-position: 0 -384px; }
		._fu{ width: 64px; height: 64px; background-position: -64px -27136px; }
		._goberserk{ width: 64px; height: 64px; background-position: 0 -320px; }
		._godmode{ width: 64px; height: 64px; background-position: -64px -27200px; }
		._hurtrealbad{ width: 64px; height: 64px; background-position: 0 -256px; }
		._metal{ width: 64px; height: 64px; background-position: -64px -27264px; }
		._neckbeard{ width: 64px; height: 64px; background-position: 0 -192px; }
		._octocat{ width: 64px; height: 64px; background-position: -64px -27328px; }
		._rage1{ width: 64px; height: 64px; background-position: 0 -128px; }
		._rage2{ width: 64px; height: 64px; background-position: -64px -27392px; }
		._rage3{ width: 64px; height: 64px; background-position: 0 -64px; }
		._rage4{ width: 64px; height: 64px; background-position: -64px -27456px; }
		._suspect{ width: 64px; height: 64px; background-position: 0 0; }
		._trollface{ width: 64px; height: 64px; background-position: -75px -27520px; }
	</style>
	
	<!-- 
    Change code block syntax highlighting styles by commenting out the 
	  default MDE sytle and uncommenting one of the styles below.
	  Works only with GitHub Markdown engine
	-->
	
	<!-- Default MDE syntax style -->
	<style type="text/css">
		code { font-family: consolas, monospace; background-color: #f7f7f7; padding: .2pt; border-radius: 2pt; line-height: 1.3; }
		pre { background-color: transparent; }
		pre code { font-size: 95%; padding: 12pt; display: block; border-radius: 2pt; }
	</style>
	
	<!-- pygments -->
	<!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code > span.dt { color: #902000; } /* DataType */
    code > span.dv { color: #40a070; } /* DecVal */
    code > span.bn { color: #40a070; } /* BaseN */
    code > span.fl { color: #40a070; } /* Float */
    code > span.ch { color: #4070a0; } /* Char */
    code > span.st { color: #4070a0; } /* String */
    code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code > span.ot { color: #007020; } /* Other */
    code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code > span.fu { color: #06287e; } /* Function */
    code > span.er { color: #ff0000; font-weight: bold; } /* Error */
    code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    code > span.cn { color: #880000; } /* Constant */
    code > span.sc { color: #4070a0; } /* SpecialChar */
    code > span.vs { color: #4070a0; } /* VerbatimString */
    code > span.ss { color: #bb6688; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { color: #19177c; } /* Variable */
    code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code > span.op { color: #666666; } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { color: #bc7a00; } /* Preprocessor */
    code > span.at { color: #7d9029; } /* Attribute */
    code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  -->
  
  <!-- kate -->
  <!--
    <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { font-weight: bold; } /* Keyword */
    code > span.dt { color: #800000; } /* DataType */
    code > span.dv { color: #0000ff; } /* DecVal */
    code > span.bn { color: #0000ff; } /* BaseN */
    code > span.fl { color: #800080; } /* Float */
    code > span.ch { color: #ff00ff; } /* Char */
    code > span.st { color: #dd0000; } /* String */
    code > span.co { color: #808080; font-style: italic; } /* Comment */
    code > span.al { color: #00ff00; font-weight: bold; } /* Alert */
    code > span.fu { color: #000080; } /* Function */
    code > span.er { color: #ff0000; font-weight: bold; } /* Error */
    code > span.wa { color: #ff0000; font-weight: bold; } /* Warning */
    code > span.cn { color: #000000; } /* Constant */
    code > span.sc { color: #ff00ff; } /* SpecialChar */
    code > span.vs { color: #dd0000; } /* VerbatimString */
    code > span.ss { color: #dd0000; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { } /* ControlFlow */
    code > span.op { } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { font-weight: bold; } /* Preprocessor */
    code > span.at { } /* Attribute */
    code > span.do { color: #808080; font-style: italic; } /* Documentation */
    code > span.an { color: #808080; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.cv { color: #808080; font-weight: bold; font-style: italic; } /* CommentVar */
    code > span.in { color: #808080; font-weight: bold; font-style: italic; } /* Information */
  </style>
  -->
  
  <!-- monochrome -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { font-weight: bold; } /* Keyword */
    code > span.dt { text-decoration: underline; } /* DataType */
    code > span.co { font-style: italic; } /* Comment */
    code > span.al { font-weight: bold; } /* Alert */
    code > span.er { font-weight: bold; } /* Error */
    code > span.wa { font-style: italic; } /* Warning */
    code > span.cf { font-weight: bold; } /* ControlFlow */
    code > span.pp { font-weight: bold; } /* Preprocessor */
    code > span.do { font-style: italic; } /* Documentation */
    code > span.an { font-style: italic; } /* Annotation */
    code > span.cv { font-style: italic; } /* CommentVar */
    code > span.in { font-style: italic; } /* Information */
  </style>
  -->
  
  <!-- expresso -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; background-color: #2a211c; color: #bdae9d; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #2a211c; color: #bdae9d; border-right: 1px solid #bdae9d; }
    td.sourceCode { padding-left: 5px; }
    pre, code { color: #bdae9d; background-color: #2a211c; }
    code > span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
    code > span.dt { text-decoration: underline; } /* DataType */
    code > span.dv { color: #44aa43; } /* DecVal */
    code > span.bn { color: #44aa43; } /* BaseN */
    code > span.fl { color: #44aa43; } /* Float */
    code > span.ch { color: #049b0a; } /* Char */
    code > span.st { color: #049b0a; } /* String */
    code > span.co { color: #0066ff; font-style: italic; } /* Comment */
    code > span.al { color: #ffff00; } /* Alert */
    code > span.fu { color: #ff9358; font-weight: bold; } /* Function */
    code > span.er { color: #ffff00; font-weight: bold; } /* Error */
    code > span.wa { color: #ffff00; font-weight: bold; } /* Warning */
    code > span.cn { } /* Constant */
    code > span.sc { color: #049b0a; } /* SpecialChar */
    code > span.vs { color: #049b0a; } /* VerbatimString */
    code > span.ss { color: #049b0a; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
    code > span.op { } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { font-weight: bold; } /* Preprocessor */
    code > span.at { } /* Attribute */
    code > span.do { color: #0066ff; font-style: italic; } /* Documentation */
    code > span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
    code > span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
  </style>  
  -->
  
  <!-- zenburn -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
    td.sourceCode { padding-left: 5px; }
    pre, code { color: #cccccc; background-color: #303030; }
    code > span.kw { color: #f0dfaf; } /* Keyword */
    code > span.dt { color: #dfdfbf; } /* DataType */
    code > span.dv { color: #dcdccc; } /* DecVal */
    code > span.bn { color: #dca3a3; } /* BaseN */
    code > span.fl { color: #c0bed1; } /* Float */
    code > span.ch { color: #dca3a3; } /* Char */
    code > span.st { color: #cc9393; } /* String */
    code > span.co { color: #7f9f7f; } /* Comment */
    code > span.ot { color: #efef8f; } /* Other */
    code > span.al { color: #ffcfaf; } /* Alert */
    code > span.fu { color: #efef8f; } /* Function */
    code > span.er { color: #c3bf9f; } /* Error */
    code > span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
    code > span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
    code > span.sc { color: #dca3a3; } /* SpecialChar */
    code > span.vs { color: #cc9393; } /* VerbatimString */
    code > span.ss { color: #cc9393; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { color: #f0dfaf; } /* ControlFlow */
    code > span.op { color: #f0efd0; } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
    code > span.at { } /* Attribute */
    code > span.do { color: #7f9f7f; } /* Documentation */
    code > span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
    code > span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
    code > span.in { color: #7f9f7f; font-weight: bold; } /* Information */
  </style>
  -->
  
  <!-- haddock -->
  <!--
   <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { color: #0000ff; } /* Keyword */
    code > span.ch { color: #008080; } /* Char */
    code > span.st { color: #008080; } /* String */
    code > span.co { color: #008000; } /* Comment */
    code > span.ot { color: #ff4000; } /* Other */
    code > span.al { color: #ff0000; } /* Alert */
    code > span.er { color: #ff0000; font-weight: bold; } /* Error */
    code > span.wa { color: #008000; font-weight: bold; } /* Warning */
    code > span.cn { } /* Constant */
    code > span.sc { color: #008080; } /* SpecialChar */
    code > span.vs { color: #008080; } /* VerbatimString */
    code > span.ss { color: #008080; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { color: #0000ff; } /* ControlFlow */
    code > span.op { } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { color: #ff4000; } /* Preprocessor */
    code > span.do { color: #008000; } /* Documentation */
    code > span.an { color: #008000; } /* Annotation */
    code > span.cv { color: #008000; } /* CommentVar */
    code > span.at { } /* Attribute */
    code > span.in { color: #008000; } /* Information */
  </style>
  -->
  
  <!-- tango -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
    td.sourceCode { padding-left: 5px; }
    pre, code { background-color: #f8f8f8; }
    code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code > span.dt { color: #204a87; } /* DataType */
    code > span.dv { color: #0000cf; } /* DecVal */
    code > span.bn { color: #0000cf; } /* BaseN */
    code > span.fl { color: #0000cf; } /* Float */
    code > span.ch { color: #4e9a06; } /* Char */
    code > span.st { color: #4e9a06; } /* String */
    code > span.co { color: #8f5902; font-style: italic; } /* Comment */
    code > span.ot { color: #8f5902; } /* Other */
    code > span.al { color: #ef2929; } /* Alert */
    code > span.fu { color: #000000; } /* Function */
    code > span.er { color: #a40000; font-weight: bold; } /* Error */
    code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    code > span.cn { color: #000000; } /* Constant */
    code > span.sc { color: #000000; } /* SpecialChar */
    code > span.vs { color: #4e9a06; } /* VerbatimString */
    code > span.ss { color: #4e9a06; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { color: #000000; } /* Variable */
    code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code > span.ex { } /* Extension */
    code > span.at { color: #c4a000; } /* Attribute */
    code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
  </style>  
  -->
<style>
 #content {
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
      color: black;
      font-family: "Roboto", Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 1.3rem;
      word-wrap: break-word;
      padding-left: 0.5rem;
      padding-right: 0.5rem;
    }

 h1,h2,h3,h4,h5,h6 {
      font-family: "Roboto", Arial, sans-serif;
      font-weight: bold;
      color: #777;
    }

 h1 {
      margin: 1.6em -0.5rem 0.5rem -0.5rem;
      padding: 0.3rem 0.5em;
      font-size: 1.6em;
      background-color: rgb(240,240,240);
      border-top: 3px solid rgb(200,200,200);
    }

 h2 {
      margin: 1.5em -0.5rem 0.5rem -0.5em;
      padding: 0.3rem 0.5em;
      background-color: rgb(240,240,240);
      font-size: 1.5em;
    }

 h3 {
      margin-top: 1.3em;
      margin-bottom: 0.3em;
      padding-top: 0.2em;
      padding-bottom: 0.2em;
      font-size: 1.3em;
    }

 h4 {
      margin-top: 1.2em;
      margin-bottom: 0.2em;
      padding-top: 0.1em;
      padding-bottom: 0.1em;
      font-size: 1.2em;
    }

 h5 {
      margin-top: 1.1em;
      margin-bottom: 0.1em;
      padding-top: 0.1em;
      padding-bottom: 0.1em;
      font-size: 1.1em;
    }

 h6 {
      margin-top: 1.1em;
      margin-bottom: 0.1em;
      padding-top: 0.1em;
      padding-bottom: 0.1em;
      font-size: 1em;
    }

 ul, ol {
      padding: 0;
      margin-top: 0;
      margin-bottom: 0;
    }

 ol ol, ul ol {
      list-style-type: lower-roman;
    }

 ul ul ol, ul ol ol, ol ul ol, ol ol ol {
      list-style-type: lower-alpha;
    }

 blockquote, ul, ol, dl, table, pre {
      margin-top: 0;
      margin-bottom: 0.5em;
    }

 hr {
      height: 4px;
      padding: 0;
      margin: 16px 0;
      background-color: #e7e7e7;
      border: 0 none;
    }

 ul, ol {
      padding-left: 2em;
    }

 ul ul, ul ol, ol ol, ol ul {
      margin-top: 0;
      margin-bottom: 0;
    }

 li>p {
      margin-top: 16px;
    }

 blockquote { background-color: rgb(240,240,240); margin: 1em 0; padding: 0.2em 0.5em; border-left:0.4em solid rgb(180,180,180); }
 
 code { background-color: rgb(240,240,240); padding: 0 3px; font-family: "Roboto Mono", "Courier new", monospace; font-size:1em;}

 table, th, td { border: 1px solid rgb(200,200,200); border-collapse: collapse; padding:0.5em; }

 p {font-size:1em; margin:0.5em 0;}

 em {color:#cc0000!important; }
</style>
  </head>
<body>
<!-- Content goes here. The div must have an id of "content" -->
<div id="content"><h1>Document DB - API</h1>
<h1>Requtes HTTP et Contextes d'excution</h1>
<p>Les sessions externes mettent des requtes HTTPS qui peuvent tre des GET ou des POST.</p>
<h3>Applications : <code>context-path</code>, ping, build</h3>
<p>Un serveur ou pool de serveurs accessible par une URL peut servir plusieurs applications d'objets diffrents. Le dbut de l'URL aprs le nom du serveur est le code de cette application :</p>
<pre><code>https://site.org/theApp/xxx...
</code></pre>
<p>Un serveur ou pool de serveurs qui ne sert qu'une unique application a une URL qui ignore <code>theApp</code> :</p>
<pre><code>https://site.otg/xxx...
</code></pre>
<p>Le code <code>theApp</code> ci-dessus est nomm techniquement <code>context-path</code> et peut tre &quot;&quot; ou contenir <code>&quot;theApp&quot;</code>.</p>
<p>Quand il s'agit d'un pool de serveur, il y a en gnral :</p>
<ul>
<li>une adresse pour le pool sans savoir  quel serveur physique on s'adresse :  <code>https://pool.site.org/...</code> ou le cas chant <code>https://site.org/...</code> C'est l'utilisation la plus frquente.</li>
<li>une adresse indiquant prcisment quel serveur physique est  joindre : <code>https://django.site.org/...</code> Cet adressage est rserv  des oprations techniques particulires, typiquement celles de commandes d'un <em>QueueManager</em> grant les tches diffres des applications.</li>
</ul>
<p>Pour dterminer si l'application <code>theApp</code> est en ligne on peut utiliser les commandes :</p>
<pre><code>1 - https://site.org/theApp/ping
2 - https://django.site.org/theApp/ping
</code></pre>
<p>Dans le cas 1, un serveur du pool rpond qu'il est prt  recevoir des requtes.<br>
Dans le cas 2, le serveur spcifique adress rpond qu'il est prt  recevoir des requtes.</p>
<p>Chaque application a une version du logiciel nomme <code>build</code> qui est un numro toujours croissant au fil du temps : le ping retourne un texte de la forme <code>{t:171205184532456, b:132}</code></p>
<ul>
<li><code>t</code> indique la date-heure courante du serveur en millisecondes UTC : le 5 dcembre 2017  18:45:32 et 456 millisecondes.</li>
<li><code>b</code> indique le numro de build (la version de l'application).</li>
</ul>
<h3>Organisations : code stop</h3>
<p>Une application donne peut tre dploye pour le compte de plusieurs <strong>organisations</strong>, les donnes de chacune tant tanches de celles des autres mais :</p>
<ul>
<li>toutes excutent la mme application sous la mme version (build) du logiciel.</li>
<li>chaque organisation, indpendamment des autres, peut tre mise on/off par un administrateur technique.
<ul>
<li>quand l'application est <strong>on</strong> son code <code>off</code> vaut 0 (ou est absent).</li>
<li>quand l'application est <strong>off</strong> son code <code>off</code> a deux chiffres :
<ul>
<li>le premier indique la raison de l'arrt, par exemple :
<ul>
<li>1-maintenance technique,</li>
<li>2-suspension administrative temporaire,</li>
<li>3-exportation vers un autre site,</li>
<li>4-opration de scurit,</li>
<li>9-clture dfinitive.</li>
</ul>
</li>
<li>le second donne une ide du dlai d'interruption estim, par exemple :
<ul>
<li>0-totalement inconnu et non matris,</li>
<li>1-trs courte dure (secondes),</li>
<li>2-courte dure, de l'ordre de dizaines de minutes  une heure ou deux,</li>
<li>3-plusieurs heures,</li>
<li>4-plusieurs jours,</li>
<li>5-plusieurs semaines ou mois.</li>
<li>9-pas de reprise envisage.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Datastore / Base de donnes</strong>
Une organisation donne a ses donnes permanentes gres par un Datastore / Base de donnes, sachant que chaque base peut techniquement hberger les donnes de plusieurs organisations.</p>
<ul>
<li>les donnes d'une organisation sont techniquement tanches de celles des autres mme dans le mme Datastore / Base de donnes.</li>
<li>elles peuvent tre techniquement facilement exportes / purges sans perturbation pour les autres organisations dont les donnes seraient co-hberges (mais l'exportation peut tre trs longue).</li>
</ul>
<p>L'URL qui permet d'accder  l'application d'une organisation a la forme suivante :</p>
<pre><code>https://site.org/theApp/monOrg/...
</code></pre>
<p>La commande <code>https://site.org/theApp/monOrg/ping</code> permet de connatre le statut de l'application pour cette organisation :</p>
<pre><code>{t:171205184532456, b:132, off:12, db:&quot;PG-10.1 [cna]&quot;}
</code></pre>
<p>Le code <code>off</code> est celui dcrit ci-dessus et est absent quand l'application est on pour cette organisation.<br>
Le code <code>db</code> donne le type de Datastore utilis (Postgresql 10.1) et son identifiant local (cna).<br>
Le texte du code derrire <code>db</code> peut tre un code d'erreur si la base de donnes est indisponible pour une raison technique.</p>
<p><strong>Queue Managers</strong>
Certains serveurs physiques sont charg de grer la file des tches diffres pour une ou plusieurs organisations : ces serveur ont un profil de Queue Manager.</p>
<p>Un Queue Manageur a un code commenant par <code>qm</code>) : qm1 qm7 etc. Dans une URL visant exclusivement un serveur physique (pas l'adresse d'un pool) un administrateur technique peut adresser des requtes au QueueManager :</p>
<pre><code>https://django.site.org/theApp/qm7/...
</code></pre>
<p>Si ce serveur n'hberge pas de Queue Manager, ou pas celui de code qm7, la requte revient avec un code d'erreur 500.</p>
<p><strong><em>Raccourcis d'URLs</em></strong> pour un GET<br>
La configuration permet de dfinir des URLs raccourcies correspondant aux chargements des pages : ceci permet de fournir aux utilisateurs une URL plus simple et en particulier de sauter le <em>code de l'organisation</em>. In fine ds le dbut du GET la substitution intervient et c'est comme si l'utilisateur avait saisi l'URL complte.</p>
<pre><code>https://site.org/theApp/app -&gt; https://site.org/theApp/monOrg/page-home.app
</code></pre>
<p><strong>URLs possibles</strong> (sans context-path pour simplifier)</p>
<pre><code>org -&gt; ns
/ping
/ns/ping          // ping du namespace et de sa base
/ns/x.appcache    // ressource MANIFEST d'une appcache
/ns/x.swjs        // ressource sw.js de Service Worker
/ns/mapage.app    // page de l'application .app .cloud .local .sync
/ns/op/...        // opration standard
/ns/od/taskid     // opration diffre (tche)
/var/...          // ressource
/_12_2/...        // ressource versinne pour viter les problmes de cache
/var/z/...        // ressource dynamique (custom.css custom.js ...)
/_12_2/...        // ressource dynamique
</code></pre>
<p>Une ressource dynamique <code>/var/z/xxx.yyy</code> est d'abord recherche dans la base dans le namespace nomm <code>namespace</code> dans un document ayant pour docid le code <code>ns</code> du namespace qu'il customise.</p>
<ul>
<li>ceci permet de dfinir des pages plus spcifiques par organisation et de les adapter en runtime et pas seulement sur une livraison de build.</li>
<li>si la ressource n'est pas trouve customise, c'est celle effectivement <code>/var/z/</code> correspondante qui est prise.</li>
<li>il n'est donc possible de customiser QUE des ressources existantes dans <code>/var/z</code>.</li>
<li>le namespace <code>namespace</code> ne supporte pas la customisation : en cas d'erreur de script par exemple l'application serait bloque.</li>
</ul>
<h3>Invocation d'oprations</h3>
<p>URLs : <code>cp/ns/op/p1/p2 ...</code>  ou <code>cp/ns/od/taskid</code></p>
<p>Les autres arguments sont passs soit en <code>application/x-www-form-urlencoded</code> (sur un GET) ou en <code>multipart/form-data</code> (sur un POST) :</p>
<ul>
<li><code>op/</code> :  obligatoire, signale un appel d'opration. Ce code est <code>od/</code> pour une opration diffre <em>mise</em> par le Queue Manager.</li>
<li><code>p1 p2 ...</code> sont facultatifs. Ils peuvent tre obtenus par <code>inputData.uri()</code> qui retourne un <code>String[]</code>;</li>
<li>les <strong><em>arguments</em></strong> sont rcuprables par <code>inputData.args().get(&quot;nom argument&quot;)</code>:
<ul>
<li>l'argument de nom <strong><code>op</code></strong> donne le nom de l'opration et permet de trouver la classe de l'opration  instancier.</li>
<li>les arguments de nom <strong><code>account key sudo</code></strong> sont en gnral utiliss pour grer les habilitations  effectuer l'opration.</li>
<li>l'argument de nom <strong><code>param</code></strong> est trait spcifiquement : c'est un JSON et il est d-srialis dans le champ de nom <code>param</code> de l'opration.</li>
<li><strong><em>dans le cas d'un POST des pices jointes peuvent tre transmises</em></strong> : elles sont rcuprables par <code>inputData.attachments().get(&quot;name&quot;)</code> qui retourne un objet (ou <code>null</code>) portant les informations <code>name, fileName, contentType, bytes</code>.</li>
</ul>
</li>
</ul>
<h2><code>ExecContext</code></h2>
<p>Un objet de la classe <code>ExecContext</code> est cr par l'arrive d'une requte et suit son thread durant sa vie.<br>
Cet objet se rcupre par <code>ExecContext.current()</code>  n'importe quel endroit du code.</p>
<p>Quelques informations disponibles sur <code>ExecContext</code> :</p>
<pre><code>public boolean hasAdminKey() 
</code></pre>
<p>Retourne true si l'argument de la requte <code>admin</code> en base 64, reprsente un <code>byte[]</code> dont le SHA-256 en base 64 est gal au paramtre de configuration <code>secretKey</code>.</p>
<pre><code>public boolean hasQmKey() 
</code></pre>
<p>Retourne true si l'argument de la requte <code>admin</code> en base 64, reprsente un <code>byte[]</code> dont le SHA-256 en base 64 est gal au paramtre de configuration <code>qmSecretKey</code>.</p>
<pre><code>public int phase() 
</code></pre>
<p>Retourne numro de phase ou s'en trouve l'excuion.</p>
<pre><code>public String operationName()
public Operation operation()
</code></pre>
<p>Retournent le nom de l'opration en cours et son objet (du moins quand la requte en est  une phase o une opration est en excuttion <code>work()</code> ou <code>afterwork()</code>).</p>
<pre><code>public String ns()
</code></pre>
<p>Retourne le code du namespace sur lequel la requte s'effectue.</p>
<pre><code>public boolean isTask()
</code></pre>
<p>Indique si l'opration est normale ou diffre.</p>
<pre><code>public InputData inputData()
</code></pre>
<p>Retourne l'objet <code>InputData</code> contenant le sparamtres de la requte :</p>
<ul>
<li><code>uri()</code> : partie utile de l'URL de la requte (aprs la partie <code>namespace</code> et <code>op</code>).</li>
<li><code>args()</code> : une map donnant les arguments passs sur le POST (habituellement sans utilit).</li>
<li><code>attachments()</code> : map des fichiers attachs, cl par leur nom d'attachement. Chaque <code>Attachment</code> contient :
<ul>
<li><code>String name</code> : son nom d'attachement.</li>
<li><code>String fileName</code> : son nom de fichier dans la session.</li>
<li><code>String contentType</code> : son type MIME dans la session.</li>
<li><code>byte[] bytes</code> : son contenu.</li>
</ul>
</li>
</ul>
<p>.</p>
<pre><code>public void trace(String msg)
</code></pre>
<p><strong>Dans le seul cas d'une opration diffre</strong> il est possible d'accumuler des traces d'excution textuelles simples et de les retrouver en cas de sortie en exception dans le rapport d'erreur stock par le Queue Manager. C'est sans objet sur une requte mise par une requte interactive.</p>
<pre><code>public DBProvider dbProvider()
</code></pre>
<p>Le DBProvider est l'objet en charge d'accder directement au stockage de donnes sans passer par l'intermdiaire normal des documents. Son emploi n'est ncessaire que pour crire des recherches spcifiques.</p>
<p>Le contexte d'excution a pour fonction :</p>
<ul>
<li>de crer un objet <code>Operation</code> en initialisant sa proprit <code>param</code> avec le contenu d-srialis de l'objet JSON reu en argument <code>param</code> de la requte. L'opration trouve dans l'objet Java <code>param</code> les arguments (du moins la plupart) du travail  effectuer.</li>
<li>de garder dans une mmoire cache de travail spcifique  ce contexte tous les objets <code>Document</code> des documents accds / crs / modifis / supprims.</li>
<li>de garder trace des demandes de cration de tches diffres.</li>
<li>d'appeler la mthode <code>work()</code> de l'objet <code>Operation</code>.</li>
<li>d'effectuer la validation des documents cr / modifis / supprims et des tches cres  / modifies / annules.</li>
<li>d'appeler la mthode <code>afterwork()</code>.</li>
<li>en cas d'exception (et pour certaines d'entre elles seulement) de recommencer le cycle cration d'opration <code>work()</code> / validation / <code>afterwork()</code>.</li>
<li>de calculer les synchronisations de documents requises dans la requte.</li>
<li>de mettre en forme et retourner le rsultat  retourner  la session appelante et de terminer la requte.</li>
</ul>
<h2>Opration</h2>
<p>L'objet <code>ExecContext</code> de la requte cre un objet <code>Operation</code> correspondant  l'opration souhaite par la requte (paramtre <code>op</code> de la requte).<br>
Les classes de document (qui tendent <code>Document</code>) peuvent avoir des classes internes statiques qui tendent la classe <code>Operation</code> : celles-ci sont automatiquement enregistres comme classe d'opration.<br>
Les oprations figurant dans une classe spare doivent tre dclares  la configuration.</p>
<h4>La proprit <code>param</code> d'un objet opration</h4>
<p>La classe d'une opration (qui tend <code>Operation</code>) doit avoir :</p>
<ul>
<li>une classe interne statique (srialisable en JSON, mme contrainte qu'un Item) usuellement dnomme <code>Param</code>.</li>
<li>une proprit d'instance nomme <code>Param param</code>.</li>
</ul>
<p>Lorsqu'une opration est lance, le paramtre de la requte HTTPS nomm <code>param</code> est suppos tre un JSON qui va tre d-srialis selon la classe <code>Param</code> et stock dans la proprit <code>param</code> de l'objet <code>Operation</code>: les paramtres de l'opration s'y trouvent, mme si parfois d'autres paramtres peuvent plus exceptionnellement figurer dans l'URI de la requte et des pices jointes de la requte.</p>
<h4>Mthodes gnriques de la classe <code>Operation</code></h4>
<p>L'objet <code>Operation</code> a en gnrique quelques services :</p>
<pre><code>public ExecContext execContext()
public InputData inputData()

// retourne et mmorise l'objet taskChekPoint (tche seulement)
public Object taskCheckpoint()
public void taskCheckpoint(Object obj)

// retourne le rsultat  remplir par l'opration
public Result result()

// retourne le Document.Id identifiant une tche
// quand un document existe pour cette id, son contenu donne les paramtres de la tche
public Document.Id taskId()
public boolean isTask()

public Stamp startTime()

// Descripteur technique de l'oparation
public OperationDescriptor descr()
public String name()

public String ungzip(Attachment a)
public void gzipResultat(String res)
</code></pre>
<h4>Rsultat d'une opration</h4>
<p>L'objet rsultat peut tre rempli selon l'une des trois options suivantes :</p>
<ul>
<li>(1) <code>Object out</code> : c'est un objet applicatif quelconque qui sera srialis en JSON.</li>
<li>(2) <code>String text / String encoding</code> : le rsultat est considr comme un texte et son encoding peut tre donn s'il n'est pas UTF-8.</li>
<li>(3) <code>byte[] bytes / String mime</code> : le rsultat est en binaire et son type MIME est donn.</li>
</ul>
<p>Un rsultat de synchronisation (c'est un String en JSON mis dans la proprit <code>syncs</code>) n'est possible que quand le rsultat est dans l'option (1) (<code>Object</code>  srialiser en JSON).</p>
<p>Il n'est pas obligatoire de dclarer un rsultat : un <code>Object</code> laiss vide est retourn  la session appelante.</p>
<h4>Gestion des oprations diffres</h4>
<pre><code>public void setTask(Document.Id id, long nextStart, String info)
</code></pre>
<p>Cette mthode dclare une opration diffre identifie par le <code>Document.Id</code> fourni et sera lance au plus tt  la date-heure <code>nextStart</code> donne.<br>
Un String d'information facultatif peut tre donn et apparatra dans les pages de gestion du Queue Manager (c'est son seul rle).</p>
<pre><code>  public void setTaskByCron(Document.Id id, String cron)
</code></pre>
<p>Mme fonctionnalit mais la <code>nextStart</code> est calcule selon le <code>String cron</code> pass en argument (qui sera mis en info).</p>
<p>Un objet <code>TaskInfo</code> contient principalement :</p>
<ul>
<li><code>String ns</code> : le namespace sur lequel l'opration porte.</li>
<li><code>Document.Id id</code> : son identit.</li>
<li><code>long nexstart</code> : sa date-heure de lancement au plus tt.</li>
<li><code>int retry</code> : le numro de l'essai d'excution (usuellement 0).</li>
<li><code>String info</code> : le commentaire informatif donn  la cration.</li>
</ul>
<h1>Srialisation JSON d'un document</h1>
<p>La forme gnrale est la suivante:</p>
<pre><code>{
&quot;c&quot;:&quot;C&quot;,
&quot;id&quot;:&quot;abcd&quot;,
&quot;v&quot;:1712... ,
&quot;ct&quot;:1712... ,
&quot;dt&quot;:1712... ,
&quot;dels&quot;: [
    {&quot;c&quot;:&quot;S4&quot;, &quot;v&quot;:1712...},
    {&quot;c&quot;:&quot;S5&quot;, &quot;k&quot;:&quot;def&quot;, &quot;v&quot;:1712...}
    ],
&quot;items&quot;: [
    {&quot;c&quot;:&quot;S2&quot;, &quot;v&quot;:1712... &quot;s&quot;:&quot;texte d'un raw&quot;},
    {&quot;c&quot;:&quot;S1&quot;, &quot;v&quot;:1712... &quot;j&quot;:{ l'item en JSON }},
    {&quot;c&quot;:&quot;R1&quot;, &quot;k&quot;:&quot;def&quot;, &quot;v&quot;:1712... &quot;s&quot;:&quot;texte d'un raw&quot;},
    {&quot;c&quot;:&quot;I1&quot;, &quot;k&quot;:&quot;abc&quot;, &quot;v&quot;:1712... &quot;j&quot;:{ l'item en JSON }}
    ],
&quot;clkeys&quot;:[&quot;S1&quot;, &quot;I1.abc&quot;, &quot;I1.def&quot;, &quot;R1.def&quot;... ]
}

Document supprim :  {&quot;c&quot;:&quot;C&quot;, &quot;id&quot;:&quot;abcd&quot;, &quot;v&quot;:0 , &quot;ct&quot;:1712... }

1A
source ----------dtr-----------vr
cache  ----------------dt---v
maj1   ----------------dt------vr suppr depuis dt / clkeys vide
maj2   ----------------dt------vr suppr depuis dt / clkeys vide

1B
source ----------dtr-----------vr
cache  ------dt-------------v
maj1   ----------dtr-----------vr suppr depuis dtr / clkeys vide
maj2   ----------dtr-----------vr suppr depuis dtr / clkeys vide

2A
source ----------dtr-----------vr
cache  --dt---v
maj1   ----------dtr-----------vr suppr depuis dtr / clkeys
maj2   ------------------------vr vr/vr suppr vide / clkeys vide

2B
source ----------dtr-----------vr
cache  v
maj1   ----------dtr-----------vr suppr depuis dtr / clkeys
maj2   ------------------------vr vr/vr suppr vide / clkeys vide
</code></pre>
<p>La mmoire cache  remettre  niveau contient un exemplaire de <code>d</code> de version <code>v</code> et de <code>dtime</code> <code>dt</code>.
La mmoire source de la remise  niveau contient un exemplaire de <code>d</code> de version <code>vr</code> et de <code>dtime</code> <code>dtr</code>.<br>
<code>items</code> contient toujours les items crs / recrs / modifis aprs <code>v</code>.
Sous option <code>maj1</code> on garde dans le document de mise  jour l'historique des destructions le plus large possible.<br>
Sous option <code>maj2</code> on limite au maximum dans le document de mise  jour l'historique des destructions.<br>
Dans le cas 2B, le cache ne connat rien (<code>v = 0</code>).<br>
Lorsque les <code>ctime</code> diffrent, on se ramne au cas 2B.<br>
<code>clkeys</code> ne contient pas les cls des items crs /recrs / modifis qui figurent dj dans <code>items</code>.</p>
<p>Aprs analyse de la situation de dpart, les options de calcul sont :</p>
<ul>
<li>Cas 1 : <code>clkeys</code> vide. Option maj1/maj2 ignore.
<ul>
<li>suppressions postrieures  dtx = max(dt, dtr)</li>
<li>en sortie : vr-&gt;version ctime-&gt;ctime dtx-&gt;dtime</li>
</ul>
</li>
<li>Cas 2 : option maj1. clkeys NON vide.
<ul>
<li>suppressions postrieures  dtr</li>
<li>en sortie : vr-&gt;version ctime-&gt;ctime dtr-&gt;dtime</li>
</ul>
</li>
<li>Cas 2 : option maj2. suppressions vide. clkeys vide.
<ul>
<li>en sortie : vr-&gt;version ctime-&gt;ctime vr-&gt;dtime</li>
</ul>
</li>
</ul>
<h1>Accs aux documents par la classe <code>Document</code></h1>
<p>Chaque classe de document a une classe qui hrite de <code>Document</code>.<br>
Chaque classe d'item est une classe statique interne portant le nom de la classe d'item (relative au document) hritant de :<br>
<code>Document.Item .RawItem .Singleton .RawSingleton</code> selon le cas.</p>
<h3>Mthodes gnrales applicables  un document</h3>
<p>Le <code>Status</code> d'un document traduit l'tat du document  l'instant t vis  vis de son cycle de vie et de ce qu'il convient de faire  la validation de l'opration si les choses en restaient l :</p>
<ul>
<li><code>unchanged</code> : aucun item n'a chang sur le document qui existait avant le dbut de l'opration.</li>
<li><code>modified</code> : le document existait avant le dbut de l'opration et un ou des items ont t crs / modifis / supprims.</li>
<li><code>created</code> : le document n'existait pas et il a t cr par un <code>getOrNew()</code>. Il n'a pas forcment d'items.</li>
<li><code>recreated</code> : le document existait et a t recr par la mthode <code>recreate()</code>. Sa date-heure de cration n'est pas la mme qu'au dbut de l'opration et son contenu a compltement t purg par la suppression survenue avant sa recration.</li>
<li><code>deleted</code> : le document existait mais a t supprim par l'opration.</li>
<li><code>shortlived</code> : le document n'existait pas, a t cr par un <code>getOrNew()</code> et a t supprim ensuite au cours de l'opration.</li>
</ul>
<p>Les principales proprits d'un document sont :</p>
<ul>
<li>
<p><code>Document.Id id()</code> : identifiant du document.</p>
</li>
<li>
<p><code>long ctime()</code> : date-heure de cration, telle qu'elle tait connue au dbut de l'opration.</p>
</li>
<li>
<p><code>long dtime()</code> : <strong>tous</strong> les items supprims aprs cette date-heure sont disponibles en cache (et marqus supprims).</p>
</li>
<li>
<p><code>long version()</code> : date-heure de cration ou dernire modification, telle qu'elle tait connue au dbut de l'opration.</p>
</li>
<li>
<p><code>Status status()</code> : tat du document.</p>
</li>
<li>
<p><code>isRO()</code> : <code>true</code> si le document est en lecture seule.</p>
<pre><code>public int nbExisting() : nombre d'items existants
public int nbToSave() : nombre d'items qui seront sauvs  la validation
public int nbToDelete() : nombre d'items qui seront dtruits  la validation
public int nbTotal() : nombre total d'items
public long v1() : volume de class (1) occup
public long v2() : volume de classe (2) - pices jointes - occup.
</code></pre>
</li>
</ul>
<p>Ces dernires mthodes n'ont de valeurs significatives que juste aprs l'appel de la mthode <strong><code>summarize()</code></strong> qui scanne tous les items pour calculer les volumes et les dnombrer.</p>
<h3>Obtention d'une instance de document</h3>
<pre><code>  public static Document get(Document.Id id, int maxDelayInSeconds) 
  throws AppException
  public static Document getOrNew(Document.Id id) throws AppException
</code></pre>
<p>La premire mthode retourne le document dont l'identification est donne et <code>null</code> s'il n'existe pas. La contrainte de fracheur peut tre spcifie afin de tolrer un document trouv en mmoire cache et d'ge compatible avec les exigences mtier. Si cette valeur n'est pas 0 (par convention la version la plus rcente possible) le document est en lecture seule.</p>
<p>La seconde mthode retourne un nouveau document s'il n'en existe pas un.</p>
<blockquote>
<p>Dans une opration pour un document d'identification donne toutes les variables de retour d'un <code>get()</code> pointe vers le mme objet : un document donn n'existe qu'en un exemplaire unique dans l'espace d'une opration.</p>
</blockquote>
<p>Usuellement chaque classe de document crit ses propres mthodes <code>get()</code> / <code>getOrNew()</code>, ayant le cas chant des paramtres mtiers pertinents et en castant le rsultat dans la classe du document cherch / cr.</p>
<h3>Suppression et recration d'un document</h3>
<pre><code>public void delete() throws AppException
public static void delete(Document.Id id) throws AppException
public void recreate() throws AppException
</code></pre>
<p>Un document peut tre supprim,</p>
<ul>
<li>soit depuis son instance elle-mme : c'est obligatoire quand les conditions de sa suppression sont lies  son contenu. Il est vrifi  la validation que la version du document n'a pas progress depuis.*</li>
<li>soit en <code>static</code> depuis la classe elle-mme en donnant son Id quand la logique de suppression ne se base pas sur le contenu du document (ventuellement juste son Id).</li>
</ul>
<p>La recration d'un document le met  vide et sa <code>ctime</code> est rinitialise : une nouvelle vie du document commence.</p>
<h3>Accs aux items d'un document</h3>
<p>Les mthodes ci-dessous sont gnriques mais usuellement une classe de document crit ses propres accesseurs, le cas chant avec des paramtres mtiers adquats et en castant les rsultats dans la classe de l'item souhait.</p>
<pre><code>public Singleton singleton(Class&lt;?&gt; itemClass)
public Singleton singletonOrNew(Class&lt;?&gt; itemClass)
public Item item(Class&lt;?&gt; itemClass, String key)
public Item itemOrNew(Class&lt;?&gt; itemClass, String key)
</code></pre>
<p>Les mthodes retournant des singletons n'ont pas de paramtre <code>key</code>.<br>
Toutes les mthodes prennent en premier paramtre la classe de l'item souhait.
Les mthodes <code>...OrNew</code> cr un item s'il n'existait pas alors que les autres retournent <code>null</code> dans ce cas.</p>
<pre><code>public String[] getKeys(Class&lt;?&gt; itemClass)
</code></pre>
<p>Cette mthode retourne toutes les cls des items (non singleton) existant pour la classe cite.</p>
<p>L'accs aux proprits d'un item JSON est celui standard d'accs aux proprits en Java.<br>
<strong>Aprs un ou plusieurs changements dans un item item il faut appeler la mthode <code>commit()</code> de l'item pour valider ces changements</strong> : sinon les modifications de l'item seront perdues.</p>
<p>Pour un <code>RawItem</code> ou un <code>RawSingleton</code> sa valeur est la proprit unique <code>String value</code>.</p>
<p>Aprs une srie de changement de valeurs des proprits d'un item, un appel <code>void commit()</code> pour les valider. Plusieurs appels commit() peuvent tre effectus.</p>
<pre><code>Document _document() : retourne le document auquel appartient de l'item
public ItemDescr descr() : retourne le descripteur de l'item
String key() : retourne la cl de l'item
String clkey() : retourne sa classe pour un singleton ou sa classe &quot;.&quot; sa cl pour un item.
long version() : retourne sa version au dbut de l'opration (si 0, l'item  t cr)
long vop() : retourne la date-heure de l'opration l'ayant mis  jour, infrieure  version dans le cas d'une rplication dsynchronise.
int v1() : retourne le volume (1) occup par l'item.
int v2() : dans le cas d'un item P retourne son volume (2) (la pice jointe)
boolean toSave() : retourne true si l'item a t cr ou modifi
String cvalue() : retourne sa valeur courante srilise
boolean deleted() : si true l'item dtruit.
boolean toDelete() : si true l'item sera dtruit  la prochaine validation.
boolean created() : si true l'item vient d'tre cr dans l'opration.

void commit() : valide une ou plusieurs modification de l'item.
void delete() : supprime l'item.
</code></pre>
<h4>Items / singletons, dtachs et rattachs</h4>
<p>Quand on obtient un item par <code>get()</code> ou <code>getOrNew()</code> l'item est instanci et automatiquement <em>attach</em> au document dont il fait partie.<br>
Si on cr ce mme item par un <code>new MonItem()</code> standard Java, on obtient un objet de la classe <code>MonItem</code> mais dtach de tout document : typiquement ce peut tre le cas au cours d'une procdure d'importation depuis une source externe.<br>
Cet item dtach peut venir remplacer l'item actuel par l'appel d'une de ces mthodes (Item ou Singleton) appliqus sur l'item cr dtach :</p>
<pre><code>void replaceIn(Document d, String key)
void replaceIn(Document d)
</code></pre>
<p>par exemple :</p>
<pre><code>MonItem it = new MonItem();
it.foo = &quot;bar&quot;;
it.replaceIn(monDoc, &quot;cl2&quot;);
</code></pre>
<h3>Les items de classe prdfinie P</h3>
<p>Chaque instance de ces items reprsente une pice jointe, un fichier attach au document.<br>
Un item P a des mthodes spcifiques, son contenu n'tant pas directement lisible.<br>
Pour l'obtention dans un document :</p>
<pre><code>P p(String key)
String[] getPKeys()
</code></pre>
<p>Pour la lecture des proprits d'un item P :</p>
<pre><code>// Mthodes spcifiques d'un item P
String mime() : retourne le type mime de la pice jointe
String sha() : retourne son sha.
int size() : retourne sa taille en bytes.
byte[] blobGet() : retourne le contenu de la pice jointe.
</code></pre>
<p>Une seule mthode sur un document permet de crer / modifier un item P en donnant son contenu binaire:</p>
<pre><code>P blobStore(String key, String mime, byte[] bytes)
</code></pre>
<p>La mthode retourne l'item cr ou modifi.</p>
<h3>Browse items</h3>
<p>Ces mthodes permettent d'effectuer une action / dnombrer les items selon une action / filtre quelconque.</p>
<pre><code>@FunctionalInterface public interface CIAction {
  public boolean action(CItem ci);
}
@FunctionalInterface interface CICounter {
  int count(CItem ci);
}
void browse(CIAction a) : excute l'action indique sur tous les items
int count(CICounter c) : compte tous les items ayant rpondu true
</code></pre>
<p>On peut obtenir l'item lui-mme dans des mthodes CIAction / CICounter en provoquant la d-srialisation de son CItem associ, par la mthode :</p>
<pre><code>public BItem item(CItem ci)
</code></pre>
<p>Il faut caster le rsultat dans la classe effective de l'item souhait.</p>
<h2>Contrle des synchronisations</h2>
<p>Une synchronisation est une requte dont l'objectif est de rcuprer les items modifis de documents afin de remettre  jour ceux-ci dont la session requrante dtient, ou non, une copie possiblement retarde.<br>
Une synchronisation peut tre une requte spcifique ou intervenir aprs la bonne excution d'une opration, en particulier de mise  jour.</p>
<blockquote>
<p>Pour chaque document concern, selon sa classe, son identifiant et pour chaque item du document, sa classe, son identifiant sa cl puis enfin son contenu, il peut tre dcid d'accepter ou non l'lment et finalement le cas chant avec seulement certaines des proprits.</p>
</blockquote>
<p>Une synchronisation est dfinie par une liste de document  synchroniser. Cette liste parvient en JSON dans le paramtre <code>syncs</code> de la requte. Chaque item de cette liste <code>[{&quot;c&quot;: ...}, {...}, ...]</code> correspond  un objet de la classe <code>Sync</code> et dcrit un document  synchroniser :</p>
<pre><code>String c; // classe du document
String id; // docid du document
long v; // version du document dtenue
long ct; // date-heure de cration
long dt; // toutes les suppressions d'items aprs cette date-heure sont connues 
String filter; // Objet de classe docclass.SyncFilter en Json
</code></pre>
<p>Le <code>String filter</code> est lui-mme le JSON d'un objet qui sera instanci selon la classe interne <code>static Filter</code> de la classe du document correspondant.</p>
<pre><code>La mmoire cache  remettre  niveau contient un exemplaire de `d` de version `v` et de `dtime` `dt`. 
La mmoire source de la remise  niveau contient un exemplaire de `d` de version `vr` et de `dtime` `dtr`.  
`items` contient toujours les items crs / recrs / modifis aprs `v`.
{
&quot;c&quot;:&quot;C&quot;,
&quot;id&quot;:&quot;abcd&quot;,
&quot;v&quot;:1712... ,
&quot;ct&quot;:1712... ,
&quot;dt&quot;:1712... ,
&quot;dels&quot;: [
     {&quot;c&quot;:&quot;S4&quot;, &quot;v&quot;:1712...},
     {&quot;c&quot;:&quot;S5&quot;, &quot;k&quot;:&quot;def&quot;, &quot;v&quot;:1712...}
     ],
&quot;items&quot;: [
     {&quot;c&quot;:&quot;S1&quot;, &quot;v&quot;:1712... &quot;j&quot;:{ l'item en JSON }},
     {&quot;c&quot;:&quot;R1&quot;, &quot;k&quot;:&quot;def&quot;, &quot;v&quot;:1712... &quot;s&quot;:&quot;texte d'un raw&quot;},
     {&quot;c&quot;:&quot;I1&quot;, &quot;k&quot;:&quot;abc&quot;, &quot;v&quot;:1712... &quot;j&quot;:{ l'item en JSON }}
     ],
 &quot;clkeys&quot;:[&quot;S1&quot;, &quot;I1.abc&quot;, &quot;I1.def&quot;, &quot;R1.def&quot;... ]
}
 
Document supprim :  {&quot;c&quot;:&quot;C&quot;, &quot;id&quot;:&quot;abcd&quot;, &quot;v&quot;:0 , &quot;ct&quot;:1712... }

1A
source ----------dtr-----------vr
cache  ----------------dt---v
maj1   ----------------dt------vr suppr depuis dt / clkeys vide
maj2   ----------------dt------vr suppr depuis dt / clkeys vide

1B
source ----------dtr-----------vr
cache  ------dt-------------v
maj1   ----------dtr-----------vr suppr depuis dtr / clkeys vide
maj2   ----------dtr-----------vr suppr depuis dtr / clkeys vide
 
2A
source ----------dtr-----------vr
cache  --dt---v
maj1   ----------dtr-----------vr suppr depuis dtr / clkeys
maj2   ------------------------vr vr/vr suppr vide / clkeys vide
 
2B
source ----------dtr-----------vr
cache  v
maj1   ----------dtr-----------vr suppr depuis dtr / clkeys
maj2   ------------------------vr vr/vr suppr vide / clkeys vide

Sous option `maj1` on garde dans le document de mise  jour l'historique des destructions le plus large possible.  
Sous option `maj2` on limite au maximum dans le document de mise  jour l'historique des destructions.  
Dans le cas 2B, le cache ne connat rien (`v = 0`).  
Lorsque les `ctime` diffrent, on se ramne au cas 2B.  
`clkeys` ne contient pas les cls des items crs /recrs / modifis qui figurent dj dans `items`.

Aprs analyse de la situation de dpart, les options de calcul sont :
- Cas 1 : `clkeys` vide. Option maj1/maj2 ignore.
    - suppressions postrieures  dtx = max(dt, dtr)
    - en sortie : vr-&gt;version ctime-&gt;ctime dtx-&gt;dtime
- Cas 2 : option maj1. clkeys NON vide.
    - suppressions postrieures  dtr
    - en sortie : vr-&gt;version ctime-&gt;ctime dtr-&gt;dtime
- Cas 2 : option maj2. suppressions vide. clkeys vide.
    - en sortie : vr-&gt;version ctime-&gt;ctime vr-&gt;dtime
</code></pre>
<p>Le retour d'une synchronisation est un vecteur similaire o chaque lment correspondant  un document <em>peut</em> avoir chang.</p>
<h4>Classes hritant de <code>Document.ISyncFilter</code></h4>
<p>Chaque classe de Document <em>peut</em> avoir une classe <code>static</code> <code>Filter</code> hritant de <code>Document.ISyncFilter</code>.<br>
Si cette classe existe pour une classe de document, lors de chaque synchronisation relative  un document de cette classe un objet filtre est cr :</p>
<ul>
<li>soit depuis le constructeur par dfaut ;</li>
<li>soit depuis l'objet reu en JSON comme paramtre de filtre pass par la requte de synchronisation.</li>
</ul>
<p>Les proprits de cet objet sont les paramtres de filtrage spcifiques au document  synchroniser et en particulier les paramtres ventuels d'authentification : <em>en fonction de ces paramtres, le document est-il  synchroniser et si oui quels items en particulier</em>.</p>
<p><code>Document</code> a plusieurs mthodes surchargeables par hritage :<br>
<strong><em>Filtre sur l'identifiant du document et sa classe selon l'environnement de la requte</em></strong></p>
<pre><code>FilterPolicy filter(ISyncFilter sf)
</code></pre>
<p>Cette mthode retourne la politique  mener pour le document lui-mme en fonction de sa <strong>classe</strong> et son <strong>identification</strong> :</p>
<ul>
<li><code>Accept</code> : accepter tous les items du document ;</li>
<li><code>Exclude</code> : exclure de la synchronisation ce document ;</li>
<li><code>Continue</code> : l'acceptation ou l'exclusion des items dpend de l'identifiant de chaque classe d'item.</li>
</ul>
<p>A noter que cette mthode peut stocker dans l'objet de filtre des informations  utiles  la poursuite de la synchronisation pour ce document.</p>
<p><strong><em>Filtre sur les classes d'items et leur cl:</em></strong></p>
<pre><code>FilterPolicy filter(ISyncFilter sf, ItemDescr itemDescr, String key)
</code></pre>
<p>Cette mthode retourne la politique  mener pour les items du document en fonction de leur classe et de leur cl ventuelle :</p>
<ul>
<li><code>Accept</code> : accepter l'item ;</li>
<li><code>Exclude</code> : exclure cet item de la synchronisation ;</li>
<li><code>Continue</code> : l'acceptation ou l'exclusion dpend du contenu de l'item.</li>
</ul>
<p><strong><em>Filtre sur le contenu mme de l'item</em></strong></p>
<pre><code>FilterPolicy filter(ISyncFilter sf, ItemDescr itemDescr, String key, Item item)
FilterPolicy filter(ISyncFilter sf, ItemDescr itemDescr, String key, Text text)
public static class Text {
    public String src;
    public String filtered;
  }
</code></pre>
<p>Cette mthode retourne,</p>
<ul>
<li><code>Exclude</code> : l'item n'est pas synchronis.</li>
<li><code>Accept</code> : l'item est synchronis dans son intgralit et son tat initial.</li>
<li><code>Continue</code> : la mthode a pu modifier l'item, masquer certains champs ou en calculer d'autres... c'est l'item modifi pass en argument qui est synchronis.<br>
La seconde mthode s'applique aux items opaques : si la proprit <code>filtered</code> est non <code>null</code> c'est la valeur  retourner en synchronisation au lieu de la valeur <code>src</code> relle du contenu de l'item.</li>
</ul>
<p><strong><em>Srialisation d'un document</em></strong></p>
<pre><code>String toJson(String filter, long ctime, long version, long dtime, boolean shortest)
String toJson()
</code></pre>
<p>Cette mthode retourne la srialisation JSON du document de delta en supposant qu'un tat antrieur tait connu et y applique les lments de filtre dcrits ci-dessus.</p>
<ul>
<li><code>ctime</code> : date-heure de cration de l'exemplaire dtenu.</li>
<li><code>version</code> : version de l'exemplaire dtenu.</li>
<li><code>dtime</code> : dans l'exemplaire dtenu toutes les suppressions au del de dtime sont connues.</li>
<li><code>shortest</code> : si vrai les items supprims ne sont pas transmis (dtime = version).</li>
</ul>
<p>La seconde mthode suppose qu'aucun exemplaire n'est dtenu et que les items supprims ne sont pas demands : bref c'est l'tat courant complet du document.</p>
<h1>Accs documents du cache <code>Cache</code></h1>
<p>Chaque instance de serveur dispose d'une mmoire cache gre par la classe <code>Cache</code> o sont stocks les derniers documents accds.</p>
<p>Tout accs  un document passe toujours par la mmoire cache et les documents y sont en lecture seule.</p>
<p>La mmoire cache est spare par <code>namespace</code> : il est en consquence possible d'accder  des documents d'un autre namespace, du moins en lecture. Acqurir d'abord la mmoire cache, soit de son namespace courant soit d'un autre :</p>
<pre><code>public static Cache current()
public static Cache cacheOf(String namespace)

public Document document(DocumentId id, Stamp minTime, long versionActuelle)
</code></pre>
<p>Le document est retourn de la mmoire cache (aprs y avoir t mis s'il n'y tait pas). Il est en lecture seule. Le retour est null si la version obtenue ne peut pas tre meilleure que celle dtenue (<code>versionActuelle</code>).</p>
<h1>Slection des identifiants de documents et des items</h1>
<h3>Recherche gnrique sur les valeurs des proprits d'un item</h3>
<p>L'objectif est de pouvoir rechercher une liste de documents dont l'un des items a une valeur de proprit indexe recherche (par exemple un code postal donn et les premires lettres d'un nom, ou une adresse e-mail ...).</p>
<p>Ce genre de recherche n'est fait que pour retourner un nombre rduit de documents.</p>
<pre><code>public static Collection&lt;Document.Id&gt; searchDocIdsByIndexes(Class&lt;?&gt; docClass, Class&lt;?&gt; itemClass, Cond&lt;?&gt;... ffield) throws AppException

public static Collection&lt;XItem&gt; searchItemsByIndexes(Class&lt;?&gt; docClass, Class&lt;?&gt; itemClass, XItemFilter filter, Cond&lt;?&gt;... ffield) throws AppException 
public static class XItem {
    public String docId;
    public String key;
    public long version;
    public BItem item;
}
</code></pre>
<p><em>Une ou plusieurs filtres portent sur les proprits indexes</em> de l'item. Chaque filtre doit avoir pour attribut <code>name</code> le nom de la proprit filtre. Seule la premire condition peut tre <strong>une non <code>EQ</code></strong>.</p>
<p>Le rsultat est une <code>Collection</code> de <code>Document.Id</code> dans le premier cas et une Collection de XItem (item + mta donnes).</p>
<p>En GAE Datastore la recherche est prioritairement sur les conditions de filtre des proprits indexes et d'abord sur la premire d'entre elle seule  pouvoir tre non <code>EQ</code> (conditions d'ingalit). Les ventuelles autres conditions d'ingalit ne sont appliques que sur le rsultat retourn par le Datastore qu'il rduit.</p>
<h1>L'espace secondaire de stockage des fichiers attachs aux documents</h1>
<p>Selon les providers ce stockage est implment sur un service Cloud ou un File-System local.<br>
Une classe abstraite <code>BlobProvider</code> donne les services minimum  fournir et chaque provider a son implmentation spcifique.</p>
<p>Le stockage des blobs s'effectue par document : chacun y est identifi par son sha-256.</p>
<ul>
<li>Un blob est stock au cours d'excution de <code>work(</code>) dans une opration, mme si l'opration n'est pas valide.</li>
<li>Un blob n'est pas dtruit quand il est dtruit au cours d'un <code>work()</code> (sa validation n'tant pas acquise).</li>
<li>Ce principe prend le risque d'accumuler des fichiers qui ne sont pas / plus rfrencs dans le document.</li>
<li>L'avantage est que a laisse du temps pour synchroniser dans une session distante une image cohrente d'un document et de ses pices jointes assures de pouvoir tre obtenues conformment  l'tat du document synchronis dans une version donne.</li>
<li>En contrepartie ceci suppose des nettoyages priodiques.</li>
</ul>
<p>.</p>
<pre><code>void blobDeleteAll(String clid) : suppression physique de tous les blobs du document
void blobStore(String clid, String sha, byte[] bytes) : stocke un blob
byte[] blobGet(String clid, String sha) : retourne un blob
boolean cleanup(String clid, HashSet&lt;String&gt; shas)
</code></pre>
<p>Le nettoyage d'un document est lanc par une tche qui s'excute dans les N heures aprs une cration / modification / suppression de ses pices jointes.<br>
Si rien ne bouge pendant un certain temps sur un document aucun nettoyage n'est lanc et si des modifications frntiques sont effectues, au plus un nettoyage intervient par groupe de N heures (1, 2, 3, 4, 6, 8 ou 12) configurable.</p>
<p>Le nettoyage,</p>
<ul>
<li>lit la liste des sha des fichiers qui avait t <em>mis  la corbeille</em> lors du cycle prcdent et supprime les fichiers correspondants, sauf quand ils sont dans la liste des sha encore rfrencs ;</li>
<li>lit tous les noms des fichiers stocks et les inscrit dans la corbeille quand ils ne sont plus rfrencs dans <code>shas</code> : ils sont simplement ainsi <em>candidats</em>  tre purgs au tours suivant (sauf ceux qui d'ici l sont de nouveau rfrencs).</li>
</ul>
<h1>Configuration des Namespaces</h1>
<p>Chaque namespace a quelques attributs techniques que l'administrateur peut fixer :</p>
<ul>
<li><code>status</code> : il peut prendre les valeurs suivantes :
<ul>
<li><code>0</code> : espace accessible normalement (lecture et criture) ;</li>
<li><code>1</code> : espace accessible temporairement aux seules opration n'agissant qu'en lecture ;</li>
<li><code>2</code> : espace temporairement non accessible, sauf aux requtes d'administration ;</li>
<li><code>3</code> : espace dfinitivement non accessible (en destruction) mais pouvant peut-tre un jour tre ractiv.</li>
</ul>
</li>
<li><code>info</code>  un court texte  propos du status ;</li>
<li><code>theme</code> :  lettre identifiant le thme visuel utilis ;</li>
<li><code>label</code> : un intitul plus long pour l'espace de noms ;</li>
<li><code>qm</code> : identifiant du Queue Manager grant le namespace ;</li>
<li><code>nsbuild</code> : numro d'ordre de la dernire modification du thme, du label, du queue manager, ou de l'une des ressources.</li>
</ul>
<p>Quelques fichiers de ressources peuvent tre dfinis, typiquement :</p>
<ul>
<li><code>custom.css</code> : directives CSS intgres  la suite du thme associ  l'espace ;</li>
<li><code>custom.js</code> : un script <em>javascript</em> excut aprs les autres juste avant le dmarrage effectif de l'application dans le browser ;</li>
<li><code>logo.png</code> : un fichier image reprsentant un logo pour la page d'accueil de l'application graphique.</li>
</ul>
<p>Toutes ces ressources ont obligatoirement une valeur par dfaut (figurant dans <code>/var/z/...</code>) : en cas d'absence de valeur spcifique  l'espace de noms c'est la valeur par dfaut de &quot;z&quot; qui est utilise.<br>
L'espace <code>z</code> n'est pas configurable dynamiquement, une erreur risquant de rendre tous les namespaces inaccessibles : il ne peut l'tre que dans la livraison de l'application (qui, elle, est teste avant mise en ligne).</p>
<p>Une session externe standard ne peut accder qu' un seul namespace fix dans son URL d'appel (et reconduite dans toutes les URLs d'opration).</p>
<p>Une session externe d'administration des namespaces peut accder  la liste des namespaces afin de les initialiser, les mettre on/off ou les configurer.</p>
<p>La configuration d'un namespace est contenue dans un document de classe <code>Namespace</code> :</p>
<ul>
<li>ayant pour <code>docid</code> le code du namespace,</li>
<li>mmoris dans le namespace <code>z</code> (en ralit dans le premier cit dans la configuration de l'application).</li>
</ul>
<h1>Stockage en R-DBMS</h1>
<p>Les colonnes <code>contentt</code> et <code>contentb</code> vont de pair :</p>
<ul>
<li>si le texte (typiquement un JSON) est court il est stock dans <code>contentt</code>;</li>
<li>sinon il est gzipp et stock en <code>contentb</code>. L'une des deux colonnes est toujours <code>null</code>.</li>
</ul>
<h3>Table <code>dbinfo</code></h3>
<pre><code>CREATE TABLE dbinfo (
info text NOT NULL
);
</code></pre>
<p>Cette table contient une constante : elle sert principalement au serveur  vrifier qu'il peut accder  la base de donnes au lancement.</p>
<h3>Table <code>s2cleanup</code></h3>
<pre><code>CREATE TABLE s2cleanup (
clid varchar(255) NOT NULL,
hour int,
CONSTRAINT s2cleanup_pk PRIMARY KEY (clid, hour)
);
</code></pre>
<p>Cette table indique pour chaque document SA prochaine heure de cleanup plannifie. Contraitement aux apparences sa cl primaire logique est <code>clid</code> : si <code>hour</code> y figure c'est pour bnficier de l'index de cl primaire sans en crer un second.</p>
<h3>Table <code>doc</code></h3>
<pre><code>CREATE TABLE doc (
clid varchar(255) NOT NULL,
version bigint NOT NULL,
ctime bigint NOT NULL,
dtime bigint NOT NULL,
CONSTRAINT doc_pk PRIMARY KEY (clid)
);
</code></pre>
<p>Cette table donne l'tat courant d'un document existant.
Ce row est mis  jour pour un document  chaque cration ou mise  jour et est dtruit quand le document l'est.</p>
<h3>Table <code>item</code></h3>
<pre><code>CREATE TABLE item (
docid varchar(255) NOT NULL,
clkey varchar(255) NOT NULL,
version bigint NOT NULL,
vop bigint NOT NULL,
sha varchar(255),
contentt text,
contentb bytea,
CONSTRAINT item_pk PRIMARY KEY (docid, clkey)
);
CREATE INDEX item_v on item (docid, version, clkey);
CREATE INDEX item_p on item (docid, sha) where sha is NOT NULL;
</code></pre>
<p>Cette table est <em>abstraite</em> : pour chaque classe de document il est cr une table qui hrite de celle-ci. Par exemple la table <code>compte</code> :</p>
<pre><code>CREATE TABLE compte () INHERITS (item);
</code></pre>
<p>Cette table hberge tous les items n'ayant pas de proprits indexes.</p>
<p>Pour chaque item comportant une ou des proprits indexes (du moins visible du R-DBMS) il est dclare une table spcifique qui hrite de la table des items du document :</p>
<pre><code>CREATE TABLE compte_ent (
dhl varchar(255),
nomr varchar(255)
) INHERITS (compte);
CREATE INDEX compte_ent_dhl ON compte_ent (dhl, docid);
CREATE INDEX compte_ent_nomr ON compte_ent (nomr, docid);
</code></pre>
<p>Le nom de la table est suivie de <code>_</code> et du nom de la classe d'item.<br>
Il est dfinie une colonne pour chaque valeur exporte / indexe.<br>
Il est, en gnral, dfini un index reprenant cette colonne en tte et suivie de l'identifiant du document <code>docid</code>.</p>
<h3>Table <code>taskqueue</code></h3>
<pre><code>CREATE TABLE taskqueue (
clid varchar(255) NOT NULL,
nextstart bigint NOT NULL, 
retry int NOT NULL,
info varchar(255),
report text,
CONSTRAINT taskqueue_pk PRIMARY KEY (docid)
CREATE INDEX taskqueue_nexstart on taskqueue (nextstart, clid);
</code></pre>
<p>Cette table est celle des tches diffres en attente de traitement ou en cours.   Le Queue Manager est certes averti de chaque modification par une requte HTTP mais priodiquement il scanne la table par les <code>nextStart</code> pour rcuprer les pertes ventuelles et au lancement galement.</p>
<h1>Stockage en GAE Datastore ( revoir)</h1>
<p>Le Datastore est sensible au namespace standard de GAE.<br>
Les entits ont deux proprits non indexes qui hbergent le texte (JSON souvent, simple String parfois) de l'entit :</p>
<ul>
<li><code>text</code> : type <code>Text</code> pour les contenus courts (infrieurs  2K);</li>
<li><code>blob</code> : type <code>Blob</code> pour les contenus longs gzipps en binaire.</li>
</ul>
<p>Une des deux proprits est toujours <code>null</code>.</p>
<h3>Entit <code>Group</code></h3>
<p>C'est l'entit racine de chaque groupe et sa cl est <code>groupid</code>.<br>
Proprits :</p>
<ul>
<li><code>version</code> : version du groupe;</li>
<li><code>text/blob</code> : le contenu du <code>GState</code>.</li>
</ul>
<h3>Entit S2</h3>
<p>C'est l'entit enregistrant pour un groupe la dernire date-heure de cleanup de l'espace de stockage secondaire.</p>
<p>Cl :</p>
<ul>
<li>parente : cl du groupe,</li>
<li>nom : &quot;0&quot;</li>
</ul>
<p>Proprit :</p>
<ul>
<li><code>hour</code> : AAMMJJHH heure du dernier cleanup effectu / planifi.</li>
</ul>
<h3>Entit <code>Document</code></h3>
<p>Cette entit reprsente un <code>DState</code>, l'tat d'un document et traduit son existence.</p>
<p>Cl :</p>
<ul>
<li>parente : cl du groupe,</li>
<li>nom : <code>docclass/docid</code></li>
</ul>
<p>Proprit :</p>
<ul>
<li><code>version</code> : version du document,</li>
<li><code>text/blob</code> : son <code>DState</code>.</li>
</ul>
<h3>Entit des items : <code>docClass</code> du document</h3>
<p>Les entits reprsentant les items d'un document portent comme classe celle du document.</p>
<p>Cl :</p>
<ul>
<li>parente : celle de l'entit Document du document,</li>
<li>nom :
<ul>
<li><code>&quot;0&quot;</code> : pour le header du document.</li>
<li><code>cl/itn</code> : classe de l'item et son identifiant relatif au document.</li>
</ul>
</li>
</ul>
<p>Proprits :</p>
<ul>
<li><code>version</code> : version de l'item.</li>
<li><code>key</code> : <code>null</code> pour les singletons.</li>
<li><code>text/blob</code> : le contenu de l'item (String pour les opaques ou JSON pour les autres).</li>
<li><code>P_sha</code> : pour les seuls items P.</li>
</ul>
<p>Quand un item de classe <code>Cl</code> d'un document de classe <code>docClass</code>  des proprits indexes p1, p2 l'entit <code>docClass</code> a les proprits suivantes supplmentaires :</p>
<ul>
<li><code>Cl_p1</code></li>
<li><code>Cl_p2</code></li>
</ul>
<p>Des index sont dclars sur ces proprits.</p>
<h4>Exemple du <code>datastore-indexes.xml</code></h4>
<pre><code>&lt;datastore-indexes autoGenerate=&quot;false&quot;&gt;
&lt;datastore-index kind=&quot;Group&quot; ancestor=&quot;true&quot; source=&quot;manual&quot;&gt;
    &lt;property name=&quot;version&quot; direction=&quot;asc&quot;/&gt;
&lt;/datastore-index&gt;
&lt;datastore-index kind=&quot;Document&quot; ancestor=&quot;true&quot; source=&quot;manual&quot;&gt;
    &lt;property name=&quot;version&quot; direction=&quot;asc&quot;/&gt;
&lt;/datastore-index&gt;
&lt;datastore-index kind=&quot;NsDoc&quot; ancestor=&quot;true&quot; source=&quot;manual&quot;&gt;
    &lt;property name=&quot;P_sha&quot; direction=&quot;asc&quot;/&gt;
&lt;/datastore-index&gt;
&lt;datastore-index kind=&quot;NsDoc&quot; ancestor=&quot;true&quot; source=&quot;manual&quot;&gt;
    &lt;property name=&quot;version&quot; direction=&quot;asc&quot;/&gt;
&lt;/datastore-index&gt;
&lt;datastore-index kind=&quot;Compte&quot; ancestor=&quot;true&quot; source=&quot;manual&quot;&gt;
    &lt;property name=&quot;version&quot; direction=&quot;asc&quot;/&gt;
&lt;/datastore-index&gt;
&lt;datastore-index kind=&quot;Compte&quot; ancestor=&quot;true&quot; source=&quot;manual&quot;&gt;
    &lt;property name=&quot;Ent_dhl&quot; direction=&quot;asc&quot;/&gt;
&lt;/datastore-index&gt;
&lt;datastore-index kind=&quot;Compte&quot; ancestor=&quot;true&quot; source=&quot;manual&quot;&gt;
    &lt;property name=&quot;Ent_nomR&quot; direction=&quot;asc&quot;/&gt;
&lt;/datastore-index&gt;
</code></pre>
<p>Les index <code>P_sha</code> ne sont  dclarer que sur les documents ayant des pices jointes.</p>
<h1>Queue Manager</h1>
<p>En GAE Datastore le Queue Manager est assur par le Datastore.</p>
<p>La queue des tches en attente d'excution est dans la table <code>taskqueue</code> :</p>
<p>Chaque serveur du pool peut initialiser un <strong>Queue Manager</strong>, une classe dfinissant l'excution de plusieurs threads.<br>
Un Queue Manager d'un serveur du pool  une liste de codes QM : il est en charge de grer tous les namespaces ayant pour paramtre de configuration <code>qm</code> l'un des codes de cette liste. Les threads sont les suivants  :</p>
<ul>
<li>un thread <code>QueueManager</code> charg de distribuer les tches  excuter  un des threads <strong>workers</strong> ;</li>
<li>un pool de threads <strong>workers</strong>. Chaque worker est en attente d'une tche  excuter et invoque la requte HTTP-POST correspondante pour faire excuter cette tche par un des serveurs du pool. En cas de succs (retour 200) le worker rveille le thread <code>Queue Manager</code> qui recherche une nouvelle tche  excuter.
En cas d'chec un worker,</li>
<li>enregistre cet chec dans le row de la tche dans <code>taskqueue</code> ;</li>
<li>le compteur <code>retry</code> est incrment ;</li>
<li>l'estampille <code>nextStart</code> est fixe  une date-heure plus ou moins proche selon la valeur du <code>retry</code>. Mais si le nombre de <code>retry</code> excde le maximum prvu, cette estampille est mise  la fin du sicle : l'administrateur agira en consquence;</li>
<li>le retour de la requte de la tche est aussi enregistre comme report de la tche : sa lecture permet le cas chant  l'administrateur d'enquter sur les causes de l'chec.</li>
</ul>
<p>Ce mcanisme garantit en consquence une reprise automatique en cas d'chec, du moins un certain nombre de fois.</p>
<p>Le thread <code>QueueManager</code> est reveill par plusieurs vnements :</p>
<ul>
<li><strong><em>une validation d'opration a des tches  lancer</em></strong> : celles-ci sont transmises au thread <code>QueueManager</code>, soit directement s'il est hberg dans le mme serveur, soit par une requte HTTP. Une validation permet d'enchaner sur une excution de tche diffre quasi immdiate si ncessaire ;</li>
<li><strong><em>la fin de traitement d'un worker</em></strong> dsormais disponible pour lancer et suivre l'excution d'une nouvelle tche ;</li>
<li><strong><em>priodiquement</em></strong>, typiquement une fois par minute, pour excuter un &quot;full scan&quot;. Le full scan consiste  lire dans les bases de donnes de tous les namespaces grs par le serveur du pool, la liste des tches  excuter dans la minute qui suit. Ceci garantit que mme en cas d'interruption du <code>QueueManager</code> aucune tche ne sera oublie  la relance.</li>
</ul>
<h4>Options du QueueManager</h4>
<p>Elles ont donnes dans le fichier <code>config.json</code>.</p>
<p>&quot;instances&quot;:{
&quot;default&quot;:{
&quot;hostedQM&quot;: [&quot;qm1&quot;, &quot;qm2&quot;],
&quot;threads&quot;: [2,1],
&quot;scanlapseinseconds&quot;:60,
&quot;retriesInMin&quot;:[1, 10, 60, 180]
},
&quot;A1&quot;:{
&quot;hostedQM&quot;: [&quot;qm3&quot;],
&quot;threads&quot;: [2,1],
&quot;scanlapseinseconds&quot;:60,
&quot;retriesInMin&quot;:[1, 10, 60, 180]
}
},</p>
<p>Chaque serveur du pool est identifi par un code d'instance transmis sur la ligne de commande de son lanceur (<code>default</code> si absent, sinon un code rel).</p>
<ul>
<li><code>hostedQM</code> : si l'array est non vide, un Queue Manager est lanc pour cette instance et traitera tous les namespaces dont le code <code>qm</code> vaut <code>qm3</code> dans l'exemple de l'instance A1 ci-dessus.</li>
<li><code>threads</code> donne le nombre de workers pour chaque &quot;queue&quot;. Dans l'exemple ci-dessus il y a deux queues ayant respectivement 2 workers pour la queue 0 et 1 worker pour la queue 1.</li>
<li><code>scanlapseinseconds</code> indique la frquence d'excution des &quot;full scan&quot; qui rinitialisent la liste des tches  excuter depuis la base de donnes pour faire face aux dfaillances ventuelles de notifications en fin d'opration ou d'absence d'coute  ces moments l.</li>
<li><code>retriesInMin</code> indique combien de minutes il faut attendre aprs un premier, second, ... n-ime chec avant de relancer la tche.</li>
</ul>
<h4>Affectation d'un numro de queue  une tche</h4>
<p>C'est une mthode de <code>Config</code> qui dtermine le numro de queue  affecter en fonction de l'information sur la tche ('namespace' et surtout <code>docclass</code>).<br>
Typiquement il existe une queue <code>0</code> pour les tches pseudo temps rel de front et une queue <code>1</code> pour les tches de fond de faible priorit.</p>
<h3>Actions d'administration</h3>
<p>Elles ne concernent pas le GAE Datastore ayant sa propre console d'administration du Queue Manager.</p>
<p>Les quelques actions possibles sont les suivantes :</p>
<ul>
<li><code>stop</code> : arrt du Queue Manager ;</li>
<li><code>start</code> : relance du Queue Manager ;</li>
<li><code>list</code> : liste des tches  lancer et en cours  brve chance (jusqu'au prochain &quot;full scan&quot;) ;</li>
<li><code>report</code> : obtention du report de la dernire excution en erreur d'une tche ;</li>
<li>changement d'heure de lancement d'une tche (et du compteur de <code>retry</code> le cas chant).</li>
<li>suppression d'une tche.</li>
<li>cration d'une tche : ceci est utile pour initialiser les tches qui s'auto renouvellent ensuite par un <em>cron</em>.</li>
</ul>
<p>Une slection des tches inscrites peut aussi tre faite en fixant facultativement certains des lments suivants :</p>
<ul>
<li>sa classe de document,</li>
<li>sa date-heure de relance (toutes celles prvues avant cette heure),</li>
<li>son occurrence d'chec (premire ou plus, seconde ou plus ...),</li>
<li>son texte d'information qui en gnral contient le code <em>cron</em> quand il s'agit d'une tche priodique lance par ce procd..</li>
</ul>
<h1>Congiguration</h1>
<p>Chaque instance de serveur du pool a un code identifiant qui lui permet de retrouver dans le fichier de configuration les options qui lui sont spcifiques.
Ce code est donne comme paramtre systme :</p>
<pre><code>java -Dfr.sportes.base.INSTANCE=A1 ... 
</code></pre>
<h4><code>web.xml</code></h4>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
xmlns:web=&quot;http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;
xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot; version=&quot;2.5&quot;&gt;

  &lt;context-param&gt;
    &lt;param-name&gt;ConfigClass&lt;/param-name&gt;
    &lt;param-value&gt;fr.sportes.forums.Config&lt;/param-value&gt;
  &lt;/context-param&gt;

  &lt;system-properties&gt;
        &lt;property name=&quot;java.util.logging.config.file&quot; value=&quot;WEB-INF/logging.properties&quot; /&gt;
    &lt;/system-properties&gt;

  &lt;servlet&gt;
    &lt;servlet-name&gt;Generic&lt;/servlet-name&gt;
    &lt;servlet-class&gt;fr.sportes.base.Servlet&lt;/servlet-class&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;Generic&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;  
&lt;/web-app&gt;
</code></pre>
<p>Le paramtre <code>ConfigClass</code> donne le nom de la classe de configuration qui tend <code>AConfig</code>.</p>
<h4><code>config.json</code></h4>
<p>Ce fichier donne les options de configuration gnrale et les options propres  chaque instance de serveur du pool.</p>
<h4><code>secret.json</code></h4>
<p>Ce fichier donne des options de scurit (mot de passe, etc.) requis pour accder  la base de donnes, le SHA-256 de la cl d'administration, les paramtres d'accs au mailer  ..</p>
<h4>Classe <code>Config</code></h4>
<p>Cette classe tend la classe <code>AConfig</code> et donne la description spcifique de <code>config.json</code> et <code>secret.json</code>.</p>

</div>
<!-- Adds some scroll space to the bottom of the doucment -->
<div style="height: 1pc">&nbsp;</div>
<!-- Scripts to handle MathJax -->
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script async="" src="http://markdownedit.com/assets/js/mathjax-scripts.js"></script>
</body>
</html>