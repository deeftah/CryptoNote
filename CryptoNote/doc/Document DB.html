<html>
<head>
	<title>Markdown Edit Preview</title>
	<!-- Must have base tag with id of "base-tag-id" -->
	<base id="base-tag-id">
	<!-- Don't delete this X-UA tag. The browser control behaves like IE8 otherwise -->
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<style type="text/css">
		body { font-family: arial, 'segoe ui', sans-serif; line-height: 1.4; padding-left: 12pt; font-size: 12pt; }
		code { white-space: pre }
		ul, ol { padding: 8pt; }
		h1, h2, h3, h4, h5, h6 { font-family: arial, cambria, serif; }
		blockquote { padding: 0 12pt; color: #777; border-left: 3pt solid #ddd;  }
		table{ display: block; width: 100%; overflow: auto; word-break: normal; word-break: keep-all; border-collapse: collapse;  }
		table th{ font-weight: bold; background-color: #f8f8f8; }
		table th, #content table td{ padding: 6px 13px; border: 1px solid #ddd; }
		table tr{ background-color: #fff; border-top: 1px solid #ccc; page-break-inside: avoid; }
	</style>
	<style type="text/css">
		._sprite{ background-image: url('emoji-sprite.png'); } 
		._sprite{ background-color: transparent; background-repeat: no-repeat; display: inline-block; zoom:0.39; vertical-align: middle; }
		._shipit{ width: 75px; height: 75px; background-position: 0 -27520px; }
		._0023-20e3{ width: 64px; height: 64px; background-position: 0 -27456px; }
		._0030-20e3{ width: 64px; height: 64px; background-position: -64px 0; }
		._0031-20e3{ width: 64px; height: 64px; background-position: -64px -64px; }
		._0032-20e3{ width: 64px; height: 64px; background-position: 0 -27392px; }
		._0033-20e3{ width: 64px; height: 64px; background-position: -64px -128px; }
		._0034-20e3{ width: 64px; height: 64px; background-position: 0 -27328px; }
		._0035-20e3{ width: 64px; height: 64px; background-position: -64px -192px; }
		._0036-20e3{ width: 64px; height: 64px; background-position: 0 -27264px; }
		._0037-20e3{ width: 64px; height: 64px; background-position: -64px -256px; }
		._0038-20e3{ width: 64px; height: 64px; background-position: 0 -27200px; }
		._0039-20e3{ width: 64px; height: 64px; background-position: -64px -320px; }
		._00a9{ width: 64px; height: 64px; background-position: 0 -27136px; }
		._00ae{ width: 64px; height: 64px; background-position: -64px -384px; }
		._1f004{ width: 64px; height: 64px; background-position: 0 -27072px; }
		._1f0cf{ width: 64px; height: 64px; background-position: -64px -448px; }
		._1f170{ width: 64px; height: 64px; background-position: 0 -27008px; }
		._1f171{ width: 64px; height: 64px; background-position: -64px -512px; }
		._1f17e{ width: 64px; height: 64px; background-position: 0 -26944px; }
		._1f17f{ width: 64px; height: 64px; background-position: -64px -576px; }
		._1f18e{ width: 64px; height: 64px; background-position: 0 -26880px; }
		._1f191{ width: 64px; height: 64px; background-position: -64px -640px; }
		._1f192{ width: 64px; height: 64px; background-position: 0 -26816px; }
		._1f193{ width: 64px; height: 64px; background-position: -64px -704px; }
		._1f194{ width: 64px; height: 64px; background-position: 0 -26752px; }
		._1f195{ width: 64px; height: 64px; background-position: -64px -768px; }
		._1f196{ width: 64px; height: 64px; background-position: 0 -26688px; }
		._1f197{ width: 64px; height: 64px; background-position: -64px -832px; }
		._1f198{ width: 64px; height: 64px; background-position: 0 -26624px; }
		._1f199{ width: 64px; height: 64px; background-position: -64px -896px; }
		._1f19a{ width: 64px; height: 64px; background-position: 0 -26560px; }
		._1f1e8-1f1f3{ width: 64px; height: 64px; background-position: -64px -960px; }
		._1f1e9-1f1ea{ width: 64px; height: 64px; background-position: 0 -26496px; }
		._1f1ea-1f1f8{ width: 64px; height: 64px; background-position: -64px -1024px; }
		._1f1eb-1f1f7{ width: 64px; height: 64px; background-position: 0 -26432px; }
		._1f1ec-1f1e7{ width: 64px; height: 64px; background-position: -64px -1088px; }
		._1f1ee-1f1f9{ width: 64px; height: 64px; background-position: 0 -26368px; }
		._1f1ef-1f1f5{ width: 64px; height: 64px; background-position: -64px -1152px; }
		._1f1f0-1f1f7{ width: 64px; height: 64px; background-position: 0 -26304px; }
		._1f1f7-1f1fa{ width: 64px; height: 64px; background-position: -64px -1216px; }
		._1f1fa-1f1f8{ width: 64px; height: 64px; background-position: 0 -26240px; }
		._1f201{ width: 64px; height: 64px; background-position: -64px -1280px; }
		._1f202{ width: 64px; height: 64px; background-position: 0 -26176px; }
		._1f21a{ width: 64px; height: 64px; background-position: -64px -1344px; }
		._1f22f{ width: 64px; height: 64px; background-position: 0 -26112px; }
		._1f232{ width: 64px; height: 64px; background-position: -64px -1408px; }
		._1f233{ width: 64px; height: 64px; background-position: 0 -26048px; }
		._1f234{ width: 64px; height: 64px; background-position: -64px -1472px; }
		._1f235{ width: 64px; height: 64px; background-position: 0 -25984px; }
		._1f236{ width: 64px; height: 64px; background-position: -64px -1536px; }
		._1f237{ width: 64px; height: 64px; background-position: 0 -25920px; }
		._1f238{ width: 64px; height: 64px; background-position: -64px -1600px; }
		._1f239{ width: 64px; height: 64px; background-position: 0 -25856px; }
		._1f23a{ width: 64px; height: 64px; background-position: -64px -1664px; }
		._1f250{ width: 64px; height: 64px; background-position: 0 -25792px; }
		._1f251{ width: 64px; height: 64px; background-position: -64px -1728px; }
		._1f300{ width: 64px; height: 64px; background-position: 0 -25728px; }
		._1f301{ width: 64px; height: 64px; background-position: -64px -1792px; }
		._1f302{ width: 64px; height: 64px; background-position: 0 -25664px; }
		._1f303{ width: 64px; height: 64px; background-position: -64px -1856px; }
		._1f304{ width: 64px; height: 64px; background-position: 0 -25600px; }
		._1f305{ width: 64px; height: 64px; background-position: -64px -1920px; }
		._1f306{ width: 64px; height: 64px; background-position: 0 -25536px; }
		._1f307{ width: 64px; height: 64px; background-position: -64px -1984px; }
		._1f308{ width: 64px; height: 64px; background-position: 0 -25472px; }
		._1f309{ width: 64px; height: 64px; background-position: -64px -2048px; }
		._1f30a{ width: 64px; height: 64px; background-position: 0 -25408px; }
		._1f30b{ width: 64px; height: 64px; background-position: -64px -2112px; }
		._1f30c{ width: 64px; height: 64px; background-position: 0 -25344px; }
		._1f30d{ width: 64px; height: 64px; background-position: -64px -2176px; }
		._1f30e{ width: 64px; height: 64px; background-position: 0 -25280px; }
		._1f30f{ width: 64px; height: 64px; background-position: -64px -2240px; }
		._1f310{ width: 64px; height: 64px; background-position: 0 -25216px; }
		._1f311{ width: 64px; height: 64px; background-position: -64px -2304px; }
		._1f312{ width: 64px; height: 64px; background-position: 0 -25152px; }
		._1f313{ width: 64px; height: 64px; background-position: -64px -2368px; }
		._1f314{ width: 64px; height: 64px; background-position: 0 -25088px; }
		._1f315{ width: 64px; height: 64px; background-position: -64px -2432px; }
		._1f316{ width: 64px; height: 64px; background-position: 0 -25024px; }
		._1f317{ width: 64px; height: 64px; background-position: -64px -2496px; }
		._1f318{ width: 64px; height: 64px; background-position: 0 -24960px; }
		._1f319{ width: 64px; height: 64px; background-position: -64px -2560px; }
		._1f31a{ width: 64px; height: 64px; background-position: 0 -24896px; }
		._1f31b{ width: 64px; height: 64px; background-position: -64px -2624px; }
		._1f31c{ width: 64px; height: 64px; background-position: 0 -24832px; }
		._1f31d{ width: 64px; height: 64px; background-position: -64px -2688px; }
		._1f31e{ width: 64px; height: 64px; background-position: 0 -24768px; }
		._1f31f{ width: 64px; height: 64px; background-position: -64px -2752px; }
		._1f320{ width: 64px; height: 64px; background-position: 0 -24704px; }
		._1f330{ width: 64px; height: 64px; background-position: -64px -2816px; }
		._1f331{ width: 64px; height: 64px; background-position: 0 -24640px; }
		._1f332{ width: 64px; height: 64px; background-position: -64px -2880px; }
		._1f333{ width: 64px; height: 64px; background-position: 0 -24576px; }
		._1f334{ width: 64px; height: 64px; background-position: -64px -2944px; }
		._1f335{ width: 64px; height: 64px; background-position: 0 -24512px; }
		._1f337{ width: 64px; height: 64px; background-position: -64px -3008px; }
		._1f338{ width: 64px; height: 64px; background-position: 0 -24448px; }
		._1f339{ width: 64px; height: 64px; background-position: -64px -3072px; }
		._1f33a{ width: 64px; height: 64px; background-position: 0 -24384px; }
		._1f33b{ width: 64px; height: 64px; background-position: -64px -3136px; }
		._1f33c{ width: 64px; height: 64px; background-position: 0 -24320px; }
		._1f33d{ width: 64px; height: 64px; background-position: -64px -3200px; }
		._1f33e{ width: 64px; height: 64px; background-position: 0 -24256px; }
		._1f33f{ width: 64px; height: 64px; background-position: -64px -3264px; }
		._1f340{ width: 64px; height: 64px; background-position: 0 -24192px; }
		._1f341{ width: 64px; height: 64px; background-position: -64px -3328px; }
		._1f342{ width: 64px; height: 64px; background-position: 0 -24128px; }
		._1f343{ width: 64px; height: 64px; background-position: -64px -3392px; }
		._1f344{ width: 64px; height: 64px; background-position: 0 -24064px; }
		._1f345{ width: 64px; height: 64px; background-position: -64px -3456px; }
		._1f346{ width: 64px; height: 64px; background-position: 0 -24000px; }
		._1f347{ width: 64px; height: 64px; background-position: -64px -3520px; }
		._1f348{ width: 64px; height: 64px; background-position: 0 -23936px; }
		._1f349{ width: 64px; height: 64px; background-position: -64px -3584px; }
		._1f34a{ width: 64px; height: 64px; background-position: 0 -23872px; }
		._1f34b{ width: 64px; height: 64px; background-position: -64px -3648px; }
		._1f34c{ width: 64px; height: 64px; background-position: 0 -23808px; }
		._1f34d{ width: 64px; height: 64px; background-position: -64px -3712px; }
		._1f34e{ width: 64px; height: 64px; background-position: 0 -23744px; }
		._1f34f{ width: 64px; height: 64px; background-position: -64px -3776px; }
		._1f350{ width: 64px; height: 64px; background-position: 0 -23680px; }
		._1f351{ width: 64px; height: 64px; background-position: -64px -3840px; }
		._1f352{ width: 64px; height: 64px; background-position: 0 -23616px; }
		._1f353{ width: 64px; height: 64px; background-position: -64px -3904px; }
		._1f354{ width: 64px; height: 64px; background-position: 0 -23552px; }
		._1f355{ width: 64px; height: 64px; background-position: -64px -3968px; }
		._1f356{ width: 64px; height: 64px; background-position: 0 -23488px; }
		._1f357{ width: 64px; height: 64px; background-position: -64px -4032px; }
		._1f358{ width: 64px; height: 64px; background-position: 0 -23424px; }
		._1f359{ width: 64px; height: 64px; background-position: -64px -4096px; }
		._1f35a{ width: 64px; height: 64px; background-position: 0 -23360px; }
		._1f35b{ width: 64px; height: 64px; background-position: -64px -4160px; }
		._1f35c{ width: 64px; height: 64px; background-position: 0 -23296px; }
		._1f35d{ width: 64px; height: 64px; background-position: -64px -4224px; }
		._1f35e{ width: 64px; height: 64px; background-position: 0 -23232px; }
		._1f35f{ width: 64px; height: 64px; background-position: -64px -4288px; }
		._1f360{ width: 64px; height: 64px; background-position: 0 -23168px; }
		._1f361{ width: 64px; height: 64px; background-position: -64px -4352px; }
		._1f362{ width: 64px; height: 64px; background-position: 0 -23104px; }
		._1f363{ width: 64px; height: 64px; background-position: -64px -4416px; }
		._1f364{ width: 64px; height: 64px; background-position: 0 -23040px; }
		._1f365{ width: 64px; height: 64px; background-position: -64px -4480px; }
		._1f366{ width: 64px; height: 64px; background-position: 0 -22976px; }
		._1f367{ width: 64px; height: 64px; background-position: -64px -4544px; }
		._1f368{ width: 64px; height: 64px; background-position: 0 -22912px; }
		._1f369{ width: 64px; height: 64px; background-position: -64px -4608px; }
		._1f36a{ width: 64px; height: 64px; background-position: 0 -22848px; }
		._1f36b{ width: 64px; height: 64px; background-position: -64px -4672px; }
		._1f36c{ width: 64px; height: 64px; background-position: 0 -22784px; }
		._1f36d{ width: 64px; height: 64px; background-position: -64px -4736px; }
		._1f36e{ width: 64px; height: 64px; background-position: 0 -22720px; }
		._1f36f{ width: 64px; height: 64px; background-position: -64px -4800px; }
		._1f370{ width: 64px; height: 64px; background-position: 0 -22656px; }
		._1f371{ width: 64px; height: 64px; background-position: -64px -4864px; }
		._1f372{ width: 64px; height: 64px; background-position: 0 -22592px; }
		._1f373{ width: 64px; height: 64px; background-position: -64px -4928px; }
		._1f374{ width: 64px; height: 64px; background-position: 0 -22528px; }
		._1f375{ width: 64px; height: 64px; background-position: -64px -4992px; }
		._1f376{ width: 64px; height: 64px; background-position: 0 -22464px; }
		._1f377{ width: 64px; height: 64px; background-position: -64px -5056px; }
		._1f378{ width: 64px; height: 64px; background-position: 0 -22400px; }
		._1f379{ width: 64px; height: 64px; background-position: -64px -5120px; }
		._1f37a{ width: 64px; height: 64px; background-position: 0 -22336px; }
		._1f37b{ width: 64px; height: 64px; background-position: -64px -5184px; }
		._1f37c{ width: 64px; height: 64px; background-position: 0 -22272px; }
		._1f380{ width: 64px; height: 64px; background-position: -64px -5248px; }
		._1f381{ width: 64px; height: 64px; background-position: 0 -22208px; }
		._1f382{ width: 64px; height: 64px; background-position: -64px -5312px; }
		._1f383{ width: 64px; height: 64px; background-position: 0 -22144px; }
		._1f384{ width: 64px; height: 64px; background-position: -64px -5376px; }
		._1f385{ width: 64px; height: 64px; background-position: 0 -22080px; }
		._1f386{ width: 64px; height: 64px; background-position: -64px -5440px; }
		._1f387{ width: 64px; height: 64px; background-position: 0 -22016px; }
		._1f388{ width: 64px; height: 64px; background-position: -64px -5504px; }
		._1f389{ width: 64px; height: 64px; background-position: 0 -21952px; }
		._1f38a{ width: 64px; height: 64px; background-position: -64px -5568px; }
		._1f38b{ width: 64px; height: 64px; background-position: 0 -21888px; }
		._1f38c{ width: 64px; height: 64px; background-position: -64px -5632px; }
		._1f38d{ width: 64px; height: 64px; background-position: 0 -21824px; }
		._1f38e{ width: 64px; height: 64px; background-position: -64px -5696px; }
		._1f38f{ width: 64px; height: 64px; background-position: 0 -21760px; }
		._1f390{ width: 64px; height: 64px; background-position: -64px -5760px; }
		._1f391{ width: 64px; height: 64px; background-position: 0 -21696px; }
		._1f392{ width: 64px; height: 64px; background-position: -64px -5824px; }
		._1f393{ width: 64px; height: 64px; background-position: 0 -21632px; }
		._1f3a0{ width: 64px; height: 64px; background-position: -64px -5888px; }
		._1f3a1{ width: 64px; height: 64px; background-position: 0 -21568px; }
		._1f3a2{ width: 64px; height: 64px; background-position: -64px -5952px; }
		._1f3a3{ width: 64px; height: 64px; background-position: 0 -21504px; }
		._1f3a4{ width: 64px; height: 64px; background-position: -64px -6016px; }
		._1f3a5{ width: 64px; height: 64px; background-position: 0 -21440px; }
		._1f3a6{ width: 64px; height: 64px; background-position: -64px -6080px; }
		._1f3a7{ width: 64px; height: 64px; background-position: 0 -21376px; }
		._1f3a8{ width: 64px; height: 64px; background-position: -64px -6144px; }
		._1f3a9{ width: 64px; height: 64px; background-position: 0 -21312px; }
		._1f3aa{ width: 64px; height: 64px; background-position: -64px -6208px; }
		._1f3ab{ width: 64px; height: 64px; background-position: 0 -21248px; }
		._1f3ac{ width: 64px; height: 64px; background-position: -64px -6272px; }
		._1f3ad{ width: 64px; height: 64px; background-position: 0 -21184px; }
		._1f3ae{ width: 64px; height: 64px; background-position: -64px -6336px; }
		._1f3af{ width: 64px; height: 64px; background-position: 0 -21120px; }
		._1f3b0{ width: 64px; height: 64px; background-position: -64px -6400px; }
		._1f3b1{ width: 64px; height: 64px; background-position: 0 -21056px; }
		._1f3b2{ width: 64px; height: 64px; background-position: -64px -6464px; }
		._1f3b3{ width: 64px; height: 64px; background-position: 0 -20992px; }
		._1f3b4{ width: 64px; height: 64px; background-position: -64px -6528px; }
		._1f3b5{ width: 64px; height: 64px; background-position: 0 -20928px; }
		._1f3b6{ width: 64px; height: 64px; background-position: -64px -6592px; }
		._1f3b7{ width: 64px; height: 64px; background-position: 0 -20864px; }
		._1f3b8{ width: 64px; height: 64px; background-position: -64px -6656px; }
		._1f3b9{ width: 64px; height: 64px; background-position: 0 -20800px; }
		._1f3ba{ width: 64px; height: 64px; background-position: -64px -6720px; }
		._1f3bb{ width: 64px; height: 64px; background-position: 0 -20736px; }
		._1f3bc{ width: 64px; height: 64px; background-position: -64px -6784px; }
		._1f3bd{ width: 64px; height: 64px; background-position: 0 -20672px; }
		._1f3be{ width: 64px; height: 64px; background-position: -64px -6848px; }
		._1f3bf{ width: 64px; height: 64px; background-position: 0 -20608px; }
		._1f3c0{ width: 64px; height: 64px; background-position: -64px -6912px; }
		._1f3c1{ width: 64px; height: 64px; background-position: 0 -20544px; }
		._1f3c2{ width: 64px; height: 64px; background-position: -64px -6976px; }
		._1f3c3{ width: 64px; height: 64px; background-position: 0 -20480px; }
		._1f3c4{ width: 64px; height: 64px; background-position: -64px -7040px; }
		._1f3c6{ width: 64px; height: 64px; background-position: 0 -20416px; }
		._1f3c7{ width: 64px; height: 64px; background-position: -64px -7104px; }
		._1f3c8{ width: 64px; height: 64px; background-position: 0 -20352px; }
		._1f3c9{ width: 64px; height: 64px; background-position: -64px -7168px; }
		._1f3ca{ width: 64px; height: 64px; background-position: 0 -20288px; }
		._1f3e0{ width: 64px; height: 64px; background-position: -64px -7232px; }
		._1f3e1{ width: 64px; height: 64px; background-position: 0 -20224px; }
		._1f3e2{ width: 64px; height: 64px; background-position: -64px -7296px; }
		._1f3e3{ width: 64px; height: 64px; background-position: 0 -20160px; }
		._1f3e4{ width: 64px; height: 64px; background-position: -64px -7360px; }
		._1f3e5{ width: 64px; height: 64px; background-position: 0 -20096px; }
		._1f3e6{ width: 64px; height: 64px; background-position: -64px -7424px; }
		._1f3e7{ width: 64px; height: 64px; background-position: 0 -20032px; }
		._1f3e8{ width: 64px; height: 64px; background-position: -64px -7488px; }
		._1f3e9{ width: 64px; height: 64px; background-position: 0 -19968px; }
		._1f3ea{ width: 64px; height: 64px; background-position: -64px -7552px; }
		._1f3eb{ width: 64px; height: 64px; background-position: 0 -19904px; }
		._1f3ec{ width: 64px; height: 64px; background-position: -64px -7616px; }
		._1f3ed{ width: 64px; height: 64px; background-position: 0 -19840px; }
		._1f3ee{ width: 64px; height: 64px; background-position: -64px -7680px; }
		._1f3ef{ width: 64px; height: 64px; background-position: 0 -19776px; }
		._1f3f0{ width: 64px; height: 64px; background-position: -64px -7744px; }
		._1f400{ width: 64px; height: 64px; background-position: 0 -19712px; }
		._1f401{ width: 64px; height: 64px; background-position: -64px -7808px; }
		._1f402{ width: 64px; height: 64px; background-position: 0 -19648px; }
		._1f403{ width: 64px; height: 64px; background-position: -64px -7872px; }
		._1f404{ width: 64px; height: 64px; background-position: 0 -19584px; }
		._1f405{ width: 64px; height: 64px; background-position: -64px -7936px; }
		._1f406{ width: 64px; height: 64px; background-position: 0 -19520px; }
		._1f407{ width: 64px; height: 64px; background-position: -64px -8000px; }
		._1f408{ width: 64px; height: 64px; background-position: 0 -19456px; }
		._1f409{ width: 64px; height: 64px; background-position: -64px -8064px; }
		._1f40a{ width: 64px; height: 64px; background-position: 0 -19392px; }
		._1f40b{ width: 64px; height: 64px; background-position: -64px -8128px; }
		._1f40c{ width: 64px; height: 64px; background-position: 0 -19328px; }
		._1f40d{ width: 64px; height: 64px; background-position: -64px -8192px; }
		._1f40e{ width: 64px; height: 64px; background-position: 0 -19264px; }
		._1f40f{ width: 64px; height: 64px; background-position: -64px -8256px; }
		._1f410{ width: 64px; height: 64px; background-position: 0 -19200px; }
		._1f411{ width: 64px; height: 64px; background-position: -64px -8320px; }
		._1f412{ width: 64px; height: 64px; background-position: 0 -19136px; }
		._1f413{ width: 64px; height: 64px; background-position: -64px -8384px; }
		._1f414{ width: 64px; height: 64px; background-position: 0 -19072px; }
		._1f415{ width: 64px; height: 64px; background-position: -64px -8448px; }
		._1f416{ width: 64px; height: 64px; background-position: 0 -19008px; }
		._1f417{ width: 64px; height: 64px; background-position: -64px -8512px; }
		._1f418{ width: 64px; height: 64px; background-position: 0 -18944px; }
		._1f419{ width: 64px; height: 64px; background-position: -64px -8576px; }
		._1f41a{ width: 64px; height: 64px; background-position: 0 -18880px; }
		._1f41b{ width: 64px; height: 64px; background-position: -64px -8640px; }
		._1f41c{ width: 64px; height: 64px; background-position: 0 -18816px; }
		._1f41d{ width: 64px; height: 64px; background-position: -64px -8704px; }
		._1f41e{ width: 64px; height: 64px; background-position: 0 -18752px; }
		._1f41f{ width: 64px; height: 64px; background-position: -64px -8768px; }
		._1f420{ width: 64px; height: 64px; background-position: 0 -18688px; }
		._1f421{ width: 64px; height: 64px; background-position: -64px -8832px; }
		._1f422{ width: 64px; height: 64px; background-position: 0 -18624px; }
		._1f423{ width: 64px; height: 64px; background-position: -64px -8896px; }
		._1f424{ width: 64px; height: 64px; background-position: 0 -18560px; }
		._1f425{ width: 64px; height: 64px; background-position: -64px -8960px; }
		._1f426{ width: 64px; height: 64px; background-position: 0 -18496px; }
		._1f427{ width: 64px; height: 64px; background-position: -64px -9024px; }
		._1f428{ width: 64px; height: 64px; background-position: 0 -18432px; }
		._1f429{ width: 64px; height: 64px; background-position: -64px -9088px; }
		._1f42a{ width: 64px; height: 64px; background-position: 0 -18368px; }
		._1f42b{ width: 64px; height: 64px; background-position: -64px -9152px; }
		._1f42c{ width: 64px; height: 64px; background-position: 0 -18304px; }
		._1f42d{ width: 64px; height: 64px; background-position: -64px -9216px; }
		._1f42e{ width: 64px; height: 64px; background-position: 0 -18240px; }
		._1f42f{ width: 64px; height: 64px; background-position: -64px -9280px; }
		._1f430{ width: 64px; height: 64px; background-position: 0 -18176px; }
		._1f431{ width: 64px; height: 64px; background-position: -64px -9344px; }
		._1f432{ width: 64px; height: 64px; background-position: 0 -18112px; }
		._1f433{ width: 64px; height: 64px; background-position: -64px -9408px; }
		._1f434{ width: 64px; height: 64px; background-position: 0 -18048px; }
		._1f435{ width: 64px; height: 64px; background-position: -64px -9472px; }
		._1f436{ width: 64px; height: 64px; background-position: 0 -17984px; }
		._1f437{ width: 64px; height: 64px; background-position: -64px -9536px; }
		._1f438{ width: 64px; height: 64px; background-position: 0 -17920px; }
		._1f439{ width: 64px; height: 64px; background-position: -64px -9600px; }
		._1f43a{ width: 64px; height: 64px; background-position: 0 -17856px; }
		._1f43b{ width: 64px; height: 64px; background-position: -64px -9664px; }
		._1f43c{ width: 64px; height: 64px; background-position: 0 -17792px; }
		._1f43d{ width: 64px; height: 64px; background-position: -64px -9728px; }
		._1f43e{ width: 64px; height: 64px; background-position: 0 -17728px; }
		._1f440{ width: 64px; height: 64px; background-position: -64px -9792px; }
		._1f442{ width: 64px; height: 64px; background-position: 0 -17664px; }
		._1f443{ width: 64px; height: 64px; background-position: -64px -9856px; }
		._1f444{ width: 64px; height: 64px; background-position: 0 -17600px; }
		._1f445{ width: 64px; height: 64px; background-position: -64px -9920px; }
		._1f446{ width: 64px; height: 64px; background-position: 0 -17536px; }
		._1f447{ width: 64px; height: 64px; background-position: -64px -9984px; }
		._1f448{ width: 64px; height: 64px; background-position: 0 -17472px; }
		._1f449{ width: 64px; height: 64px; background-position: -64px -10048px; }
		._1f44a{ width: 64px; height: 64px; background-position: 0 -17408px; }
		._1f44b{ width: 64px; height: 64px; background-position: -64px -10112px; }
		._1f44c{ width: 64px; height: 64px; background-position: 0 -17344px; }
		._1f44d{ width: 64px; height: 64px; background-position: -64px -10176px; }
		._1f44e{ width: 64px; height: 64px; background-position: 0 -17280px; }
		._1f44f{ width: 64px; height: 64px; background-position: -64px -10240px; }
		._1f450{ width: 64px; height: 64px; background-position: 0 -17216px; }
		._1f451{ width: 64px; height: 64px; background-position: -64px -10304px; }
		._1f452{ width: 64px; height: 64px; background-position: 0 -17152px; }
		._1f453{ width: 64px; height: 64px; background-position: -64px -10368px; }
		._1f454{ width: 64px; height: 64px; background-position: 0 -17088px; }
		._1f455{ width: 64px; height: 64px; background-position: -64px -10432px; }
		._1f456{ width: 64px; height: 64px; background-position: 0 -17024px; }
		._1f457{ width: 64px; height: 64px; background-position: -64px -10496px; }
		._1f458{ width: 64px; height: 64px; background-position: 0 -16960px; }
		._1f459{ width: 64px; height: 64px; background-position: -64px -10560px; }
		._1f45a{ width: 64px; height: 64px; background-position: 0 -16896px; }
		._1f45b{ width: 64px; height: 64px; background-position: -64px -10624px; }
		._1f45c{ width: 64px; height: 64px; background-position: 0 -16832px; }
		._1f45d{ width: 64px; height: 64px; background-position: -64px -10688px; }
		._1f45e{ width: 64px; height: 64px; background-position: 0 -16768px; }
		._1f45f{ width: 64px; height: 64px; background-position: -64px -10752px; }
		._1f460{ width: 64px; height: 64px; background-position: 0 -16704px; }
		._1f461{ width: 64px; height: 64px; background-position: -64px -10816px; }
		._1f462{ width: 64px; height: 64px; background-position: 0 -16640px; }
		._1f463{ width: 64px; height: 64px; background-position: -64px -10880px; }
		._1f464{ width: 64px; height: 64px; background-position: 0 -16576px; }
		._1f465{ width: 64px; height: 64px; background-position: -64px -10944px; }
		._1f466{ width: 64px; height: 64px; background-position: 0 -16512px; }
		._1f467{ width: 64px; height: 64px; background-position: -64px -11008px; }
		._1f468{ width: 64px; height: 64px; background-position: 0 -16448px; }
		._1f469{ width: 64px; height: 64px; background-position: -64px -11072px; }
		._1f46a{ width: 64px; height: 64px; background-position: 0 -16384px; }
		._1f46b{ width: 64px; height: 64px; background-position: -64px -11136px; }
		._1f46c{ width: 64px; height: 64px; background-position: 0 -16320px; }
		._1f46d{ width: 64px; height: 64px; background-position: -64px -11200px; }
		._1f46e{ width: 64px; height: 64px; background-position: 0 -16256px; }
		._1f46f{ width: 64px; height: 64px; background-position: -64px -11264px; }
		._1f470{ width: 64px; height: 64px; background-position: 0 -16192px; }
		._1f471{ width: 64px; height: 64px; background-position: -64px -11328px; }
		._1f472{ width: 64px; height: 64px; background-position: 0 -16128px; }
		._1f473{ width: 64px; height: 64px; background-position: -64px -11392px; }
		._1f474{ width: 64px; height: 64px; background-position: 0 -16064px; }
		._1f475{ width: 64px; height: 64px; background-position: -64px -11456px; }
		._1f476{ width: 64px; height: 64px; background-position: 0 -16000px; }
		._1f477{ width: 64px; height: 64px; background-position: -64px -11520px; }
		._1f478{ width: 64px; height: 64px; background-position: 0 -15936px; }
		._1f479{ width: 64px; height: 64px; background-position: -64px -11584px; }
		._1f47a{ width: 64px; height: 64px; background-position: 0 -15872px; }
		._1f47b{ width: 64px; height: 64px; background-position: -64px -11648px; }
		._1f47c{ width: 64px; height: 64px; background-position: 0 -15808px; }
		._1f47d{ width: 64px; height: 64px; background-position: -64px -11712px; }
		._1f47e{ width: 64px; height: 64px; background-position: 0 -15744px; }
		._1f47f{ width: 64px; height: 64px; background-position: -64px -11776px; }
		._1f480{ width: 64px; height: 64px; background-position: 0 -15680px; }
		._1f481{ width: 64px; height: 64px; background-position: -64px -11840px; }
		._1f482{ width: 64px; height: 64px; background-position: 0 -15616px; }
		._1f483{ width: 64px; height: 64px; background-position: -64px -11904px; }
		._1f484{ width: 64px; height: 64px; background-position: 0 -15552px; }
		._1f485{ width: 64px; height: 64px; background-position: -64px -11968px; }
		._1f486{ width: 64px; height: 64px; background-position: 0 -15488px; }
		._1f487{ width: 64px; height: 64px; background-position: -64px -12032px; }
		._1f488{ width: 64px; height: 64px; background-position: 0 -15424px; }
		._1f489{ width: 64px; height: 64px; background-position: -64px -12096px; }
		._1f48a{ width: 64px; height: 64px; background-position: 0 -15360px; }
		._1f48b{ width: 64px; height: 64px; background-position: -64px -12160px; }
		._1f48c{ width: 64px; height: 64px; background-position: 0 -15296px; }
		._1f48d{ width: 64px; height: 64px; background-position: -64px -12224px; }
		._1f48e{ width: 64px; height: 64px; background-position: 0 -15232px; }
		._1f48f{ width: 64px; height: 64px; background-position: -64px -12288px; }
		._1f490{ width: 64px; height: 64px; background-position: 0 -15168px; }
		._1f491{ width: 64px; height: 64px; background-position: -64px -12352px; }
		._1f492{ width: 64px; height: 64px; background-position: 0 -15104px; }
		._1f493{ width: 64px; height: 64px; background-position: -64px -12416px; }
		._1f494{ width: 64px; height: 64px; background-position: 0 -15040px; }
		._1f495{ width: 64px; height: 64px; background-position: -64px -12480px; }
		._1f496{ width: 64px; height: 64px; background-position: 0 -14976px; }
		._1f497{ width: 64px; height: 64px; background-position: -64px -12544px; }
		._1f498{ width: 64px; height: 64px; background-position: 0 -14912px; }
		._1f499{ width: 64px; height: 64px; background-position: -64px -12608px; }
		._1f49a{ width: 64px; height: 64px; background-position: 0 -14848px; }
		._1f49b{ width: 64px; height: 64px; background-position: -64px -12672px; }
		._1f49c{ width: 64px; height: 64px; background-position: 0 -14784px; }
		._1f49d{ width: 64px; height: 64px; background-position: -64px -12736px; }
		._1f49e{ width: 64px; height: 64px; background-position: 0 -14720px; }
		._1f49f{ width: 64px; height: 64px; background-position: -64px -12800px; }
		._1f4a0{ width: 64px; height: 64px; background-position: 0 -14656px; }
		._1f4a1{ width: 64px; height: 64px; background-position: -64px -12864px; }
		._1f4a2{ width: 64px; height: 64px; background-position: 0 -14592px; }
		._1f4a3{ width: 64px; height: 64px; background-position: -64px -12928px; }
		._1f4a4{ width: 64px; height: 64px; background-position: 0 -14528px; }
		._1f4a5{ width: 64px; height: 64px; background-position: -64px -12992px; }
		._1f4a6{ width: 64px; height: 64px; background-position: 0 -14464px; }
		._1f4a7{ width: 64px; height: 64px; background-position: -64px -13056px; }
		._1f4a8{ width: 64px; height: 64px; background-position: 0 -14400px; }
		._1f4a9{ width: 64px; height: 64px; background-position: -64px -13120px; }
		._1f4aa{ width: 64px; height: 64px; background-position: 0 -14336px; }
		._1f4ab{ width: 64px; height: 64px; background-position: -64px -13184px; }
		._1f4ac{ width: 64px; height: 64px; background-position: 0 -14272px; }
		._1f4ad{ width: 64px; height: 64px; background-position: -64px -13248px; }
		._1f4ae{ width: 64px; height: 64px; background-position: 0 -14208px; }
		._1f4af{ width: 64px; height: 64px; background-position: -64px -13312px; }
		._1f4b0{ width: 64px; height: 64px; background-position: 0 -14144px; }
		._1f4b1{ width: 64px; height: 64px; background-position: -64px -13376px; }
		._1f4b2{ width: 64px; height: 64px; background-position: 0 -14080px; }
		._1f4b3{ width: 64px; height: 64px; background-position: -64px -13440px; }
		._1f4b4{ width: 64px; height: 64px; background-position: 0 -14016px; }
		._1f4b5{ width: 64px; height: 64px; background-position: -64px -13504px; }
		._1f4b6{ width: 64px; height: 64px; background-position: 0 -13952px; }
		._1f4b7{ width: 64px; height: 64px; background-position: -64px -13568px; }
		._1f4b8{ width: 64px; height: 64px; background-position: 0 -13888px; }
		._1f4b9{ width: 64px; height: 64px; background-position: -64px -13632px; }
		._1f4ba{ width: 64px; height: 64px; background-position: 0 -13824px; }
		._1f4bb{ width: 64px; height: 64px; background-position: -64px -13696px; }
		._1f4bc{ width: 64px; height: 64px; background-position: 0 -13760px; }
		._1f4bd{ width: 64px; height: 64px; background-position: -64px -13760px; }
		._1f4be{ width: 64px; height: 64px; background-position: 0 -13696px; }
		._1f4bf{ width: 64px; height: 64px; background-position: -64px -13824px; }
		._1f4c0{ width: 64px; height: 64px; background-position: 0 -13632px; }
		._1f4c1{ width: 64px; height: 64px; background-position: -64px -13888px; }
		._1f4c2{ width: 64px; height: 64px; background-position: 0 -13568px; }
		._1f4c3{ width: 64px; height: 64px; background-position: -64px -13952px; }
		._1f4c4{ width: 64px; height: 64px; background-position: 0 -13504px; }
		._1f4c5{ width: 64px; height: 64px; background-position: -64px -14016px; }
		._1f4c6{ width: 64px; height: 64px; background-position: 0 -13440px; }
		._1f4c7{ width: 64px; height: 64px; background-position: -64px -14080px; }
		._1f4c8{ width: 64px; height: 64px; background-position: 0 -13376px; }
		._1f4c9{ width: 64px; height: 64px; background-position: -64px -14144px; }
		._1f4ca{ width: 64px; height: 64px; background-position: 0 -13312px; }
		._1f4cb{ width: 64px; height: 64px; background-position: -64px -14208px; }
		._1f4cc{ width: 64px; height: 64px; background-position: 0 -13248px; }
		._1f4cd{ width: 64px; height: 64px; background-position: -64px -14272px; }
		._1f4ce{ width: 64px; height: 64px; background-position: 0 -13184px; }
		._1f4cf{ width: 64px; height: 64px; background-position: -64px -14336px; }
		._1f4d0{ width: 64px; height: 64px; background-position: 0 -13120px; }
		._1f4d1{ width: 64px; height: 64px; background-position: -64px -14400px; }
		._1f4d2{ width: 64px; height: 64px; background-position: 0 -13056px; }
		._1f4d3{ width: 64px; height: 64px; background-position: -64px -14464px; }
		._1f4d4{ width: 64px; height: 64px; background-position: 0 -12992px; }
		._1f4d5{ width: 64px; height: 64px; background-position: -64px -14528px; }
		._1f4d6{ width: 64px; height: 64px; background-position: 0 -12928px; }
		._1f4d7{ width: 64px; height: 64px; background-position: -64px -14592px; }
		._1f4d8{ width: 64px; height: 64px; background-position: 0 -12864px; }
		._1f4d9{ width: 64px; height: 64px; background-position: -64px -14656px; }
		._1f4da{ width: 64px; height: 64px; background-position: 0 -12800px; }
		._1f4db{ width: 64px; height: 64px; background-position: -64px -14720px; }
		._1f4dc{ width: 64px; height: 64px; background-position: 0 -12736px; }
		._1f4dd{ width: 64px; height: 64px; background-position: -64px -14784px; }
		._1f4de{ width: 64px; height: 64px; background-position: 0 -12672px; }
		._1f4df{ width: 64px; height: 64px; background-position: -64px -14848px; }
		._1f4e0{ width: 64px; height: 64px; background-position: 0 -12608px; }
		._1f4e1{ width: 64px; height: 64px; background-position: -64px -14912px; }
		._1f4e2{ width: 64px; height: 64px; background-position: 0 -12544px; }
		._1f4e3{ width: 64px; height: 64px; background-position: -64px -14976px; }
		._1f4e4{ width: 64px; height: 64px; background-position: 0 -12480px; }
		._1f4e5{ width: 64px; height: 64px; background-position: -64px -15040px; }
		._1f4e6{ width: 64px; height: 64px; background-position: 0 -12416px; }
		._1f4e7{ width: 64px; height: 64px; background-position: -64px -15104px; }
		._1f4e8{ width: 64px; height: 64px; background-position: 0 -12352px; }
		._1f4e9{ width: 64px; height: 64px; background-position: -64px -15168px; }
		._1f4ea{ width: 64px; height: 64px; background-position: 0 -12288px; }
		._1f4eb{ width: 64px; height: 64px; background-position: -64px -15232px; }
		._1f4ec{ width: 64px; height: 64px; background-position: 0 -12224px; }
		._1f4ed{ width: 64px; height: 64px; background-position: -64px -15296px; }
		._1f4ee{ width: 64px; height: 64px; background-position: 0 -12160px; }
		._1f4ef{ width: 64px; height: 64px; background-position: -64px -15360px; }
		._1f4f0{ width: 64px; height: 64px; background-position: 0 -12096px; }
		._1f4f1{ width: 64px; height: 64px; background-position: -64px -15424px; }
		._1f4f2{ width: 64px; height: 64px; background-position: 0 -12032px; }
		._1f4f3{ width: 64px; height: 64px; background-position: -64px -15488px; }
		._1f4f4{ width: 64px; height: 64px; background-position: 0 -11968px; }
		._1f4f5{ width: 64px; height: 64px; background-position: -64px -15552px; }
		._1f4f6{ width: 64px; height: 64px; background-position: 0 -11904px; }
		._1f4f7{ width: 64px; height: 64px; background-position: -64px -15616px; }
		._1f4f9{ width: 64px; height: 64px; background-position: 0 -11840px; }
		._1f4fa{ width: 64px; height: 64px; background-position: -64px -15680px; }
		._1f4fb{ width: 64px; height: 64px; background-position: 0 -11776px; }
		._1f4fc{ width: 64px; height: 64px; background-position: -64px -15744px; }
		._1f500{ width: 64px; height: 64px; background-position: 0 -11712px; }
		._1f501{ width: 64px; height: 64px; background-position: -64px -15808px; }
		._1f502{ width: 64px; height: 64px; background-position: 0 -11648px; }
		._1f503{ width: 64px; height: 64px; background-position: -64px -15872px; }
		._1f504{ width: 64px; height: 64px; background-position: 0 -11584px; }
		._1f505{ width: 64px; height: 64px; background-position: -64px -15936px; }
		._1f506{ width: 64px; height: 64px; background-position: 0 -11520px; }
		._1f507{ width: 64px; height: 64px; background-position: -64px -16000px; }
		._1f508{ width: 64px; height: 64px; background-position: 0 -11456px; }
		._1f509{ width: 64px; height: 64px; background-position: -64px -16064px; }
		._1f50a{ width: 64px; height: 64px; background-position: 0 -11392px; }
		._1f50b{ width: 64px; height: 64px; background-position: -64px -16128px; }
		._1f50c{ width: 64px; height: 64px; background-position: 0 -11328px; }
		._1f50d{ width: 64px; height: 64px; background-position: -64px -16192px; }
		._1f50e{ width: 64px; height: 64px; background-position: 0 -11264px; }
		._1f50f{ width: 64px; height: 64px; background-position: -64px -16256px; }
		._1f510{ width: 64px; height: 64px; background-position: 0 -11200px; }
		._1f511{ width: 64px; height: 64px; background-position: -64px -16320px; }
		._1f512{ width: 64px; height: 64px; background-position: 0 -11136px; }
		._1f513{ width: 64px; height: 64px; background-position: -64px -16384px; }
		._1f514{ width: 64px; height: 64px; background-position: 0 -11072px; }
		._1f515{ width: 64px; height: 64px; background-position: -64px -16448px; }
		._1f516{ width: 64px; height: 64px; background-position: 0 -11008px; }
		._1f517{ width: 64px; height: 64px; background-position: -64px -16512px; }
		._1f518{ width: 64px; height: 64px; background-position: 0 -10944px; }
		._1f519{ width: 64px; height: 64px; background-position: -64px -16576px; }
		._1f51a{ width: 64px; height: 64px; background-position: 0 -10880px; }
		._1f51b{ width: 64px; height: 64px; background-position: -64px -16640px; }
		._1f51c{ width: 64px; height: 64px; background-position: 0 -10816px; }
		._1f51d{ width: 64px; height: 64px; background-position: -64px -16704px; }
		._1f51e{ width: 64px; height: 64px; background-position: 0 -10752px; }
		._1f51f{ width: 64px; height: 64px; background-position: -64px -16768px; }
		._1f520{ width: 64px; height: 64px; background-position: 0 -10688px; }
		._1f521{ width: 64px; height: 64px; background-position: -64px -16832px; }
		._1f522{ width: 64px; height: 64px; background-position: 0 -10624px; }
		._1f523{ width: 64px; height: 64px; background-position: -64px -16896px; }
		._1f524{ width: 64px; height: 64px; background-position: 0 -10560px; }
		._1f525{ width: 64px; height: 64px; background-position: -64px -16960px; }
		._1f526{ width: 64px; height: 64px; background-position: 0 -10496px; }
		._1f527{ width: 64px; height: 64px; background-position: -64px -17024px; }
		._1f528{ width: 64px; height: 64px; background-position: 0 -10432px; }
		._1f529{ width: 64px; height: 64px; background-position: -64px -17088px; }
		._1f52a{ width: 64px; height: 64px; background-position: 0 -10368px; }
		._1f52b{ width: 64px; height: 64px; background-position: -64px -17152px; }
		._1f52c{ width: 64px; height: 64px; background-position: 0 -10304px; }
		._1f52d{ width: 64px; height: 64px; background-position: -64px -17216px; }
		._1f52e{ width: 64px; height: 64px; background-position: 0 -10240px; }
		._1f52f{ width: 64px; height: 64px; background-position: -64px -17280px; }
		._1f530{ width: 64px; height: 64px; background-position: 0 -10176px; }
		._1f531{ width: 64px; height: 64px; background-position: -64px -17344px; }
		._1f532{ width: 64px; height: 64px; background-position: 0 -10112px; }
		._1f533{ width: 64px; height: 64px; background-position: -64px -17408px; }
		._1f534{ width: 64px; height: 64px; background-position: 0 -10048px; }
		._1f535{ width: 64px; height: 64px; background-position: -64px -17472px; }
		._1f536{ width: 64px; height: 64px; background-position: 0 -9984px; }
		._1f537{ width: 64px; height: 64px; background-position: -64px -17536px; }
		._1f538{ width: 64px; height: 64px; background-position: 0 -9920px; }
		._1f539{ width: 64px; height: 64px; background-position: -64px -17600px; }
		._1f53a{ width: 64px; height: 64px; background-position: 0 -9856px; }
		._1f53b{ width: 64px; height: 64px; background-position: -64px -17664px; }
		._1f53c{ width: 64px; height: 64px; background-position: 0 -9792px; }
		._1f53d{ width: 64px; height: 64px; background-position: -64px -17728px; }
		._1f550{ width: 64px; height: 64px; background-position: 0 -9728px; }
		._1f551{ width: 64px; height: 64px; background-position: -64px -17792px; }
		._1f552{ width: 64px; height: 64px; background-position: 0 -9664px; }
		._1f553{ width: 64px; height: 64px; background-position: -64px -17856px; }
		._1f554{ width: 64px; height: 64px; background-position: 0 -9600px; }
		._1f555{ width: 64px; height: 64px; background-position: -64px -17920px; }
		._1f556{ width: 64px; height: 64px; background-position: 0 -9536px; }
		._1f557{ width: 64px; height: 64px; background-position: -64px -17984px; }
		._1f558{ width: 64px; height: 64px; background-position: 0 -9472px; }
		._1f559{ width: 64px; height: 64px; background-position: -64px -18048px; }
		._1f55a{ width: 64px; height: 64px; background-position: 0 -9408px; }
		._1f55b{ width: 64px; height: 64px; background-position: -64px -18112px; }
		._1f55c{ width: 64px; height: 64px; background-position: 0 -9344px; }
		._1f55d{ width: 64px; height: 64px; background-position: -64px -18176px; }
		._1f55e{ width: 64px; height: 64px; background-position: 0 -9280px; }
		._1f55f{ width: 64px; height: 64px; background-position: -64px -18240px; }
		._1f560{ width: 64px; height: 64px; background-position: 0 -9216px; }
		._1f561{ width: 64px; height: 64px; background-position: -64px -18304px; }
		._1f562{ width: 64px; height: 64px; background-position: 0 -9152px; }
		._1f563{ width: 64px; height: 64px; background-position: -64px -18368px; }
		._1f564{ width: 64px; height: 64px; background-position: 0 -9088px; }
		._1f565{ width: 64px; height: 64px; background-position: -64px -18432px; }
		._1f566{ width: 64px; height: 64px; background-position: 0 -9024px; }
		._1f567{ width: 64px; height: 64px; background-position: -64px -18496px; }
		._1f5fb{ width: 64px; height: 64px; background-position: 0 -8960px; }
		._1f5fc{ width: 64px; height: 64px; background-position: -64px -18560px; }
		._1f5fd{ width: 64px; height: 64px; background-position: 0 -8896px; }
		._1f5fe{ width: 64px; height: 64px; background-position: -64px -18624px; }
		._1f5ff{ width: 64px; height: 64px; background-position: 0 -8832px; }
		._1f600{ width: 64px; height: 64px; background-position: -64px -18688px; }
		._1f601{ width: 64px; height: 64px; background-position: 0 -8768px; }
		._1f602{ width: 64px; height: 64px; background-position: -64px -18752px; }
		._1f603{ width: 64px; height: 64px; background-position: 0 -8704px; }
		._1f604{ width: 64px; height: 64px; background-position: -64px -18816px; }
		._1f605{ width: 64px; height: 64px; background-position: 0 -8640px; }
		._1f606{ width: 64px; height: 64px; background-position: -64px -18880px; }
		._1f607{ width: 64px; height: 64px; background-position: 0 -8576px; }
		._1f608{ width: 64px; height: 64px; background-position: -64px -18944px; }
		._1f609{ width: 64px; height: 64px; background-position: 0 -8512px; }
		._1f60a{ width: 64px; height: 64px; background-position: -64px -19008px; }
		._1f60b{ width: 64px; height: 64px; background-position: 0 -8448px; }
		._1f60c{ width: 64px; height: 64px; background-position: -64px -19072px; }
		._1f60d{ width: 64px; height: 64px; background-position: 0 -8384px; }
		._1f60e{ width: 64px; height: 64px; background-position: -64px -19136px; }
		._1f60f{ width: 64px; height: 64px; background-position: 0 -8320px; }
		._1f610{ width: 64px; height: 64px; background-position: -64px -19200px; }
		._1f611{ width: 64px; height: 64px; background-position: 0 -8256px; }
		._1f612{ width: 64px; height: 64px; background-position: -64px -19264px; }
		._1f613{ width: 64px; height: 64px; background-position: 0 -8192px; }
		._1f614{ width: 64px; height: 64px; background-position: -64px -19328px; }
		._1f615{ width: 64px; height: 64px; background-position: 0 -8128px; }
		._1f616{ width: 64px; height: 64px; background-position: -64px -19392px; }
		._1f617{ width: 64px; height: 64px; background-position: 0 -8064px; }
		._1f618{ width: 64px; height: 64px; background-position: -64px -19456px; }
		._1f619{ width: 64px; height: 64px; background-position: 0 -8000px; }
		._1f61a{ width: 64px; height: 64px; background-position: -64px -19520px; }
		._1f61b{ width: 64px; height: 64px; background-position: 0 -7936px; }
		._1f61c{ width: 64px; height: 64px; background-position: -64px -19584px; }
		._1f61d{ width: 64px; height: 64px; background-position: 0 -7872px; }
		._1f61e{ width: 64px; height: 64px; background-position: -64px -19648px; }
		._1f61f{ width: 64px; height: 64px; background-position: 0 -7808px; }
		._1f620{ width: 64px; height: 64px; background-position: -64px -19712px; }
		._1f621{ width: 64px; height: 64px; background-position: 0 -7744px; }
		._1f622{ width: 64px; height: 64px; background-position: -64px -19776px; }
		._1f623{ width: 64px; height: 64px; background-position: 0 -7680px; }
		._1f624{ width: 64px; height: 64px; background-position: -64px -19840px; }
		._1f625{ width: 64px; height: 64px; background-position: 0 -7616px; }
		._1f626{ width: 64px; height: 64px; background-position: -64px -19904px; }
		._1f627{ width: 64px; height: 64px; background-position: 0 -7552px; }
		._1f628{ width: 64px; height: 64px; background-position: -64px -19968px; }
		._1f629{ width: 64px; height: 64px; background-position: 0 -7488px; }
		._1f62a{ width: 64px; height: 64px; background-position: -64px -20032px; }
		._1f62b{ width: 64px; height: 64px; background-position: 0 -7424px; }
		._1f62c{ width: 64px; height: 64px; background-position: -64px -20096px; }
		._1f62d{ width: 64px; height: 64px; background-position: 0 -7360px; }
		._1f62e{ width: 64px; height: 64px; background-position: -64px -20160px; }
		._1f62f{ width: 64px; height: 64px; background-position: 0 -7296px; }
		._1f630{ width: 64px; height: 64px; background-position: -64px -20224px; }
		._1f631{ width: 64px; height: 64px; background-position: 0 -7232px; }
		._1f632{ width: 64px; height: 64px; background-position: -64px -20288px; }
		._1f633{ width: 64px; height: 64px; background-position: 0 -7168px; }
		._1f634{ width: 64px; height: 64px; background-position: -64px -20352px; }
		._1f635{ width: 64px; height: 64px; background-position: 0 -7104px; }
		._1f636{ width: 64px; height: 64px; background-position: -64px -20416px; }
		._1f637{ width: 64px; height: 64px; background-position: 0 -7040px; }
		._1f638{ width: 64px; height: 64px; background-position: -64px -20480px; }
		._1f639{ width: 64px; height: 64px; background-position: 0 -6976px; }
		._1f63a{ width: 64px; height: 64px; background-position: -64px -20544px; }
		._1f63b{ width: 64px; height: 64px; background-position: 0 -6912px; }
		._1f63c{ width: 64px; height: 64px; background-position: -64px -20608px; }
		._1f63d{ width: 64px; height: 64px; background-position: 0 -6848px; }
		._1f63e{ width: 64px; height: 64px; background-position: -64px -20672px; }
		._1f63f{ width: 64px; height: 64px; background-position: 0 -6784px; }
		._1f640{ width: 64px; height: 64px; background-position: -64px -20736px; }
		._1f645{ width: 64px; height: 64px; background-position: 0 -6720px; }
		._1f646{ width: 64px; height: 64px; background-position: -64px -20800px; }
		._1f647{ width: 64px; height: 64px; background-position: 0 -6656px; }
		._1f648{ width: 64px; height: 64px; background-position: -64px -20864px; }
		._1f649{ width: 64px; height: 64px; background-position: 0 -6592px; }
		._1f64a{ width: 64px; height: 64px; background-position: -64px -20928px; }
		._1f64b{ width: 64px; height: 64px; background-position: 0 -6528px; }
		._1f64c{ width: 64px; height: 64px; background-position: -64px -20992px; }
		._1f64d{ width: 64px; height: 64px; background-position: 0 -6464px; }
		._1f64e{ width: 64px; height: 64px; background-position: -64px -21056px; }
		._1f64f{ width: 64px; height: 64px; background-position: 0 -6400px; }
		._1f680{ width: 64px; height: 64px; background-position: -64px -21120px; }
		._1f681{ width: 64px; height: 64px; background-position: 0 -6336px; }
		._1f682{ width: 64px; height: 64px; background-position: -64px -21184px; }
		._1f683{ width: 64px; height: 64px; background-position: 0 -6272px; }
		._1f684{ width: 64px; height: 64px; background-position: -64px -21248px; }
		._1f685{ width: 64px; height: 64px; background-position: 0 -6208px; }
		._1f686{ width: 64px; height: 64px; background-position: -64px -21312px; }
		._1f687{ width: 64px; height: 64px; background-position: 0 -6144px; }
		._1f688{ width: 64px; height: 64px; background-position: -64px -21376px; }
		._1f689{ width: 64px; height: 64px; background-position: 0 -6080px; }
		._1f68a{ width: 64px; height: 64px; background-position: -64px -21440px; }
		._1f68b{ width: 64px; height: 64px; background-position: 0 -6016px; }
		._1f68c{ width: 64px; height: 64px; background-position: -64px -21504px; }
		._1f68d{ width: 64px; height: 64px; background-position: 0 -5952px; }
		._1f68e{ width: 64px; height: 64px; background-position: -64px -21568px; }
		._1f68f{ width: 64px; height: 64px; background-position: 0 -5888px; }
		._1f690{ width: 64px; height: 64px; background-position: -64px -21632px; }
		._1f691{ width: 64px; height: 64px; background-position: 0 -5824px; }
		._1f692{ width: 64px; height: 64px; background-position: -64px -21696px; }
		._1f693{ width: 64px; height: 64px; background-position: 0 -5760px; }
		._1f694{ width: 64px; height: 64px; background-position: -64px -21760px; }
		._1f695{ width: 64px; height: 64px; background-position: 0 -5696px; }
		._1f696{ width: 64px; height: 64px; background-position: -64px -21824px; }
		._1f697{ width: 64px; height: 64px; background-position: 0 -5632px; }
		._1f698{ width: 64px; height: 64px; background-position: -64px -21888px; }
		._1f699{ width: 64px; height: 64px; background-position: 0 -5568px; }
		._1f69a{ width: 64px; height: 64px; background-position: -64px -21952px; }
		._1f69b{ width: 64px; height: 64px; background-position: 0 -5504px; }
		._1f69c{ width: 64px; height: 64px; background-position: -64px -22016px; }
		._1f69d{ width: 64px; height: 64px; background-position: 0 -5440px; }
		._1f69e{ width: 64px; height: 64px; background-position: -64px -22080px; }
		._1f69f{ width: 64px; height: 64px; background-position: 0 -5376px; }
		._1f6a0{ width: 64px; height: 64px; background-position: -64px -22144px; }
		._1f6a1{ width: 64px; height: 64px; background-position: 0 -5312px; }
		._1f6a2{ width: 64px; height: 64px; background-position: -64px -22208px; }
		._1f6a3{ width: 64px; height: 64px; background-position: 0 -5248px; }
		._1f6a4{ width: 64px; height: 64px; background-position: -64px -22272px; }
		._1f6a5{ width: 64px; height: 64px; background-position: 0 -5184px; }
		._1f6a6{ width: 64px; height: 64px; background-position: -64px -22336px; }
		._1f6a7{ width: 64px; height: 64px; background-position: 0 -5120px; }
		._1f6a8{ width: 64px; height: 64px; background-position: -64px -22400px; }
		._1f6a9{ width: 64px; height: 64px; background-position: 0 -5056px; }
		._1f6aa{ width: 64px; height: 64px; background-position: -64px -22464px; }
		._1f6ab{ width: 64px; height: 64px; background-position: 0 -4992px; }
		._1f6ac{ width: 64px; height: 64px; background-position: -64px -22528px; }
		._1f6ad{ width: 64px; height: 64px; background-position: 0 -4928px; }
		._1f6ae{ width: 64px; height: 64px; background-position: -64px -22592px; }
		._1f6af{ width: 64px; height: 64px; background-position: 0 -4864px; }
		._1f6b0{ width: 64px; height: 64px; background-position: -64px -22656px; }
		._1f6b1{ width: 64px; height: 64px; background-position: 0 -4800px; }
		._1f6b2{ width: 64px; height: 64px; background-position: -64px -22720px; }
		._1f6b3{ width: 64px; height: 64px; background-position: 0 -4736px; }
		._1f6b4{ width: 64px; height: 64px; background-position: -64px -22784px; }
		._1f6b5{ width: 64px; height: 64px; background-position: 0 -4672px; }
		._1f6b6{ width: 64px; height: 64px; background-position: -64px -22848px; }
		._1f6b7{ width: 64px; height: 64px; background-position: 0 -4608px; }
		._1f6b8{ width: 64px; height: 64px; background-position: -64px -22912px; }
		._1f6b9{ width: 64px; height: 64px; background-position: 0 -4544px; }
		._1f6ba{ width: 64px; height: 64px; background-position: -64px -22976px; }
		._1f6bb{ width: 64px; height: 64px; background-position: 0 -4480px; }
		._1f6bc{ width: 64px; height: 64px; background-position: -64px -23040px; }
		._1f6bd{ width: 64px; height: 64px; background-position: 0 -4416px; }
		._1f6be{ width: 64px; height: 64px; background-position: -64px -23104px; }
		._1f6bf{ width: 64px; height: 64px; background-position: 0 -4352px; }
		._1f6c0{ width: 64px; height: 64px; background-position: -64px -23168px; }
		._1f6c1{ width: 64px; height: 64px; background-position: 0 -4288px; }
		._1f6c2{ width: 64px; height: 64px; background-position: -64px -23232px; }
		._1f6c3{ width: 64px; height: 64px; background-position: 0 -4224px; }
		._1f6c4{ width: 64px; height: 64px; background-position: -64px -23296px; }
		._1f6c5{ width: 64px; height: 64px; background-position: 0 -4160px; }
		._203c{ width: 64px; height: 64px; background-position: -64px -23360px; }
		._2049{ width: 64px; height: 64px; background-position: 0 -4096px; }
		._2122{ width: 64px; height: 64px; background-position: -64px -23424px; }
		._2139{ width: 64px; height: 64px; background-position: 0 -4032px; }
		._2194{ width: 64px; height: 64px; background-position: -64px -23488px; }
		._2195{ width: 64px; height: 64px; background-position: 0 -3968px; }
		._2196{ width: 64px; height: 64px; background-position: -64px -23552px; }
		._2197{ width: 64px; height: 64px; background-position: 0 -3904px; }
		._2198{ width: 64px; height: 64px; background-position: -64px -23616px; }
		._2199{ width: 64px; height: 64px; background-position: 0 -3840px; }
		._21a9{ width: 64px; height: 64px; background-position: -64px -23680px; }
		._21aa{ width: 64px; height: 64px; background-position: 0 -3776px; }
		._231a{ width: 64px; height: 64px; background-position: -64px -23744px; }
		._231b{ width: 64px; height: 64px; background-position: 0 -3712px; }
		._23e9{ width: 64px; height: 64px; background-position: -64px -23808px; }
		._23ea{ width: 64px; height: 64px; background-position: 0 -3648px; }
		._23eb{ width: 64px; height: 64px; background-position: -64px -23872px; }
		._23ec{ width: 64px; height: 64px; background-position: 0 -3584px; }
		._23f0{ width: 64px; height: 64px; background-position: -64px -23936px; }
		._23f3{ width: 64px; height: 64px; background-position: 0 -3520px; }
		._24c2{ width: 64px; height: 64px; background-position: -64px -24000px; }
		._25aa{ width: 64px; height: 64px; background-position: 0 -3456px; }
		._25ab{ width: 64px; height: 64px; background-position: -64px -24064px; }
		._25b6{ width: 64px; height: 64px; background-position: 0 -3392px; }
		._25c0{ width: 64px; height: 64px; background-position: -64px -24128px; }
		._25fb{ width: 64px; height: 64px; background-position: 0 -3328px; }
		._25fc{ width: 64px; height: 64px; background-position: -64px -24192px; }
		._25fd{ width: 64px; height: 64px; background-position: 0 -3264px; }
		._25fe{ width: 64px; height: 64px; background-position: -64px -24256px; }
		._2600{ width: 64px; height: 64px; background-position: 0 -3200px; }
		._2601{ width: 64px; height: 64px; background-position: -64px -24320px; }
		._260e{ width: 64px; height: 64px; background-position: 0 -3136px; }
		._2611{ width: 64px; height: 64px; background-position: -64px -24384px; }
		._2614{ width: 64px; height: 64px; background-position: 0 -3072px; }
		._2615{ width: 64px; height: 64px; background-position: -64px -24448px; }
		._261d{ width: 64px; height: 64px; background-position: 0 -3008px; }
		._263a{ width: 64px; height: 64px; background-position: -64px -24512px; }
		._2648{ width: 64px; height: 64px; background-position: 0 -2944px; }
		._2649{ width: 64px; height: 64px; background-position: -64px -24576px; }
		._264a{ width: 64px; height: 64px; background-position: 0 -2880px; }
		._264b{ width: 64px; height: 64px; background-position: -64px -24640px; }
		._264c{ width: 64px; height: 64px; background-position: 0 -2816px; }
		._264d{ width: 64px; height: 64px; background-position: -64px -24704px; }
		._264e{ width: 64px; height: 64px; background-position: 0 -2752px; }
		._264f{ width: 64px; height: 64px; background-position: -64px -24768px; }
		._2650{ width: 64px; height: 64px; background-position: 0 -2688px; }
		._2651{ width: 64px; height: 64px; background-position: -64px -24832px; }
		._2652{ width: 64px; height: 64px; background-position: 0 -2624px; }
		._2653{ width: 64px; height: 64px; background-position: -64px -24896px; }
		._2660{ width: 64px; height: 64px; background-position: 0 -2560px; }
		._2663{ width: 64px; height: 64px; background-position: -64px -24960px; }
		._2665{ width: 64px; height: 64px; background-position: 0 -2496px; }
		._2666{ width: 64px; height: 64px; background-position: -64px -25024px; }
		._2668{ width: 64px; height: 64px; background-position: 0 -2432px; }
		._267b{ width: 64px; height: 64px; background-position: -64px -25088px; }
		._267f{ width: 64px; height: 64px; background-position: 0 -2368px; }
		._2693{ width: 64px; height: 64px; background-position: -64px -25152px; }
		._26a0{ width: 64px; height: 64px; background-position: 0 -2304px; }
		._26a1{ width: 64px; height: 64px; background-position: -64px -25216px; }
		._26aa{ width: 64px; height: 64px; background-position: 0 -2240px; }
		._26ab{ width: 64px; height: 64px; background-position: -64px -25280px; }
		._26bd{ width: 64px; height: 64px; background-position: 0 -2176px; }
		._26be{ width: 64px; height: 64px; background-position: -64px -25344px; }
		._26c4{ width: 64px; height: 64px; background-position: 0 -2112px; }
		._26c5{ width: 64px; height: 64px; background-position: -64px -25408px; }
		._26ce{ width: 64px; height: 64px; background-position: 0 -2048px; }
		._26d4{ width: 64px; height: 64px; background-position: -64px -25472px; }
		._26ea{ width: 64px; height: 64px; background-position: 0 -1984px; }
		._26f2{ width: 64px; height: 64px; background-position: -64px -25536px; }
		._26f3{ width: 64px; height: 64px; background-position: 0 -1920px; }
		._26f5{ width: 64px; height: 64px; background-position: -64px -25600px; }
		._26fa{ width: 64px; height: 64px; background-position: 0 -1856px; }
		._26fd{ width: 64px; height: 64px; background-position: -64px -25664px; }
		._2702{ width: 64px; height: 64px; background-position: 0 -1792px; }
		._2705{ width: 64px; height: 64px; background-position: -64px -25728px; }
		._2708{ width: 64px; height: 64px; background-position: 0 -1728px; }
		._2709{ width: 64px; height: 64px; background-position: -64px -25792px; }
		._270a{ width: 64px; height: 64px; background-position: 0 -1664px; }
		._270b{ width: 64px; height: 64px; background-position: -64px -25856px; }
		._270c{ width: 64px; height: 64px; background-position: 0 -1600px; }
		._270f{ width: 64px; height: 64px; background-position: -64px -25920px; }
		._2712{ width: 64px; height: 64px; background-position: 0 -1536px; }
		._2714{ width: 64px; height: 64px; background-position: -64px -25984px; }
		._2716{ width: 64px; height: 64px; background-position: 0 -1472px; }
		._2728{ width: 64px; height: 64px; background-position: -64px -26048px; }
		._2733{ width: 64px; height: 64px; background-position: 0 -1408px; }
		._2734{ width: 64px; height: 64px; background-position: -64px -26112px; }
		._2744{ width: 64px; height: 64px; background-position: 0 -1344px; }
		._2747{ width: 64px; height: 64px; background-position: -64px -26176px; }
		._274c{ width: 64px; height: 64px; background-position: 0 -1280px; }
		._274e{ width: 64px; height: 64px; background-position: -64px -26240px; }
		._2753{ width: 64px; height: 64px; background-position: 0 -1216px; }
		._2754{ width: 64px; height: 64px; background-position: -64px -26304px; }
		._2755{ width: 64px; height: 64px; background-position: 0 -1152px; }
		._2757{ width: 64px; height: 64px; background-position: -64px -26368px; }
		._2764{ width: 64px; height: 64px; background-position: 0 -1088px; }
		._2795{ width: 64px; height: 64px; background-position: -64px -26432px; }
		._2796{ width: 64px; height: 64px; background-position: 0 -1024px; }
		._2797{ width: 64px; height: 64px; background-position: -64px -26496px; }
		._27a1{ width: 64px; height: 64px; background-position: 0 -960px; }
		._27b0{ width: 64px; height: 64px; background-position: -64px -26560px; }
		._27bf{ width: 64px; height: 64px; background-position: 0 -896px; }
		._2934{ width: 64px; height: 64px; background-position: -64px -26624px; }
		._2935{ width: 64px; height: 64px; background-position: 0 -832px; }
		._2b05{ width: 64px; height: 64px; background-position: -64px -26688px; }
		._2b06{ width: 64px; height: 64px; background-position: 0 -768px; }
		._2b07{ width: 64px; height: 64px; background-position: -64px -26752px; }
		._2b1b{ width: 64px; height: 64px; background-position: 0 -704px; }
		._2b1c{ width: 64px; height: 64px; background-position: -64px -26816px; }
		._2b50{ width: 64px; height: 64px; background-position: 0 -640px; }
		._2b55{ width: 64px; height: 64px; background-position: -64px -26880px; }
		._3030{ width: 64px; height: 64px; background-position: 0 -576px; }
		._303d{ width: 64px; height: 64px; background-position: -64px -26944px; }
		._3297{ width: 64px; height: 64px; background-position: 0 -512px; }
		._3299{ width: 64px; height: 64px; background-position: -64px -27008px; }
		._bowtie{ width: 64px; height: 64px; background-position: 0 -448px; }
		._feelsgood{ width: 64px; height: 64px; background-position: -64px -27072px; }
		._finnadie{ width: 64px; height: 64px; background-position: 0 -384px; }
		._fu{ width: 64px; height: 64px; background-position: -64px -27136px; }
		._goberserk{ width: 64px; height: 64px; background-position: 0 -320px; }
		._godmode{ width: 64px; height: 64px; background-position: -64px -27200px; }
		._hurtrealbad{ width: 64px; height: 64px; background-position: 0 -256px; }
		._metal{ width: 64px; height: 64px; background-position: -64px -27264px; }
		._neckbeard{ width: 64px; height: 64px; background-position: 0 -192px; }
		._octocat{ width: 64px; height: 64px; background-position: -64px -27328px; }
		._rage1{ width: 64px; height: 64px; background-position: 0 -128px; }
		._rage2{ width: 64px; height: 64px; background-position: -64px -27392px; }
		._rage3{ width: 64px; height: 64px; background-position: 0 -64px; }
		._rage4{ width: 64px; height: 64px; background-position: -64px -27456px; }
		._suspect{ width: 64px; height: 64px; background-position: 0 0; }
		._trollface{ width: 64px; height: 64px; background-position: -75px -27520px; }
	</style>
	
	<!-- 
    Change code block syntax highlighting styles by commenting out the 
	  default MDE sytle and uncommenting one of the styles below.
	  Works only with GitHub Markdown engine
	-->
	
	<!-- Default MDE syntax style -->
	<style type="text/css">
		code { font-family: consolas, monospace; background-color: #f7f7f7; padding: .2pt; border-radius: 2pt; line-height: 1.3; }
		pre { background-color: transparent; }
		pre code { font-size: 95%; padding: 12pt; display: block; border-radius: 2pt; }
	</style>
	
	<!-- pygments -->
	<!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code > span.dt { color: #902000; } /* DataType */
    code > span.dv { color: #40a070; } /* DecVal */
    code > span.bn { color: #40a070; } /* BaseN */
    code > span.fl { color: #40a070; } /* Float */
    code > span.ch { color: #4070a0; } /* Char */
    code > span.st { color: #4070a0; } /* String */
    code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code > span.ot { color: #007020; } /* Other */
    code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code > span.fu { color: #06287e; } /* Function */
    code > span.er { color: #ff0000; font-weight: bold; } /* Error */
    code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    code > span.cn { color: #880000; } /* Constant */
    code > span.sc { color: #4070a0; } /* SpecialChar */
    code > span.vs { color: #4070a0; } /* VerbatimString */
    code > span.ss { color: #bb6688; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { color: #19177c; } /* Variable */
    code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code > span.op { color: #666666; } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { color: #bc7a00; } /* Preprocessor */
    code > span.at { color: #7d9029; } /* Attribute */
    code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  -->
  
  <!-- kate -->
  <!--
    <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { font-weight: bold; } /* Keyword */
    code > span.dt { color: #800000; } /* DataType */
    code > span.dv { color: #0000ff; } /* DecVal */
    code > span.bn { color: #0000ff; } /* BaseN */
    code > span.fl { color: #800080; } /* Float */
    code > span.ch { color: #ff00ff; } /* Char */
    code > span.st { color: #dd0000; } /* String */
    code > span.co { color: #808080; font-style: italic; } /* Comment */
    code > span.al { color: #00ff00; font-weight: bold; } /* Alert */
    code > span.fu { color: #000080; } /* Function */
    code > span.er { color: #ff0000; font-weight: bold; } /* Error */
    code > span.wa { color: #ff0000; font-weight: bold; } /* Warning */
    code > span.cn { color: #000000; } /* Constant */
    code > span.sc { color: #ff00ff; } /* SpecialChar */
    code > span.vs { color: #dd0000; } /* VerbatimString */
    code > span.ss { color: #dd0000; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { } /* ControlFlow */
    code > span.op { } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { font-weight: bold; } /* Preprocessor */
    code > span.at { } /* Attribute */
    code > span.do { color: #808080; font-style: italic; } /* Documentation */
    code > span.an { color: #808080; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.cv { color: #808080; font-weight: bold; font-style: italic; } /* CommentVar */
    code > span.in { color: #808080; font-weight: bold; font-style: italic; } /* Information */
  </style>
  -->
  
  <!-- monochrome -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { font-weight: bold; } /* Keyword */
    code > span.dt { text-decoration: underline; } /* DataType */
    code > span.co { font-style: italic; } /* Comment */
    code > span.al { font-weight: bold; } /* Alert */
    code > span.er { font-weight: bold; } /* Error */
    code > span.wa { font-style: italic; } /* Warning */
    code > span.cf { font-weight: bold; } /* ControlFlow */
    code > span.pp { font-weight: bold; } /* Preprocessor */
    code > span.do { font-style: italic; } /* Documentation */
    code > span.an { font-style: italic; } /* Annotation */
    code > span.cv { font-style: italic; } /* CommentVar */
    code > span.in { font-style: italic; } /* Information */
  </style>
  -->
  
  <!-- expresso -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; background-color: #2a211c; color: #bdae9d; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #2a211c; color: #bdae9d; border-right: 1px solid #bdae9d; }
    td.sourceCode { padding-left: 5px; }
    pre, code { color: #bdae9d; background-color: #2a211c; }
    code > span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
    code > span.dt { text-decoration: underline; } /* DataType */
    code > span.dv { color: #44aa43; } /* DecVal */
    code > span.bn { color: #44aa43; } /* BaseN */
    code > span.fl { color: #44aa43; } /* Float */
    code > span.ch { color: #049b0a; } /* Char */
    code > span.st { color: #049b0a; } /* String */
    code > span.co { color: #0066ff; font-style: italic; } /* Comment */
    code > span.al { color: #ffff00; } /* Alert */
    code > span.fu { color: #ff9358; font-weight: bold; } /* Function */
    code > span.er { color: #ffff00; font-weight: bold; } /* Error */
    code > span.wa { color: #ffff00; font-weight: bold; } /* Warning */
    code > span.cn { } /* Constant */
    code > span.sc { color: #049b0a; } /* SpecialChar */
    code > span.vs { color: #049b0a; } /* VerbatimString */
    code > span.ss { color: #049b0a; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
    code > span.op { } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { font-weight: bold; } /* Preprocessor */
    code > span.at { } /* Attribute */
    code > span.do { color: #0066ff; font-style: italic; } /* Documentation */
    code > span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
    code > span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
  </style>  
  -->
  
  <!-- zenburn -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
    td.sourceCode { padding-left: 5px; }
    pre, code { color: #cccccc; background-color: #303030; }
    code > span.kw { color: #f0dfaf; } /* Keyword */
    code > span.dt { color: #dfdfbf; } /* DataType */
    code > span.dv { color: #dcdccc; } /* DecVal */
    code > span.bn { color: #dca3a3; } /* BaseN */
    code > span.fl { color: #c0bed1; } /* Float */
    code > span.ch { color: #dca3a3; } /* Char */
    code > span.st { color: #cc9393; } /* String */
    code > span.co { color: #7f9f7f; } /* Comment */
    code > span.ot { color: #efef8f; } /* Other */
    code > span.al { color: #ffcfaf; } /* Alert */
    code > span.fu { color: #efef8f; } /* Function */
    code > span.er { color: #c3bf9f; } /* Error */
    code > span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
    code > span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
    code > span.sc { color: #dca3a3; } /* SpecialChar */
    code > span.vs { color: #cc9393; } /* VerbatimString */
    code > span.ss { color: #cc9393; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { color: #f0dfaf; } /* ControlFlow */
    code > span.op { color: #f0efd0; } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
    code > span.at { } /* Attribute */
    code > span.do { color: #7f9f7f; } /* Documentation */
    code > span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
    code > span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
    code > span.in { color: #7f9f7f; font-weight: bold; } /* Information */
  </style>
  -->
  
  <!-- haddock -->
  <!--
   <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { color: #0000ff; } /* Keyword */
    code > span.ch { color: #008080; } /* Char */
    code > span.st { color: #008080; } /* String */
    code > span.co { color: #008000; } /* Comment */
    code > span.ot { color: #ff4000; } /* Other */
    code > span.al { color: #ff0000; } /* Alert */
    code > span.er { color: #ff0000; font-weight: bold; } /* Error */
    code > span.wa { color: #008000; font-weight: bold; } /* Warning */
    code > span.cn { } /* Constant */
    code > span.sc { color: #008080; } /* SpecialChar */
    code > span.vs { color: #008080; } /* VerbatimString */
    code > span.ss { color: #008080; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { } /* Variable */
    code > span.cf { color: #0000ff; } /* ControlFlow */
    code > span.op { } /* Operator */
    code > span.bu { } /* BuiltIn */
    code > span.ex { } /* Extension */
    code > span.pp { color: #ff4000; } /* Preprocessor */
    code > span.do { color: #008000; } /* Documentation */
    code > span.an { color: #008000; } /* Annotation */
    code > span.cv { color: #008000; } /* CommentVar */
    code > span.at { } /* Attribute */
    code > span.in { color: #008000; } /* Information */
  </style>
  -->
  
  <!-- tango -->
  <!--
  <style type="text/css">
    div.sourceCode { overflow-x: auto; }
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
    td.sourceCode { padding-left: 5px; }
    pre, code { background-color: #f8f8f8; }
    code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code > span.dt { color: #204a87; } /* DataType */
    code > span.dv { color: #0000cf; } /* DecVal */
    code > span.bn { color: #0000cf; } /* BaseN */
    code > span.fl { color: #0000cf; } /* Float */
    code > span.ch { color: #4e9a06; } /* Char */
    code > span.st { color: #4e9a06; } /* String */
    code > span.co { color: #8f5902; font-style: italic; } /* Comment */
    code > span.ot { color: #8f5902; } /* Other */
    code > span.al { color: #ef2929; } /* Alert */
    code > span.fu { color: #000000; } /* Function */
    code > span.er { color: #a40000; font-weight: bold; } /* Error */
    code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    code > span.cn { color: #000000; } /* Constant */
    code > span.sc { color: #000000; } /* SpecialChar */
    code > span.vs { color: #4e9a06; } /* VerbatimString */
    code > span.ss { color: #4e9a06; } /* SpecialString */
    code > span.im { } /* Import */
    code > span.va { color: #000000; } /* Variable */
    code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code > span.ex { } /* Extension */
    code > span.at { color: #c4a000; } /* Attribute */
    code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
  </style>  
  -->
<style>
 #content {
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
      color: black;
      font-family: "Roboto", Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 1.3rem;
      word-wrap: break-word;
      padding-left: 0.5rem;
      padding-right: 0.5rem;
    }

 h1,h2,h3,h4,h5,h6 {
      font-family: "Roboto", Arial, sans-serif;
      font-weight: bold;
      color: #777;
    }

 h1 {
      margin: 1.6em -0.5rem 0.5rem -0.5rem;
      padding: 0.3rem 0.5em;
      font-size: 1.6em;
      background-color: rgb(240,240,240);
      border-top: 3px solid rgb(200,200,200);
    }

 h2 {
      margin: 1.5em -0.5rem 0.5rem -0.5em;
      padding: 0.3rem 0.5em;
      background-color: rgb(240,240,240);
      font-size: 1.5em;
    }

 h3 {
      margin-top: 1.3em;
      margin-bottom: 0.3em;
      padding-top: 0.2em;
      padding-bottom: 0.2em;
      font-size: 1.3em;
    }

 h4 {
      margin-top: 1.2em;
      margin-bottom: 0.2em;
      padding-top: 0.1em;
      padding-bottom: 0.1em;
      font-size: 1.2em;
    }

 h5 {
      margin-top: 1.1em;
      margin-bottom: 0.1em;
      padding-top: 0.1em;
      padding-bottom: 0.1em;
      font-size: 1.1em;
    }

 h6 {
      margin-top: 1.1em;
      margin-bottom: 0.1em;
      padding-top: 0.1em;
      padding-bottom: 0.1em;
      font-size: 1em;
    }

 ul, ol {
      padding: 0;
      margin-top: 0;
      margin-bottom: 0;
    }

 ol ol, ul ol {
      list-style-type: lower-roman;
    }

 ul ul ol, ul ol ol, ol ul ol, ol ol ol {
      list-style-type: lower-alpha;
    }

 blockquote, ul, ol, dl, table, pre {
      margin-top: 0;
      margin-bottom: 0.5em;
    }

 hr {
      height: 4px;
      padding: 0;
      margin: 16px 0;
      background-color: #e7e7e7;
      border: 0 none;
    }

 ul, ol {
      padding-left: 2em;
    }

 ul ul, ul ol, ol ol, ol ul {
      margin-top: 0;
      margin-bottom: 0;
    }

 li>p {
      margin-top: 16px;
    }

 blockquote { background-color: rgb(240,240,240); margin: 1em 0; padding: 0.2em 0.5em; border-left:0.4em solid rgb(180,180,180); }
 
 code { background-color: rgb(240,240,240); padding: 0 3px; font-family: "Roboto Mono", "Courier new", monospace; font-size:1em;}

 table, th, td { border: 1px solid rgb(200,200,200); border-collapse: collapse; padding:0.5em; }

 p {font-size:1em; margin:0.5em 0;}

 em {color:#cc0000!important; }
</style>
  </head>
<body>
<!-- Content goes here. The div must have an id of "content" -->
<div id="content"><h1>Document DB</h1>
<p>La base du stockage persistant est de considrer des documents ayant une identification et une version.<br>
La mise en uvre est considre sous deux environnements :</p>
<ul>
<li>DS/GAE : Google App Engine (servlets Java) et son datastore.</li>
<li>PG/SQL : serveurs de servlets Java avec une base de donnes SQL, en l'occurrence PostgreSQL (PG).</li>
</ul>
<h1>Instances internes</h1>
<p>Pour un serveur (ou un pool de serveurs) identifi par son URL, l'application apparat comme N instances <strong>de logiciel identique</strong> travaillant chacune sur <strong>son propre espace de donnes</strong> indpendant des autres et identifi par un nom court. C'est un moyen pour hberger plusieurs organisations au sein du mme serveur ou pool de serveurs, et de mutualiser les ressources.</p>
<p>Une instance spcifique, <code>admin</code> est ddie  la mise on/off des instances et  l'administration surveillance centralise des tches diffres en attente (ou archives).</p>
<p>Le fichier de configuration gnral comporte, en plus de paramtres gnraux, une entre spcifique par instance. Une instance peut avoir une customisation spcifique partielle :</p>
<ul>
<li>des thmes graphiques spcifiques.</li>
<li>des libells / traductions spcifiques pouvant se substituer  ceux gnraux.</li>
<li>des dictionnaires et langues spcifiques.</li>
<li>quelques options, principalement de session terminale spcifiques.</li>
<li>des pages d'accueil spcifiques, voire quelques pages internes spcifiques.</li>
</ul>
<h4>Dploiement sur R-DBMS</h4>
<p>Les donnes de chaque instance sont stockes dans des tables portant le code de l'instance. Il peut exister <strong>plusieurs bases de donnes</strong>, chacune hbergeant donc les tables d'une ou plusieurs instances.<br>
<code>admin</code> ne comporte qu'une toute petite table et est hberg par la base d'une instance.</p>
<p>Chaque instance peut avoir des tches diffres : une table <code>TaskQueue</code> de celles-ci permet  Queue Manager de lancer les tches  l'heure prvue. Il n'existe au plus qu'une table <code>TaskQueue</code> par base : la configuration indique quel QueueManager gre sa <code>TaskQueue</code>, le cas chant aggrge  des TaskQueue d'autres instances gre sur une autre base.</p>
<h5>Dploiement GAE Datastore</h5>
<p>Chaque instance correspond  un <code>namespace</code>.<br>
Le Datastore a son lanceur de tches mais la table TaskQueue (entity TaskQueue) existe cependant avec les mmes donnes : elle rside toutefois dans ce cas sous le mme namespace que l'instance.</p>
<p>Chaque instance tant tanche aux autres et ignorante de leur existence, tout ce qui suit se rapporte  une seule instance,  l'exception de TaskQueue et OnOff qui peuvent tre relatives  plusieurs instances.</p>
<h1>Documents et items</h1>
<p>Le stockage de donnes apparat comme un ensemble de <strong><em>documents</em></strong> :</p>
<ul>
<li>un document a une <strong>classe</strong> qui en Java tend la classe <code>Document</code>.</li>
<li>un document est <strong>identifi</strong> par un <code>String</code> nomm par la suite <code>docid</code> avec la seule contrainte d'une longueur maximale de 255.</li>
<li>un document a une <strong>version</strong>, une date-heure en millisecondes UTC sous forme d'un <code>long</code> lisible (171128094052123) et croissante dans le temps : la version est la date-heure de la dernire opration ayant mis  jour le document.</li>
<li>un document a une <strong>date-heure de cration <code>ctime</code></strong> : un document peut tre dtruit et recr plus tard avec un mme <code>docid</code> : <code>ctime</code> permet  une mmoire externe retarde de savoir si elle dtient une version retarde de la <em>mme vie</em> du document (dont le contenu peut tre valable en partie) ou une version <em>d'une vie antrieure</em> (dont le contenu est totalement obsolte).</li>
<li>un document  une <strong><code>dtime</code></strong> qui est la date-heure au del de laquelle le document a gard la trace des items dtruits (voir la gestion des mmoires persistante et cache).</li>
</ul>
<h3>Items</h3>
<p>Un document est un <strong><em>ensemble d'items</em></strong> chacun ayant,</p>
<ul>
<li>une <strong>classe</strong> d'item qui en Java correspond  une sous classe statique de la classe du document et qui tend la classe <code>Document.BItem</code> et plus spcifiquement <code>Item</code> <code>RawItem</code> <code>Singleton</code> <code>RawSingleton</code> qui tendent <code>BItem</code>.
<ul>
<li>un <code>Singleton</code> existe en une occurrence au plus dans son document.</li>
<li>un <code>Item</code> existe en 0  N occurrences identifies par un <code>String</code> nomm par la suite <code>key</code> avec la seule contrainte d'une longueur maximale de 255.</li>
</ul>
</li>
<li>une <strong>version</strong> : date-heure de l'opration qui a <em>mis  jour le document</em>.</li>
<li>une <strong>vop</strong> : date-heure de l'opration ayant mis  jour l'item. Pour une mise  jour non diffre <code>vop</code> et <code>version</code> ont la mme valeur. <code>vop</code> vaut 0 pour un item dtruit.</li>
<li>un item a un <strong>contenu</strong> <code>String</code> qui peut tre,
<ul>
<li>un JSON (<code>Singleton</code> et <code>Item</code>),</li>
<li>un <code>String</code> opaque (<code>RawSingleton</code> et <code>RawItem</code>), typiquement l'encodage en base 64 d'un vecteur d'octets.</li>
</ul>
</li>
<li>un <strong>contenu <code>null</code></strong> indique un item dtruit (<code>vop</code> est 0), sa <em>version</em> indiquant quelle opration l'a dtruit. Un item dtruit peut rester connu en tant que tel pendant un certain temps afin de permettre la synchronisation rapide du contenu du document avec un contenu distant, puis tre finalement physiquement purg.</li>
</ul>
<h5>Items JSON</h5>
<p>Leurs proprits peuvent tre :</p>
<ul>
<li>d'un des types primitifs : <code>long, int, double, boolean</code> ;</li>
<li>d'une classe interne <code>?</code> ou des <code>Map&lt;String,?&gt;</code> ou des <code>Collection&lt;?&gt;</code> o les classes <code>?</code> elles-mme peuvent avoir le mme type de proprits.</li>
</ul>
<blockquote>
<p><strong><em>Remarque :</em></strong> les noms des classes de Document et d'Item dans un document doivent tre le plus court possible afin de rduire la taille des index et cls en stockage.</p>
</blockquote>
<p><strong>Srialisation en JSON</strong> : les proprits <code>transient</code> ne sont pas srialises et les proprits ayant une valeur <code>null</code> non plus (sauf en tant que valeurs  l'intrieur d'une <code>Map</code> ou <code>Collection</code>).</p>
<h5>Pices jointes attaches  un document</h5>
<p>Il est possible d'attacher  un document des pices jointes par des items de classe prdfinie <code>Document.P</code> mmorisant pour chaque pice jointe (une suite d'octets) :</p>
<ul>
<li><code>key</code> : sa cl d'accs (comme pour tout item) ;</li>
<li><code>mime</code> : son type mime (qui n'est pas contrl) le cas chant comportant une extension quand le fichier a t gzipp / crypt (<code>.g</code> <code>.c</code> <code>.g</code> <code>.gc</code> ou rien);</li>
<li><code>size</code> : sa taille en octets ;</li>
<li><code>sha</code> : son digest <code>SHA 256</code>.</li>
</ul>
<p>Le stockage des pices jointes bnficie de la mme cohrence temporelle que les items avec les dtails suivants :</p>
<ul>
<li>le volume des fichiers eux-mmes est dcompt en tant que <code>v2</code> (secondaire) et non <code>v1</code>. Selon les fournisseurs d'infrastructure le cot du stockage peut tre bien infrieur en espace secondaire qu'en espace primaire.;</li>
<li>quand des documents ont des pices jointes ayant le mme contenu (mme <code>sha</code>) elles ne sont stockes qu'une fois mais dcompts en v2 autant de fois que cits dans les items P;</li>
<li>une pice jointe ayant t modifie (donc ayant dsormais un <code>sha</code> diffrent) reste accessible <em>un certain temps</em> sous son ancien <code>sha</code> (s'il est demand par son <code>sha</code> et non sa cl).  Ceci facilite l'exportation cohrente  une version donne d'un document et de ses pices jointes, mme quand elle est volumineuse en raison de la taille des pices jointes. Des exportations incrmentales de documents peuvent tre effectues  cot rseau minimal en vitant le re-transfert de pices jointes dj dtenues  distance.</li>
</ul>
<h3>Mmoires persistante de rfrence et cache</h3>
<p>Il n'existe qu'une <strong>mmoire persistante de rfrence</strong> (base de donnes / datastore) de documents contenant pour chacun son exemplaire de rfrence.</p>
<p>Il existe de nombreuses <strong>mmoires caches</strong> de documents, qui sont toujours potentiellement retardes (dispose d'une version antrieure) par rapport  la rfrence persistante :</p>
<ul>
<li>ventuellement dans le cas Datastore une en mmoire <em>memcached</em> <em>commune  tous les serveurs du pool</em> servant les oprations.</li>
<li>une mmoire cache <em>volatile dans chaque serveur du pool</em> servant les oprations.</li>
<li>dans les <em>sessions externes clientes</em>:
<ul>
<li>une mmoire cache volatile dans chaque session active.</li>
<li>ventuellement une (ou des) mmoire cache persistante locale au terminal survivant aux interruptions de sessions.</li>
</ul>
</li>
</ul>
<p>L'objectif est de permettre de remettre  un niveau plus rcent <code>vr</code> (<em>version de rfrence</em>, la plus rcente pour simplifier) un exemplaire d'un document <code>d</code> date <code>v</code> en minimisant le volume de donnes chang et l'effort de calcul de remise  niveau.<br>
La mise  jour d'une mmoire cache depuis un exemplaire de rfrence d'un document <code>d</code> est <em>un document de mise  niveau</em> plus ou moins complet tabli selon les principes suivants :</p>
<ul>
<li>si l'exemplaire en cache a une <code>ctime</code> infrieure  celle de rfrence, son contenu en cache est  remplacer en totalit totalement par le document de mise  niveau qui contient une copie complte de celui de rfrence (y compris des items dtruits).</li>
<li>sinon l'exemplaire en cache contient :
<ul>
<li>des items inchangs, toujours existants en rfrence avec la mme version : ils ne figurent pas dans le document de remise  niveau.</li>
<li>des items qui ont chang, toujours existants en rfrence avec une version plus rcente : ils figurent dans le document de remise  niveau avec leur nouveau contenu.</li>
<li>des items qui existent en mmoire cache mais plus en rfrence : ils devront tre dtruits ou conservs avec un contenu vide (marqus dtruits) dans la mmoire cache. Voir les cas 1 et 2 ci-dessous.</li>
</ul>
</li>
</ul>
<p>Un exemplaire dans une mmoire cache contient,</p>
<ul>
<li>tous les items existants (ayant un contenu) avec leur version;</li>
<li>tous les items dtruits (sans contenu) avec leur version de destruction, <em>postrieurement  la date-heure <code>dtime</code> du document</em>.</li>
</ul>
<p>La mmoire cache  remettre  niveau contient un exemplaire de <code>d</code> de version <code>v</code> et de <code>dtime</code> <code>dt</code>.<br>
La mmoire source de la remise  niveau contient un exemplaire de <code>d</code> de version <code>vr</code> et de <code>dtime</code> <code>dtr</code>.<br>
En plus des donnes <code>vr</code> et <code>dtr</code>, que contient le document de mise  niveau ?</p>
<h5>Cas 1 : <code>v</code> est postrieure ou gale  <code>dtr</code>.</h5>
<p>La rfrence contient tous les items dtruits depuis <code>v</code> :</p>
<ul>
<li>le document de mise  niveau inclus les items dtruits postrieurement  <code>v</code> avec un contenu <code>null</code> et leurs version de destruction.</li>
<li>les autres items sont inclus avec un contenu et une version si leur version est postrieure  <code>v</code> (ils ont chang).</li>
<li>les items inchangs depuis v ne sont pas inclus.</li>
</ul>
<p>Dans ce cas un item sans contenu est un item dtruit et un item prsent dans le cache et absent du document de remise  niveau est inchang.</p>
<p>La mise  niveau de la mmoire cache par le document de mise  niveau transmis consiste  :</p>
<ul>
<li>inscrire <code>vr</code> comme nouvelle version du cache.</li>
<li>inscrire la plus rcente de la <code>dtime</code> actuelle <code>dt</code> et <code>dtr</code> comme nouvelle <code>dtime</code> du cache (les items dtruits antrieurement n'tant pas connus).</li>
<li>les items <em>sans</em> contenu du document de remise  niveau sont inscrits dans le cache avec un contenu vide et leur version.</li>
<li>les items <em>avec</em> contenu du document de remise  niveau crasent ceux du cache ou les insrent quand ils n'y taient pas.</li>
<li>la nouvelle <code>dtime</code> du cache peut aussi tre avance entre sa nouvelle valeur et la nouvelle version pour viter de garder trop d'items dtruits : le cache purge tous les items sans contenu de version antrieure  la nouvelle <code>dtime</code>.</li>
</ul>
<p>Le cache peut lui-mme dsormais servir de rfrence pour crer un document de remise  niveau d'un autre cache plus retard.</p>
<h5>Cas 2 : <code>v</code> est antrieure  <code>dtr</code>.</h5>
<p>La rfrence ne contient pas tous les items dtruits depuis <code>v</code> mais seulement depuis <code>dtr</code>. Si le cache dtient un item <code>x</code> dtruit entre <code>v</code> et <code>dtr</code>, le document de remise  niveau ne peut pas le savoir.</p>
<p>Le document de remise  niveau contient en plus de <code>vr</code> et <code>dtr</code> une <strong>liste des cls des items existants</strong> (sauf toutefois celles de ceux lists parce qu'ayant t crs ou modifis).</p>
<ul>
<li>le document de mise  niveau inclus les items dtruits postrieurement  <code>dtr</code> avec un contenu <code>null</code> et leurs version de destruction.</li>
<li>les autres items sont inclus avec un contenu et une version si leur version est postrieure  <code>v</code> (ils ont chang).</li>
<li>les items inchangs depuis <code>v</code> ne sont pas inclus.</li>
</ul>
<p>La nouvelle <code>dtime</code> du cache est <code>dtr</code>.<br>
Elle peut aussi tre avance entre sa nouvelle valeur et la nouvelle version <code>vr</code> pour viter de garder trop d'items dtruits : le cache purge tous les items sans contenu de version antrieure  la nouvelle <code>dtime</code>.</p>
<p>Dans ce cas un item sans contenu reste toujours un item dtruit et un item absent est,</p>
<ul>
<li>soit inchang s'il figure dans la liste des existants,</li>
<li>soit dtruit avant <code>dtr</code> dans le cas contraire et  purger du cache.</li>
</ul>
<p>La mise  niveau s'effectue de manire identique au cas 1 mais comporte une phase supplmentaire de purge de tous les items existants en cache et absents de la liste des existants et de la liste des items dtruits depuis <code>dtr</code>.</p>
<h1>Oprations</h1>
<p>Une opration est une succession d'actions de lecture, d'criture (cration / modification / suppression) de documents et d'items de documents et de calculs sur ces donnes :</p>
<ul>
<li><strong>une opration est &quot;atomique&quot;</strong> vis  vis de la mise  jour des documents, tous mis  jour et dats du mme instant ou aucun.</li>
<li><strong>une opration est &quot;isole&quot;</strong> et travaille sur tous les documents accds comme si elle tait seule le faire.</li>
<li><strong>une opration peut retourner un rsultat</strong> ou aucun. Ce rsultat peut tre :
<ul>
<li>n'importe quel <strong>contenu binaire</strong> ayant un type mime.</li>
<li>le couple, a) d'un <strong>rsultat structur</strong> sous forme d'un objet JSON, b) d'une <strong>liste de synchronisations</strong> donnant tous les changements oprs depuis une version donne sur les documents que le demandeur de l'opration avait cit  des fins de synchronisation.</li>
</ul>
</li>
<li><strong>une opration peut se terminer prmaturment en exception</strong>, technique ou mtier, bug dtect ou situation inattendue ...</li>
<li>Une opration a trois date-heures :
<ul>
<li>souvent mais pas toujours, une <em>date-heure d'opration</em> <code>dhop</code> qui est celle de la session ayant invoqu l'opration.</li>
<li>une <em>date heure de dbut</em>, horloge du dbut du traitement. Si <code>dhop</code> existe elle doit ne pas tre trop infrieure  celle-ci mais jamais suprieure. Les horloges des sessions doivent tre  peu synchronises sur celle du serveur;</li>
<li>une <strong>date-heure de validation</strong>, non connue au cours du traitement, et qui marque la <strong>version</strong> de tous les documents et de leurs items ayant t crs, modifis, ou dtruits au cours de l'opration.</li>
</ul>
</li>
</ul>
<p>Une opration est initie par l'arrive d'une requte externe HTTPS le cas chant mise par le <em>Queue Manager</em> grant des requtes diffres mises en file d'attente.</p>
<p>Une opration est matrialise par un objet <code>operation</code> d'une classe tendant <code>Operation</code> et ayant deux mthodes <code>work()</code> et <code>afterwork()</code>, l'tape <em>validation</em> intervenant entre elles:</p>
<ul>
<li><code>work()</code> : cette mthode lit les arguments de la requte qui l'a initie, effectue les traitements ncessaires et retourne un rsultat ventuel de classe <code>Result</code>.</li>
<li> la fin de <code>work()</code> l'tape de <strong>validation</strong> vrifie la consistance temporelle des documents utiliss au cours du traitement et le cas chant rend persistant les documents crs / modifis / supprims au cours de <code>work()</code> : la validation peut chouer en cas d'inconsistance temporelle des documents et/ou de problmes de contention sur la base de donnes ;</li>
<li><code>afterWork()</code> : cette mthode est excute aprs la validation et peut le cas chant diffuser des e-mails par exemple. En gnral et par dfaut elle ne fait rien.</li>
</ul>
<p>En cas d'exception au cours du traitement, un nouvel objet <code>operation</code> est recr et le cycle <strong><code>work()</code> -&gt; validation-&gt;  <code>afterwork()</code></strong> est relanc (aprs un certain dlai, au plus 3 fois et pas pour toutes les exceptions).</p>
<h5>Estampilles d'un document et de ses items : classe <code>Stamp</code></h5>
<p>Les estampilles sont des nombres de la forme <code>AAMMJJhhmmssmmm</code> soit la date en anne mois jour heure minute seconde milliseconde en UTC (du XXIime sicle) :</p>
<ul>
<li><code>Stamp.minStamp</code> : premire milliseconde du sicle,</li>
<li><code>Stamp.maxStamp</code> : dernire milliseconde du sicle.</li>
</ul>
<p>Par exemple : <code>160714223045697</code> (le 14 juillet 2016  22:30:45 et 697 ms).<br>
La classe <code>Stamp</code> dont les objets sont immuables permet de crer et manipuler ces estampilles et de les convertir en <code>epoch</code> nombre de millisecondes coules depuis le 1/1/1970 (<code>epoch</code>).</p>
<blockquote>
<p>Un document <em>existe</em> ds lorsqu'il a une date-heure de cration et une version : il peut n'avoir aucun item. Les versions tant attribues  la validation d'une opration, en cours d'opration une version  0 traduit un document cr au cours de cette opration.</p>
</blockquote>
<blockquote>
<p>Une opration peut crer / modifier / supprimer plusieurs documents : ces documents, et leurs items, portent comme version l'estampille de validation de l'opration ce qui permet de dterminer aprs coup si plusieurs modifications ont t portes exactement par la mme opration.</p>
</blockquote>
<blockquote>
<p>Vues d'un document toutes les estampilles de validation des oprations sont distinctes et croissantes dans le temps. Deux oprations strictement parallles et n'ayant pas modifi les mmes documents peuvent avoir une mme estampille de validation : la chronologie relle entre elles est indcidable mais ne peut pas avoir d'impact sur la logique mtier.</p>
</blockquote>
<h1>Cohrence temporelle entre documents</h1>
<p><strong>Dans sa phase <code>work()</code></strong> une opration qui souhaite modifier un document, ou s'assurer qu'il ne changera pas au cours du traitement, le demande avec <em>une tolrance temporelle de 0 seconde</em> (l'tat le plus rcent possible) :</p>
<ul>
<li>ceci autorise l'opration  modifier le document, ce qu'elle n'est <em>pas</em> oblig de faire.</li>
<li>ceci garantit qu'au cours du traitement c'est exactement ce mme objet document qui sera vu / modifi, mme s'il est demand plusieurs fois et que sa rfrence n'a pas t conserve dans des variables.</li>
</ul>
<p>Si l'opration demande un document avec une tolrance temporelle suprieure  0 (1 seconde, 30 secondes, etc.) elle rcupre une version (disponible le cas chant en cache) avec une fracheur compatible avec l'exigence : le document est en lecture seule dans l'opration.</p>
<p><strong>La validation d'une opration</strong> s'opre selon les tapes suivantes :</p>
<ul>
<li><strong>elle s'assure</strong> (en les verrouillant effectivement sur le stockage persistant) que tous les documents demands avec une tolrance 0 (qu'ils aient t modifis ou non) <strong>n'ont pas chang de version</strong> par rapport  celle de l'exemplaire utilis en traitement ;</li>
<li><strong>elle dtermine sa propre version</strong>: c'est la date-heure courante mais toujours garantie suprieure d'au moins une milliseconde  la plus tardive des versions des documents  tolrance 0 ;</li>
<li><strong>elle valide dfinitivement le stockage des contenus</strong> des documents crs / modifies / supprimes au cours du traitement et de leurs items.</li>
<li><strong>elle libre les verrouillages</strong> sur les documents qui taient verrouills par le <code>commit()</code> technique du stockage persistant.</li>
</ul>
<blockquote>
<p>Si un document a volu entre la phase de traitement et la validation, l'opration subit une exception : la validation s'interrompt, libre les verrous et l'opration est recycle. Elle prendra alors la dernire version du / des documents ayant provoqu cette exception.
Le nombre de recyclages est limit et un certain temps est laiss entre chaque cycle : in fine l'opration peut sortir dfinitivement en erreur du fait d'un excs de contention d'accs sur les documents persistants.</p>
</blockquote>
<p>Ce mode de gestion <em>optimiste</em> table sur le fait que les oprations vont travailler sur peu de documents (il y a une limite autoritaire  32). Elle optimise aussi la connaissance entre plusieurs serveurs des dernires versions des documents et rend la gestion des caches locales  chaque instance plus efficientes.</p>
<h5>Consistance structurelle entre plusieurs documents : documents verrous</h5>
<p>Parfois un groupe de documents doit tre considr comme immobile ds lors qu'une opration travaille sur l'un deux :</p>
<ul>
<li>par exemple pour effectuer des arrts comptables exactement synchroniss sur les documents du groupe et enregistrer dans un document un agrgat de dcomptes provenant de documents du groupe.</li>
<li>dans ce cas il faut dterminer un document reprsentatif du groupe (le cas chant avec un singleton quasi vide) et s'astreindre  le demander avec une tolrance 0 dans toutes les oprations portant sur un des documents du groupe.</li>
</ul>
<h3>Oprations de mise  jour et synchronisations</h3>
<p>Elles ont pour objectif de mettre  jour, ajouter ou supprimer des items dans un ou plusieurs documents du mme groupe ou non.</p>
<p>En cas de succs et si l'opration ne retourne pas de rsultat ou retourne un rsultat en JSON, elle est suivie d'une <strong><em>synchronisation</em></strong> qui liste (en JSON) toutes les modifications rsultantes de l'opration sur tous les documents que la session ayant mis la requte a cit <em> synchroniser</em> (avec la version et le <code>dtime</code> dtenus pour chacun).<br>
Une session peut ainsi effectuer des actions de mises  jour et rcuprer toutes les consquences de ces actions sur les documents dont elle dtient une copie (plus ou moins retarde).</p>
<p><strong>Une opration de mise  jour doit tre idempotente</strong> : l'excuter plusieurs fois successivement doit laisser l'ensemble des documents dans le mme tat qu'une excution unique ce qui exige le cas chant de dtecter que la mise  jour a dj t faite ou qu'elle peut tre faite plusieurs fois sans dommage pour la logique mtier.<br>
L'utilisation de la date-heure d'opration <code>dhop</code> permet souvent de mmoriser qu'une opration de la session a dj t effectue et viter de la refaire.</p>
<p><strong><em>Une opration de mise  jour peut retourner un rsultat</em></strong> : du fait de l'idempotence le traitement doit retourner le mme rsultat qu'elle ait procd effectivement  la mise  jour ou constat qu'elle avait dj t faite.</p>
<h3>Oprations de reporting</h3>
<p>Elles ont pour objectif de retourner un rsultat construit depuis des documents stocks.</p>
<p>Des excutions successives donnent usuellement des rsultats diffrents, l'tat des documents stocks ayant volu.<br>
Le rsultat d'une opration de reporting peut avoir n'importe quelle forme : <em>JSON, image, html</em>, etc.</p>
<p>Si une opration de reporting retourne un rsultat en JSON, elle <em>peut</em> tre suivie d'une synchronisation.</p>
<h1>Exceptions</h1>
<p>Oprations et synchronisations retournent une <strong><em>exception</em></strong> en cas d'chec aboutissant  un status HTTP 400 (404 pour les N).</p>
<h3>Codes MAJOR / MINOR</h3>
<p>La premire lettre du <strong>code</strong> de l'exception dfinit son code <strong>MAJOR</strong> (1  7) :</p>
<ul>
<li>1 : <strong><em>A - mtier</em></strong> : les conditions fonctionnelles sont non satisfaisantes sur le contenu des documents vis  vis des paramtres de l'opration. Recommencer l'opration avec les mmes paramtres a de fortes chances de provoquer la mme exception ...  sauf si les donnes sur le serveur ont volu favorablement depuis, typiquement du fait d'une requte mise par une autre session depuis la requte initiale.</li>
<li>1 : <strong><em>N - ressource inexistante</em></strong> : l'opration a demand typiquement le contenu d'une pice jointe inexistante (404).</li>
<li>2 : <strong><em>B - bug</em></strong> : l'application <em>a rencontr et bien dtect</em> une conjonction des valeurs de donnes qui n'auraient jamais d exister (selon le dveloppeur). Recommencer l'opration avec les mmes paramtres a des chances de provoquer la mme exception, sauf si les donnes sur le serveur ont volu depuis de sorte que cette conjonction non prvue n'apparaisse plus (chance ... relative, c'est un incident non reproductible et peut-tre difficile  corriger).</li>
<li>3 : <strong><em>X - inattendue</em></strong> : l'application <em>a rencontr une exception inattendue</em> (par exemple des valeurs incohrentes et non dtectes en tant que telle) qui peut tre la consquence d'une indisponibilit ou du systme ou du matriel (I/O, rseau, contention sur les donnes, famine de mmoire ...). Recommencer l'opration un peu plus tard avec les mmes paramtres peut ne pas faire apparatre la mme exception si elle rsultait d'un problme ponctuel ou d'une surcharge systme ayant disparu depuis. Mais ce peut tre aussi un bug non dtect par l'application en tant que bug.</li>
<li>4 : <strong><em>D - version retarde</em></strong> : la session requrante peut (et sauf exception le fait) transmettre avec sa requte l'identification de sa build. Si le serveur a une build plus avance pour viter des incidents de gestion lis  cette discordance il met une exception de ce type.</li>
<li>5 : <strong><em>C - contention sur les donnes</em></strong> : l'opration trop longue n'arrive pas  s'excuter avec un ensemble de documents cohrents temporellement entre eux. Malgr plusieurs tentatives l'chec de la validation d'une opration rapparat.</li>
<li>6 : <strong><em>O - domaine off</em></strong> : une opration de maintenance technique a ferm le service temporairement. Un message plus dtaill peut donner plus d'informations sur les raisons de cette fermeture et perspective de rouverture.</li>
<li>7 : <strong><em>S - non autorise</em></strong> : la session a joint des identifiant / cl d'authentification / autorisation ... n'autorisant pas l'excution de l'opration. Il s'agit soit d'une session dont l'autorisation a expir ou  a t supprime par l'administrateur ou d'une tentative d'intrusion.</li>
</ul>
<h3>Phase de traitement</h3>
<p>Une exception embarque la phase de ce traitement o elle a t leve et permet de dterminer si oui ou non le traitement a t excut et/ou valid :</p>
<ul>
<li>phase 0 : avant dbut de l'opration.</li>
<li>phase 1 : au cours de l'opration (<code>work()</code>).</li>
<li>phase 2 : durant la <em>validation</em> de l'opration.</li>
<li>phase 3 : au cours de la phase <code>afterwork()</code> de l'opration.</li>
<li>phase 4 : durant la synchronisation postrieure  l'opration.</li>
<li>phase 5 : durant l'envoi du rsultat.</li>
</ul>
<p>Une requte HTTP peut galement retourner des codes d'incident autres :</p>
<ul>
<li>avant envoi de la requte ;</li>
<li>des codes HTTP 0 ou 500 mis par le frontal ou le conteneur de l'application, dpassement de temps etc.</li>
<li>aprs retour de la requte sur l'interprtation du rsultat retourn.</li>
</ul>
<h1>Tches : oprations diffres</h1>
<p>Certains traitements peuvent tre constitus d'une squence, possiblement longue, d'oprations. D'autres sont  lancer priodiquement.<br>
Comme une opration doit avoir un temps d'excution rduit et surtout ne pas accder  trop de documents en tolrance 0, ces traitements s'excutent sous la forme d'une suite d'oprations distinctes et diffres.<br>
Par ailleurs une opration <em>principale</em> peut avoir besoin d'tre suivie aprs un dlai plus ou moins court d'oprations <em>secondaires</em> diffres par rapport  l'opration principale.</p>
<p>Une tche est constitue d'une succession d'tapes de 1  N, chacune marquant un point de reprise persistant :</p>
<ul>
<li>chaque fin d'tape spcifie s'il y a ou non une tape ultrieure et quel est son objet paramtre d'excution. Cet objet porte galement, si souhait, des informations de reporting sur le travail dj excut.</li>
<li>la fin de la dernire tape spcifie si son rsultat doit tre conserv, et si oui combien de temps, ou si la trace de la tche est  dtruire immdiatement.</li>
</ul>
<h5>TaskQueue</h5>
<p>Cette table / entit gre  la fois la liste des tches et plus prcisment son tape courante :</p>
<ul>
<li><strong>en attente de traitement</strong> : le numro d'tape est renseign et la <code>toStartAt</code> mentionne quand elle doit tre lance au plus tt. C'est le code <code>exc</code> qui indique :
<ul>
<li>non <code>null</code> : la dernire excution est tombe en exception et c'est une relance (<code>retry</code> est &gt; 0) qui est en attente.</li>
<li><code>null</code> : la dernire excution s'est termine normalement et c'est la premire excution de cette tape qui est en attente (<code>retry</code> vaut 0).</li>
</ul>
</li>
<li><strong>en cours de traitement</strong> : le numro d'tape est renseign, <code>toStartAt</code> est <code>null</code> et <code>startTime</code> donne la date-heure de dbut de traitement.</li>
<li><strong>termine</strong> : le numro d'tape est <code>null</code>. <code>toPurgetAt</code> indique quand cette trace doit tre supprime.</li>
<li><strong>prsume perdue</strong> : c'est un cas particulier de l'tat en traitement mais sa <code>startTime</code> est  ancienne et on suppose que sa fin, normale ou en exception, n'a pas pu tre enregistre.</li>
</ul>
<h5>Queue Manager</h5>
<p>C'est est un ensemble de threads chargs d'envoyer des requtes HTTP demandant l'excution des oprations diffres inscrites et de rguler le flux des demandes afin de ne pas saturer les serveurs. Le Queue Manager joue un rle de session externe mais non humaine :</p>
<ul>
<li>il n'interprte pas le rsultat qui peut tre stock afin d'tre consultable un certain temps aprs la fin de la tche par un administrateur.</li>
<li>il ne gre pas les exceptions des oprations : elles rapparaissent en queue avec un <code>retry</code> &gt; 1 inscrites par la requte dans le catch final.</li>
<li>il rcupre priodiquement les tches <em>prsume perdues</em> dont la fin normale ou exception n'a pas pu tre enregistre.</li>
</ul>
<h5>Datastore</h5>
<p>Le GAE Datastore a son propre Queue Manager. Afin d'uniformiser la gestion des tches, la politique suivante est applique :</p>
<ul>
<li>le QM Datastore ne considre que les tapes individuellement : le lancement de l'tape suivante est gr par la fin de la prcdente qui inscrit une task Datastore explicitement.</li>
<li>le QM Datastore gre la relance des tapes tombes en exception. Toutefois au bout d'un certain nombre de fois il abandonne silencieusement. La tche apparat dans <code>TaskQueue</code>,
<ul>
<li>soit comme sortie en exception,</li>
<li>soit comme prsume perdue si son exception n'a pas pu tre attrape.</li>
</ul>
</li>
<li>une tche priodique <code>Cron</code> du datastore est en charge :
<ul>
<li>de rcuprer les tches prsumes perdues et de les relancer en tant que nouvelle task pour le QM Datastore.</li>
<li>d'envoyer un e-mail d'alerte  l'administrateur signalant les tches en erreur ayant un indice de <code>retry</code> important et marques  relancer  la fin du sicle.</li>
</ul>
</li>
</ul>
<p>La diffrence se situe dans la rcupration dans les QM d'une excution dont la fin n'a pas t attrape / enregistre sur le serveur excutant :</p>
<ul>
<li>la requte HTTP dans un QM Datastore rcupre un statut non 200 ou une exception de rupture de connexion. Il considre que c'est une exception et relance l'tape.</li>
<li>le Queue Manager ne fait pas de relance. Il faudra attendre un scan qui force une exception LOST et relance l'tape.</li>
<li>dans les deux cas,
<ul>
<li>l'excution dont le contrle a t perdue peut se terminer finalement alors qu'une autre excution a t relance et ce avant ou aprs dtection de LOST.</li>
<li>la nouvelle excution peut se retrouver lors de son dbut face  une excution antrieure qui s'est termine.</li>
</ul>
</li>
</ul>
<h4>Cration d'une tche et de sa premire tape</h4>
<p>Une tche est inscrite dans une table <code>TaskQueue</code> (<em>entity</em> en Datastore) au commit de l'opration qui l'a cr avec les donnes suivantes :</p>
<ul>
<li><code>ns</code> : son namespace.</li>
<li><code>taskid</code> : son identification alatoire tire  la cration.</li>
<li><code>opName</code> : le nom de l'opration en charge du traitement.</li>
<li><code>param</code> : un JSON contenant les paramtres requis. Si ceux-ci sont trs volumineux, on cr un document et <code>param</code> en contient juste l'identification.</li>
<li><code>info</code> : texte d'information index permettant des filtrages pour l'administrateur.</li>
<li><code>step</code> : le numro d'tape est 1, c'est celui de la <strong>prochaine</strong> tape  excuter.</li>
<li><code>cron</code> : un code <code>Cron</code> (voir ci-aprs).</li>
<li><code>retry</code> : son numro d'ordre d'excution dans l'tape <code>step</code> est 0. Il est incrment  chaque relance aprs exception.</li>
<li><code>toStartAt</code> : la date-heure de son lancement / relance au plus tt.</li>
<li><code>startTime</code> : la date-heure du dbut d'excution de l'tape courante. <code>null</code> quand elle est en attente, sa prsence indique qu'elle est en cours de traitement dans le serveur.</li>
<li><code>qn</code> : numro de queue : le Queue Manager a plusieurs queues numrotes de 0  N pour des usages diffrents, par exemple :
<ul>
<li>0:<em>rapide</em>, plusieurs threads pour des tches courtes,</li>
<li>1:<em>standard</em>, 2 threads pour des tches plus longues,</li>
<li>3:<em>background</em>, un seul thread pour des tches peu frquentes et peu prioritaires.</li>
<li>pour chaque code d'opration la configuration d'application dfinit le numro de queue (quand il n'est pas 0).</li>
</ul>
</li>
<li><code>exc</code> : code d'exception du dernier traitement en erreur. <code>null</code> au lancement / relance.</li>
<li><code>detail</code> : le dtail de l'exception, stack etc.</li>
</ul>
<h4>Enregistrement du dbut d'excution</h4>
<p>Il est effectu dans le serveur d'excution.</p>
<ul>
<li><strong>enregistrement de <code>TaskQueue</code> non trouv</strong> : on ne fait rien et on retourne un status 200 pour ne pas provoquer de relance du QM Datastore. La tche tait termine ou supprime par l'administrateur.</li>
<li><strong>step demande infrieure  celle enregistre (ou celle enregistre est 0 - trace)</strong> : on ne fait rien et on retourne un status 200 pour ne pas provoquer de relance du QM Datastore. L'tape tait termine, le QM Datastore n'en savait rien (et a mme lanc l'tape suivante).</li>
<li><strong>steps demande et enregistre identiques</strong>.
<ul>
<li>l'tat enregistr n'a pas de <code>startTime</code>. C'est le cas normal, du premier lancement ou d'une relance. On inscrit une <code>startTime</code> et le <code>retry</code> est incrment.</li>
<li>l'tat enregistr a une <code>startTime</code>. On crase la <code>startTime</code> (le <code>retry</code> est laiss tel quel) ce qui fera ignorer la fin de la prcdente. La nouvelle excution devient officielle (l'autre ayant de fortes chances de ne plus tre suivie par le QM Datastore).</li>
</ul>
</li>
<li><strong>step demande suprieure  celle enregistre</strong>. Situation a priori impossible : on ne fait rien et on retourne un status 200.</li>
</ul>
<h4>Fin d'excution</h4>
<p>Elle est excute par l'opration, soit sur fin normale, soit en exception :</p>
<ul>
<li>toute excution qui se termine alors que l'tat enregistr ne correspond pas  sa signature <code>startTime</code> est ignore, non enregistre et la transaction non valide : c'est une excution perdue qui a t relance depuis. Son retour est un status 200 afin que le QM Datastore surtout ne relance rien (au cas improbable o il couterait encore).</li>
<li>la fin sur exception est enregistre (transaction non valide) et retourne un 500 afin que le QM Datastore relance.</li>
<li>la fin normale est enregistre, la transaction est valide et retourne un status 200 afin que le QM Datastore ne relance pas. La fin normale correspond ,
<ul>
<li>soit la fin de la dernire tape avec trace (<code>step</code> est <code>null</code>, <code>toPurgetAt</code> est renseigne).</li>
<li>soit la fin de la dernire tape sans trace (l'enregistrement est supprim).</li>
<li>soit la demande d'une nouvelle tape (<code>step</code> est incrment, <code>retry</code>  0, <code>toStartAt</code> est renseigne).</li>
</ul>
</li>
</ul>
<h4>Fin d'tape d'une tche</h4>
<p>La fin d'une tape <em>intermdiaire</em> donne lieu :</p>
<ul>
<li> l'enregistrement du <code>param</code> de l'tape suivante, objet pouvant comporter facultativement des donnes de compte rendu synthtique d'excution des tapes prcdentes;</li>
<li> l'incrmentation du compteur d'tapes <code>step</code>;</li>
<li> l'enregistrement d'une nouvelle date-heure de lancement pour l'tape suivante.</li>
</ul>
<p>La fin de la <em>dernire</em> tape donne lieu :</p>
<ul>
<li> l'enregistrement du <code>param</code> qui, s'il n'est pas <code>null</code>, ne contient plus que des donnes de compte rendu synthtique d'excution;</li>
<li> l'enregistrement d'une date-heure de purge de l'enregistrement de suivi de la tche.</li>
<li> la mise  <code>null</code> du numro de la prochaine tape et de la date-heure de prochain lancement.</li>
</ul>
<p>A noter que si la dernire tape ne veut pas conserver de trace de traitement, son enregistrement est purement et simplement dtruit.</p>
<h3>Opration associe  une tche</h3>
<p>C'est une opration normale. L'objet <code>param</code> et le nom de l'opration <code>opName</code> ont t rcuprs de <code>TaskQueue</code> avec les informations <code>startTime</code> <code>step</code> et <code>retry</code> rendues disponibles dans <code>InputData.args</code>.</p>
<ul>
<li>elle retourne un rsultat indiquant si une nouvelle tape est demande, quand ou si c'est la dernire. Son objet <code>param</code> peut tre mis  jour pour reflter  la fois le compte rendu d'excution et les paramtres de l'tape suivante. L'opration n'effectue pas de calcul de synchronisation et n'a pas de phase <code>afterwork()</code> : elle ne fait <em>que</em> des mises  jour de documents et de son <code>param</code> dans sa phase <code>work()</code>.</li>
<li>elle peut inscrire des oprations diffres.</li>
<li>elle bnficie d'un quota de temps plus long pour son excution.</li>
</ul>
<h3>Principe d'excution nominal</h3>
<p>Une opration inscrit une nouvelle tche en ayant fourni <code>ns opName param info cron</code> : <code>taskid</code> est gnre et <code>qn</code> obtenu de la configuration.<br>
Au commit :</p>
<ul>
<li>la tche est inscrite dans la table <code>TaskQueue</code>.</li>
<li>pour un Datastore, <strong>avant le commit</strong>, une tche est mise en queue avec pour URL d'invocation <code>/ns/od/taskid/step?key=...</code>.</li>
<li>pour une base de donnes, <strong>aprs le commit</strong>, si la <code>toStartAt</code> est proche (moins de X minutes : X est le scan lapse du Queue Manager), le Queue Manager associ  l'instance (<code>qm7</code>) reoit une requte HTTP <code>/qm7/op?key=...&amp;op=inq&amp;param={ns:..,taskid:..,toStartAt:..,qn:..,step:N}</code> pour inscription de l'tape N de la tche  relancer sans attendre le prochain scan.</li>
</ul>
<p><strong>Quand le Queue Manager peut / doit lancer la tche</strong>, il cherche un thread worker libre qui met vers le serveur du namespace une requte HTTP avec <code>/ns/od/taskid/step?key=...</code> :</p>
<ul>
<li><code>ns</code> : le code de l'instance (comme pour toute requte),</li>
<li><code>od</code> au lieu de <code>op</code> pour identifier qu'il s'agit d'une opration diffre,</li>
<li><code>taskid/step</code> dans l'URL.</li>
<li>le paramtre <code>key</code> : mot de passe permettant de s'assurer que c'est bien le Queue Manager qui a mis la requte et non une session externe (en fait sur un POST, <code>key</code> n'apparat pas dans l'URL comme dans celle ci-dessus qui est employe en test).</li>
</ul>
<p>Quand le Datastore lance la tche il met une requte HTTP sur l'URL <code>/ns/od/taskid/step?key=...</code>.</p>
<p>L'opration souhaite s'excute ensuite :</p>
<ul>
<li><strong>traitement OK</strong> :
<ul>
<li>la tche <code>ns.taskid</code> est,
<ul>
<li>soit supprime de la table <code>TaskQueue</code> au commit.</li>
<li>soit enregistre pour une nouvelle tape.</li>
</ul>
</li>
<li>le retour est un status 200 ce qui libre le worker du Queue Manager pour prendre en charge une nouvelle tape de tche ou signale au Datastore que l'tape de la tche est finie.</li>
</ul>
</li>
<li><strong>traitement en Exception</strong> :
<ul>
<li>la tche <code>ns.taskid</code> est mise  jour dans <code>TaskQueue</code> :
<ul>
<li><code>starTime</code> y est mise  <code>null</code>;</li>
<li><code>retry</code> est incrment;</li>
<li><code>exc detail</code> sont renseigns;</li>
<li><code>toStartAt</code> est calcule  une valeur future d'autant plus lointaine que le numro de <code>retry</code> est lev, voire finalement infinie.</li>
</ul>
</li>
<li>le retour est un status 500 ce qui libre le worker du Queue Manager pour prendre en charge une nouvelle tape d'une tche ou signale au Datastore qu'il faudra relancer.</li>
<li>sauf Datastore, si la <code>nexstart</code> est proche (moins de X minutes), le Queue Manager associ au namespace reoit une requte HTTP pour inscription de la tche  relancer sans attendre le prochain scan.</li>
</ul>
</li>
</ul>
<p><strong>Scan priodique des TaskQueue par le Queue Manager</strong>
Un Queue Manager gre une ou plusieurs instances et fait donc face  une ou plusieurs base de donnes.<br>
Seules les tapes des tches  chance proche lui sont soumises par HTTP : un scan priodique lui permet de rcuprer les autres. Ce scan, pour chaque base de donnes, filtre les tches ayant :</p>
<ul>
<li>une <code>toStartAt</code> antrieure  la date-heure du scan suivant,</li>
<li>ayant l'un des codes d'instance dont il est en charge,</li>
<li>un numro d'tape : si <code>null</code> la tche est termine et l'enregistrement n'est qu'une trace,</li>
<li>ayant une <code>startTime</code> <code>null</code> (tche pas en cours).</li>
</ul>
<p>Ce scan permet au Queue Manager de rcuprer les tches  relancer autant que celle  lancer une premire fois.</p>
<h3>Situations anormales</h3>
<h5>Perte de contact par le worker du Queue Manager qui suit l'excution d'une tape d'une tche</h5>
<p>Sa requte HTTP sort prmaturment en exception : la notification de fin ne lui parviendra pas.</p>
<ul>
<li>le worker considre l'tape comme termine.</li>
<li>le worker n'est en fait pas intress par le status de bonne ou mauvaise fin de celle-ci.</li>
</ul>
<p>Si l'tape de la tche se termine bien, elle disparatra de <code>TaskQueue</code> ou aura un numro d'tape suprieur.<br>
Si la tche sort en exception elle sera modifie en <code>TaskQueue</code> pour une future relance de son tape et si cette relance est proche le Queue Manager sera notifi par HTTP pour acclrer la relance.</p>
<h5>Tches perdues</h5>
<p>Il s'agit de tches qui ont t lances (ou relances),</p>
<ul>
<li>ayant une <code>startTime</code> ancienne,</li>
<li>dont le Queue Manager n'a pas de trace en excution dans un worker.</li>
</ul>
<p>On va considrer que l'tape de la tche s'est mal termine sans que son exception n'ait pu tre enregistre dans <code>TaskQueue</code> : elle est enregistre avec comme exception <code>LOST</code> et marque avec une <code>toStartAt</code> pour une relance ultrieure (comme une exception normale).</p>
<p>Une tche perdue est <em>suppose</em> tre perdue mais en fait elle peut tre cache en excution et dans ce cas il peut exister  un moment donn plus d'une excution en cours, voire dans le pire des cas avec des numros d'tapes diffrents.</p>
<h3>Excution de plusieurs tapes successives dans la mme requte</h3>
<p>La phase <code>work()</code> se termine avec une indication dans son rsultat de comment poursuivre / terminer la tche avec un objet rsultat obtenu par les mthodes :</p>
<ul>
<li><code>Result taskComplete()</code> : tche termine (c'tait la dernire tape). L'enregistrement est immdiatement dtruit.</li>
<li><code>Result taskComplete(Stamp toPurgeAt)</code> : indique la date-heure  laquelle il faut purger l'enregistrement de trace.</li>
<li><code>Result nextStep()</code> : passage  l'tape suivante dans la mme requte.</li>
<li><code>Result nextStep(Stamp toStartAt)</code> : passage  l'tape suivante dans une autre requte.</li>
</ul>
<p>Enchaner un grand nombre d'tapes dans la mme requte a l'avantage vident de limiter l'overhead de nouvelles requtes mais plusieurs inconvnients :</p>
<ul>
<li>monopoliser un thread de calcul pour une tche de fond au dtriment du passage de requtes de front;</li>
<li>risquer une interruption pour excs de consommation de temps calcul pour une requte.</li>
</ul>
<h3>La classe <code>Cron</code></h3>
<p>Une tche peut tre priodique :  la fin d'une excution, une nouvelle tche est inscrite pour excution ultrieure.<br>
Par exemple une tche mensuelle prvue le 2 du mois  3h30, sera inscrite ds sa fin d'excution pour le 2 du mois suivant  3h30.<br>
Une tche peut <em>calculer</em> cette date-heure de prochaine relance mais peut aussi inscrire un code <code>cron</code> qui va faire invoquer la classe <code>Cron</code> pour calculer la prochaine chance <code>toStartAt</code> en fonction de la date-heure courante.</p>
<p><code>Cron</code> gre une priode qui peut tre :</p>
<ul>
<li>Y : annuelle,</li>
<li>M : mensuelle,</li>
<li>W : hebdomadaire,</li>
<li>D : journalire,</li>
<li>H : horaire.</li>
</ul>
<p><strong><em>Exemples :</em></strong></p>
<ul>
<li><code>H25</code> : soit cette mme heure  25 minutes s'il est moins de 25, soit l'heure suivante  25 minutes ;</li>
<li><code>D0425</code> : soit aujourd'hui  4h25 s'il est moins de 4h25, soit le jour calendaire suivant  4h25 ;</li>
<li><code>W30425</code> : soit aujourd'hui si c'est un mercredi et qu'il moins de 4h25, soit le mercredi qui suit  4h25 ;</li>
<li><code>M100425</code> : soit le 10 de ce mois si on est avant le 10  4h25, soit le 10 du mois suivant  4h25 ;</li>
<li><code>Y11100425</code> : soit le 10 novembre de cette anne  4h25 si on est avant cette date-heure, soit le 10 novembre de l'anne prochaine  4h25.</li>
</ul>
<p>Normalement un traitement dont la <code>toStartAt</code> a t calcule depuis son <code>cron</code> avec le paramtre <code>D0425</code> n'est PAS lanc AVANT 4h25 : en consquence  sa validation il sera plus de 4h25 et le traitement suivant sera inscrit pour le lendemain  4h25. Si toutefois le traitement du jour normalement prvu pour le jour J a eu beaucoup de retard au point d'tre lanc / termin  J+1 3h10, le traitement suivant s'effectuera 1h15 plus tard ... sauf  ce que le traitement de la tche contredise le calcul standard bas sur le <code>Cron</code>.</p>
<h2>Administration des tches</h2>
<p>Le privilge d'administration permet de joindre un Queue Manager et de lui soumettre les requtes suivantes :</p>
<ul>
<li>suspension de fonctionnement.</li>
<li>relance de fonctionnement.</li>
<li>liste des tches en attente pour lancement proche.</li>
</ul>
<h3>Interrogation / mise  jour de TaskQueue</h3>
<p>Le privilge d'administration gnrale permet d'accder  tous les TaskQueue (de toutes les instances).</p>
<p>Le privilge d'administration d'une instance ne permet d'accder qu'au seul TaskQueue de l'instance.</p>
<p>Les oprations possibles sont :</p>
<ul>
<li>liste des tches candidates.</li>
<li>liste des tches en erreur.</li>
<li>liste de tches termines.</li>
<li>obtention du <code>param</code> (tche en cours ou termine).</li>
<li>obtention du <code>detail</code> d'une tche en erreur.</li>
<li>destruction d'une tche.</li>
<li>rectification de sa <code>toStartAt</code>, de son <code>cron</code> et avec normment de prudence de son <code>param</code>.</li>
<li>inscription d'une nouvelle tche avec beaucoup de prudence pour tous les paramtres : <code>opName</code>, <code>info</code>, <code>cron</code>, <code>param</code>, <code>toStartAt</code>. C'est utile surtout pour initialiser la premire tche d'un <code>cron</code> sans avoir  coder une opration qui ne serait utiliser que trs peu : cela suppose quand mme que le JSON <code>param</code> soit bien form et correct et que l'opration existe. A la limite a peut se limiter  une page de session, sans dveloppement serveur.</li>
</ul>
<p>Une tche peut tre supprime :</p>
<ul>
<li>en Datastore elle sera toutefois lance mais se terminera immdiatement.</li>
<li>en base de donnes en gnral elle ne sera pas lance, si le Queue Manager est notifi  temps.</li>
</ul>
<p>Une tche peut tre avance :</p>
<ul>
<li>en Datastore une autre tche sera cre plus tt, la seconde sera ignore  l'excution.</li>
<li>en base de donnes le Queue Manager est notifi.</li>
</ul>
<p>Une tche peut tre recule :</p>
<ul>
<li>en Datastore une autre tche sera cre plus tard, la premire sera ignore  l'excution.</li>
<li>en base de donnes le Queue Manager est notifi, en gnral  temps avant lancement.</li>
</ul>
<p>En Datastore c'est aussi un moyen de faire une relance de tche aprs erreur quand le Datastore a renonc aux relances.</p>
<h1>Rplications diffres d'items</h1>
<p>Une opration ne doit travailler que sur peu de documents : en consquence un document A1 ayant  rpliquer son tat synthtique sur des dizaines / centaines d'autres documents ne peut pas le faire dans le cadre d'une opration unique. L'usage d'une tche diffre permet d'y remdier.</p>
<p>Un cas particulirement frquent a toutefois fait l'objet d'un traitement gnrique. Exemple :</p>
<ul>
<li>chaque document d'une classe <em>Asso</em> reprsente une association identifie par une identification (<em>idAsso</em>) :
<ul>
<li>un singleton <code>Sta</code> reprsente le statut gnral de l'association : son intitul, son tat (actif / rsili), voire quelques compteurs importants changeant peu souvent (nombre d'adhrents au premier janvier de l'anne).</li>
<li>des items <code>Adh</code> avec pour cl le numro de l'adhrent (<code>numAdh</code>) dans l'association reprsente les adhrents de l'association avec un rsum simple de donnes changeant peu souvent : nom, tat d'activit, date d'adhsion / rsiliation.</li>
</ul>
</li>
<li>chaque document d'une classe <code>GT</code> reprsente un groupe de travail runissant quelques adhrents de multiples associations. On souhaite disposer dans un document G1 de <code>GT</code> lui-mme,
<ul>
<li><code>Adh</code> : du rsum relatif  chaque adhrent : c'est la copie (faiblement dsynchronise) de l'item <code>Adh</code> de l'adhrent dans son association.</li>
<li><code>Sta</code> : du statut gnral de toutes les associations dont au moins un adhrent fait partie du groupe de travail : c'est la copie (faiblement dsynchronise) du singleton <code>Sta</code> de l'association.</li>
</ul>
</li>
</ul>
<p>Dans les deux classes <code>Asso</code> et <code>GT</code> les items <code>Sta</code> et <code>Adh</code> portent le mme nom, mais :</p>
<ul>
<li>pour <code>Sta</code> :
<ul>
<li>dans <code>Asso</code> c'est un singleton ayant une annotation :
<code>@ADifferedCopy (copyToDocs={GT.class}, separator='.')</code> . Il peut y avoir plusieurs classes de documents listes.</li>
<li>dans <code>GT</code> c'est un item ayant pour cl <code>idAsso</code>.</li>
</ul>
</li>
<li>pour <code>Adh</code> :
<ul>
<li>dans <code>Asso</code> c'est un item de cl <code>numAdh</code> ayant une annotation :
<code>@ADifferedCopy (copyToDocs={GT.class}, separator='.')</code>.</li>
<li>dans <code>GT</code> c'est un item ayant pour cl <code>numAdh.idAsso</code> : le <code>.</code> qui spare les deux parties de la cl est le signe dclar dans le paramtre <code>separator</code> ci-dessus.</li>
</ul>
</li>
</ul>
<p>Deux index sont dclars sur la colonne <code>clkey</code> pour les items <code>Sta</code> et <code>Adh</code> de <code>GT</code>.</p>
<p><strong>A la dclaration d'une nouvelle participation</strong> d'un adhrent <code>N1</code> d'une association <code>A1</code>  un groupe de travail <code>G1</code>, l'opration effectue :</p>
<ul>
<li>la cration d'un item <code>Adh</code> de cl <code>N1.A1</code> dans <code>G1</code> en y copiant le contenu courant de l'item <code>Adh</code> de cl <code>N1</code> reprsentant l'adhrent dans son <code>Asso</code> d'identifiant <code>A1</code>.</li>
<li>si c'est le premier participant appartenant  l'association <code>A1</code>, un item <code>Sta</code> de cl <code>A1</code> est cr dans <code>G1</code> avec une copie du singleton <code>Sta</code> de <code>A1</code>.</li>
</ul>
<p><strong>Au retrait de la participation</strong> de l'adhrent <code>N1</code> de l'association <code>A1</code> du groupe de travail <code>G1</code>, l'opration effectue :</p>
<ul>
<li>la suppression de l'item <code>Adh</code> de cl <code>N1.A1</code> dans <code>G1</code>.</li>
<li>si c'est le dernier participant appartenant  l'association <code>A1</code>, la suppression de l'item <code>Sta</code> de cl <code>A1</code> dans <code>G1</code></li>
</ul>
<p>Moyennant ces contraintes, toute mise  jour de <code>Sta</code> ou d'un <code>Adh</code> dans le document d'une association <code>Ai</code> par une opration de date-heure <code>dh1</code> provoquera une rplication faiblement diffre automatique :</p>
<ul>
<li>dans tous les documents d'une des classes cites dans les annotations de <code>Sta / Adh</code>,</li>
<li>ayant un item de mme nom de classe <code>Sta / Adh</code> et de cl <code>A1</code> (pour <code>Sta</code>) ou <code>xxx.A1</code> pour <code>Adh</code>, d'o l'importance des index sur <code>clkey</code>.</li>
<li>les items sont insrs en base <em>sans lecture des dossiers</em>.</li>
<li>chaque dossier impliqu a dsormais une version <code>dh2</code> suprieure  <code>dh1</code> (chacun des dossiers ayant leur propre date-heure de mise  jour).</li>
<li>chaque item mis  jour a pour version <code>dh2</code> et pour <code>vop</code> <code>dh1</code> : il est ainsi possible de savoir de combien la rplication a t retarde.</li>
<li>comme les rplications sont dsynchronises rien n'interdirait qu'une seconde opration de date-heure <code>dh3</code> ait sa rplication doublant celle de <code>dh1</code> pour un item donn : ce dernier n'est mis  jour que si sa <code>vop</code> mmorise est infrieure  la <code>vop</code> propose en mise  jour, bref un tat retard n'crase pas un tat plus rcent.</li>
<li>les mises  jours dsynchronises ne sont soumises  aucun contrle fonctionnel.</li>
</ul>
<h1>Identification / authentification</h1>
<p>Ce service est gr au niveau de l'application : chaque requte est autonome des prcdentes et il n'y a pas de concept de session dans le serveur.<br>
Chaque requte peut tre porteuse de proprits, <strong><em>par exemple</em></strong> <code>account</code> <code>key</code> <code>sudo</code> o,</p>
<ul>
<li><code>account</code> : identifie un compte,</li>
<li><code>key</code> : donne le mot de passe, tout autre lment d'authentification, un jeton de session etc.</li>
<li><code>sudo</code> : donne pour certaines oprations une cl d'autorisation de privilge administrateur.</li>
</ul>
<p>Des oprations de login <em>peuvent</em> tre crites pour identifier des sessions d'utilisation avec un utilisateur identifi par le login qui dclare (ou retrouve) une session puis des requtes qui ne font que rfrencer des sessions dclares.</p>
<h1>Indexation et recherche de documents</h1>
<p>L'objectif de l'indexation est de pouvoir effectuer une recherche de tous les identifiants des documents d'une classe donne,</p>
<ul>
<li><strong><em>dont l'identifiant est ventuellement contraint</em></strong>,</li>
<li><strong><em>dont au moins un item d'une classe donne a une valeur de proprit satisfaisant au critre de slection</em></strong>.</li>
</ul>
<p>Un second type de recherche utilisant l'indexation consiste  obtenir, non plus seulement l'identifiant d'un document mais le <strong><em>contenu</em></strong> des items (dont leur <code>key</code> et l'identifiant de leur document).</p>
<p>Par exemple si un item <code>Adr</code> contient un <code>codePostal</code> et une <em>collection</em> d'adresses <code>email</code>, obtenir la liste des identifiants des documents ayant un item <code>Adr</code> dont le <code>codePostal</code> est compris entre <code>94000</code> et <code>94999</code> et ayant au moins une adresse <code>email</code> <code>toto@gmail.com</code>.</p>
<h3>Dclaration des proprits indexes</h3>
<p>Dans la classe d'un Item quelques proprits peuvent avoir une annotation <code>@ExportedField</code>. Le type de ces proprits est l'un des suivants <code>String long int double String[] long[] int[] double[]</code>.</p>
<h4>Mise en uvre en R-DBMS</h4>
<p>Il faut dclarer une table portant le nom <code>Item_docClass_itemClass</code> hritant de la table <code>Item</code> et y dclarer les proprits indexes sous le mme nom que dans la classe Java et avec le mme type. <code>docClass</code> et <code>itemClass</code> sont les noms des classes de document et de l'item dans le document.<br>
Il faut ensuite dclarer un (ou plusieurs) index sur ces proprits, index contenant en tte la (ou les) proprits indexes puis les colonnes identifiantes du document et de l'item.</p>
<h4>Mise en uvre en GAE Datastore</h4>
<p>L'entit des items est <code>docClass</code> : il faut dclarer des index sur les noms des proprits indexes ( <code>itemClass_propName</code>).</p>
<h4>Conditions sur les valeurs des identifiants et proprits</h4>
<p>Une condition est dclare par un objet immuable de classe <code>Filtre</code> dont les deux constructeurs permettent de spcifier une ou deux valeurs et la condition  respecter :</p>
<ul>
<li><code>Filtre(type, valeur1)</code> :
<ul>
<li><code>EQ</code> : gal  la valeur 1 ;</li>
<li><code>SW</code> : commenant par la valeur 1 (String seulement) ;</li>
<li><code>LT LE GE GT</code> : suprieur / infrieur strictement ou non  la valeur 1 ;</li>
</ul>
</li>
<li><code>Filtre(type, valeur1, valeur2)</code>
<ul>
<li><code>LTGE LTGT LEGE LEGT</code>  : compris entre valeur 1 et valeur 2 (bornes infrieure et suprieures incluses ou non).</li>
</ul>
</li>
</ul>
<h4>Recherches spcifiques</h4>
<p>Des recherches <em>spcifiques</em> demandent le dveloppement d'une classe comportant une ou deux (voire plus) implmentations selon le type GAE Datastore et R-DBMS (le cas chant plusieurs).</p>
<p>Dtail des mthodes dans le document API.</p>
<hr>
<h1>Argumentaires</h1>
<h3>Gestion pessimiste / optimiste du verrouillage des groupes</h3>
<p><strong><em>En mode pessimiste</em></strong> le verrouillage <strong><em>a priori</em></strong> des groupes prsente un risque accru de deadlock du fait de l'allongement de la dure de verrouillage durant les traitements. En contrepartie la lecture (avec verrouillage) du row du groupe n'intervient qu'une fois.</p>
<p><strong><em>En mode optimiste</em></strong>, le traitement est fait sans verrouillage : les verrouillages des documents n'interviennent qu'au moment de la <em>phase finale d'criture des documents en base</em>. Cette fois-ci les verrouillages des documents permettent a minima de vrifier que les versions n'ont pas chang depuis le dbut de la transaction (une requte un peu complexe <code>select for update</code> mais n'attaquant que des index). Si a n'est  pas le cas l'opration est reprise.</p>
<h3>Mono / multi instances de serveur</h3>
<p>En Datastore il n'y a pas de moyen (semble-t-il) de garantir qu'une seule instance de serveur tourne, mme si c'est celle-ci peut assurer le dbit ncessaire. Le mode &quot;multi&quot; est implicite.</p>
<p>En R-DBMS c'est un choix de configuration qui fixe le nombre d'instances en excution parallle : il est donc possible de fixer le choix en &quot;mono&quot;.</p>
<p>Le mode &quot;mono&quot; permet plusieurs optimisations de la gestion de la mmoire cache du serveur qui en baissant la consommation de ressources permet de retarder le basculement en multi-instances : ce basculement augmente le dbit mais la surconsommation de ressources est plus que linaire.</p>
<p>En mono instance il n'est pas ncessaire de vrifier qu'un document dtenu en cache a bien la dernire version : il l'a, presque, toujours (ou pas du tout). La base peut cependant tre committe et la mise  jour de la mmoire cache  l'instruction suivante une fraction de milliseconde plus tard chouer (ou son thread temporairement tre bloqu par le scheduler) : la relecture dans ce cas s'impose.</p>
<p>Le code gnrique est unique avec quelques courtes variantes.</p>

</div>
<!-- Adds some scroll space to the bottom of the doucment -->
<div style="height: 1pc">&nbsp;</div>
<!-- Scripts to handle MathJax -->
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script async="" src="http://markdownedit.com/assets/js/mathjax-scripts.js"></script>
</body>
</html>