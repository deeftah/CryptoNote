<link rel="import"  href="../bower_components/paper-input/paper-input.html">
<link rel="import"  href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" 	href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" 	href="../bower_components/paper-input/paper-input.html">
<link rel="import" 	href="../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import"  href="spinner-box.html">

<dom-module id="home2-home">
  <template>
  <style include="shared-styles"></style>
    <style>
	  	:host { font-family: var(--font-std); }
	  	:host .cf {@apply --cf-lite; font-size:1.2rem; color:var(--mybg-color);}
	  	:host .ic1 {height:3rem; width:3rem; color:red; }
	  	:host .logolang { @apply --flag-gen; width:3rem; height: 3rem; display:inline-block;}
  </style>
  	<div class="cf">[[bonjour]] <b>[[owner]] [[build]]</b>'s name-tag element.</div>
    <div>
    	<paper-input always-float-label label="My floating label" value="{{owner}}">
  			<iron-icon class="ic1" icon="mail" slot="prefix"></iron-icon>
  			<div slot="suffix">@email.com</div>
  			 <paper-icon-button slot="suffix" onclick="clearInput()" icon="clear" alt="clear" title="clear"></paper-icon-button>
		</paper-input>
    </div>
	<div style="position:relative;display:inline-block;">
		<spinner-box id="spin"></spinner-box>
		<div>
			<div class="logolang"></div>
			<iron-icon icon="mail"></iron-icon>
		  	<button on-tap="ping">Ping</button>&nbsp;
		    <button on-tap="changeTheme">Change theme</button>
		  	<button on-tap="bover">Bower.json</button><span>[[pingres]]</span>&nbsp;
		  	<button on-tap="checkSrvVersion">Check Version</button>
		</div>
	   <a href="bower.json" target="_blank">Lien (relatif) vers bower.json!</a><br>
	   <a href="[[lkbower]]" target="_blank">Lien (absolu) vers bower.json!</a><br>
	   <a href="[[lkping]]" target="_blank">Lien (absolu) vers ping!</a> 
   </div>
    
  </template>
  <script>
    class Home2Home extends Polymer.Element {
      static get is() { return "home2-home"; }
      
      static get properties() {
          return {
        	  lang:{type:String, value:App.lang},
            owner: {type:String, value:'Daniel' },
        	build: {type:Number, value:App.build},
        	lkbower: {type:String, value:App.baseUrl(1) + "bower.json"},
        	lkping: {type:String, value:App.baseUrl() + "ping"}
          };
      }
      changeTheme() {
    	  App.appHomes.changeTheme();
      }
      constructor() {
        super();
        this.bonjour = App.bonjour ? App.bonjour : "Salut" ;
      }
      bower() {
			new App.Req(true).setUrl("bower.json").go()
			.then(r  => {
				this.pingres = JSON.stringify(r);
			}).catch(e => {
				console.log(e.message);
			});	
      }
      ping() {
    	  const spin = this.$.spin;
//    	  const spin = App.globalSpinner;
    	  spin.start(this, "hello !");
    	  setTimeout(() => {
    		  spin.progress("Traitement du serveur");
        	  setTimeout(() => {
            	  App.Util.ping().then(r => {
            		  this.pingres = !r ? "Erreur" : JSON.stringify(r);
            		  spin.stop();
            	  }).catch(err => {
            		  spin.stop();            		  
            	  });        		  
        	  }, 2000);    		  
    	  }, 2000);
      }
      kill() {
    	  console.log("kill");
      }
      checkSrvVersion() {
    	  App.Util.checkSrvVersion();
      }
    }
  customElements.define(Home2Home.is, Home2Home);
  </script>

</dom-module>